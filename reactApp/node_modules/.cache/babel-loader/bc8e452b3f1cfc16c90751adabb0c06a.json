{"ast":null,"code":"var _jsxFileName = \"/home/turbo/devel/MyGame/contracts/eos-hackathon/decentralize-io-ui/src/components/Main/DecentralizeApp.js\";\nimport { JsonRpc } from 'eosjs';\nimport React, { Component } from 'react';\nimport OrganisationDatePicker from \"../Pages/Organisations/OrganisationDatePicker\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport HomePage from '../Pages/HomePage/HomePage';\nimport CreateOrganisation from '../Pages/CreateOrganisation/CreateOrganisation';\nimport ScrollToTop from '../ScrollToTop/ScrollToTop';\nimport HeaderLayout from '../layouts/Header/HeaderLayout';\nimport SideMenuLayout from \"../layouts/SideMenu/SideMenuLayout\";\nimport Organisation from \"../Pages/Organisations/Organisation\";\nimport EOSIOApi from '../../common/eosio-apiService';\nimport * as actions from \"../Pages/Redux/Actions/index\";\nimport { connect } from \"react-redux\";\nimport { REACT_APP_EOSIO_CONTRACT_ACCOUNT, REACT_APP_EOSIO_ACCOUNT, REACT_APP_EOSIO_HOST, REACT_APP_EOSIO_CHAIN_ID, REACT_APP_EOSIO_PROTOCOL, REACT_APP_EOSIO_PORT } from \"../../common/config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ourNetwork = {\n  chainId: REACT_APP_EOSIO_CHAIN_ID,\n  rpcEndpoints: [{\n    protocol: REACT_APP_EOSIO_PROTOCOL,\n    host: REACT_APP_EOSIO_HOST,\n    port: REACT_APP_EOSIO_PORT\n  }]\n};\nconst contract_account = REACT_APP_EOSIO_ACCOUNT;\nconst defaultState = {\n  activeUser: null,\n  accountName: '',\n  eosio: new EOSIOApi(REACT_APP_EOSIO_CONTRACT_ACCOUNT)\n};\n\nclass DecentralizeApp extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {};\n\n    this.componentDidUpdate = async () => {\n      const {\n        ual: {\n          activeUser\n        }\n      } = this.props;\n\n      if (activeUser && !this.state.activeUser) {\n        await this.updateAccountName(activeUser);\n      } else if (!activeUser && this.state.activeUser) {\n        this.setState(defaultState);\n      }\n    };\n\n    this.updateAccountName = async activeUser => {\n      try {\n        const accountName = await activeUser.getAccountName();\n        localStorage.setItem('activeEosAccount', accountName);\n        await this.props.setActiveEosAccount(accountName);\n        this.setState({\n          activeUser,\n          accountName\n        });\n        let creators = await this.state.eosio.getTableScope('daotokens123', 'accounts', 'bigpicturesw');\n        let daotokensList = await this.state.eosio.getTableRows('daotokens123', accountName, 'accounts');\n        console.log(\"creators...\", creators);\n        console.log(\"daotokensList......\", daotokensList);\n        let totalData = 0;\n\n        if (creators.rows && creators.rows.length > 0) {\n          localStorage.setItem('creatorsList', JSON.stringify(creators.rows));\n\n          for (var i = 0; i < creators.rows.length; i++) totalData += creators.rows[i].count;\n\n          await this.props.setCreatorsList(creators.rows);\n        }\n\n        if (daotokensList.data.rows && daotokensList.data.rows.length > 0) {\n          localStorage.setItem('setDaotokensList', JSON.stringify(daotokensList.data.rows));\n\n          for (var i = 0; i < daotokensList.data.rows.length; i++) await this.props.setDaotokensList(daotokensList.data.rows);\n        }\n\n        let daoList = {};\n\n        if (totalData > 0) {\n          daoList = await this.state.eosio.getTableRows(REACT_APP_EOSIO_CONTRACT_ACCOUNT, 'bigpicturesw', 'dao', 0, totalData, totalData);\n          if (daoList.data.rows && daoList.data.rows.length > 0) localStorage.setItem('daoList', JSON.stringify(daoList.data.rows));\n          await this.props.setOrganisationList(daoList.data.rows);\n        }\n\n        this.setState({\n          accountName,\n          daotokensList: daotokensList.data && daotokensList.data.rows && daotokensList.data.rows,\n          creatorsList: creators.rows && creators.rows,\n          daoList: daoList.data.rows && daoList.data.rows\n        }, this.updateAccountBalance);\n      } catch (e) {\n        console.log(e);\n        console.warn(e);\n      }\n    };\n\n    this.state = { ...defaultState,\n      creatorsList: [],\n      daoList: [],\n      daotokensList: [],\n      rpc: new JsonRpc(`${ourNetwork.rpcEndpoints[0].protocol}://${ourNetwork.rpcEndpoints[0].host}${ourNetwork.rpcEndpoints[0].port !== \"\" ? \":\" : \"\"}${ourNetwork.rpcEndpoints[0].port}`)\n    };\n  }\n\n  render() {\n    const {\n      ual: {\n        activeUser\n      }\n    } = this.props;\n    const {\n      accountName,\n      daoList,\n      creatorsList,\n      daotokensList\n    } = this.state;\n    let propsData = {\n      accountName,\n      activeUser,\n      ual: this.props.ual,\n      daoList,\n      creatorsList,\n      daotokensList\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"DecentralizeApp_main\",\n      children: /*#__PURE__*/_jsxDEV(Router, {\n        children: /*#__PURE__*/_jsxDEV(ScrollToTop, {\n          children: /*#__PURE__*/_jsxDEV(Switch, {\n            children: [/*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/organisation/:menu/:id\",\n              render: props => /*#__PURE__*/_jsxDEV(SideMenuLayout, { ...propsData,\n                children: /*#__PURE__*/_jsxDEV(Organisation, { ...props,\n                  ...propsData\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 101,\n                  columnNumber: 109\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 78\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/\",\n              render: () => /*#__PURE__*/_jsxDEV(HeaderLayout, { ...propsData,\n                children: /*#__PURE__*/_jsxDEV(HomePage, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 102,\n                  columnNumber: 81\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 102,\n                columnNumber: 51\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/CreateOrganisation\",\n              render: props => /*#__PURE__*/_jsxDEV(HeaderLayout, { ...propsData,\n                children: /*#__PURE__*/_jsxDEV(CreateOrganisation, { ...props,\n                  ...propsData\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 104,\n                  columnNumber: 66\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 104,\n                columnNumber: 36\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    organisationList: state.organisations.organistionList,\n    creatorsList: state.organisations.creatorsList,\n    daotokensList: state.organisations.daotokensList,\n    selectedDAO: state.organisations.selectedDAO,\n    activeEosAccount: state.organisations.activeEosAccount\n  };\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setDaotokensList: value => dispatch(actions.setDaotokensList(value)),\n    setCreatorsList: value => dispatch(actions.setCreatorsList(value)),\n    setOrganisationList: value => dispatch(actions.setOrganisationList(value)),\n    setActiveEosAccount: value => dispatch(actions.setActiveEosAccount(value))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DecentralizeApp);","map":{"version":3,"sources":["/home/turbo/devel/MyGame/contracts/eos-hackathon/decentralize-io-ui/src/components/Main/DecentralizeApp.js"],"names":["JsonRpc","React","Component","OrganisationDatePicker","BrowserRouter","Router","Route","Switch","HomePage","CreateOrganisation","ScrollToTop","HeaderLayout","SideMenuLayout","Organisation","EOSIOApi","actions","connect","REACT_APP_EOSIO_CONTRACT_ACCOUNT","REACT_APP_EOSIO_ACCOUNT","REACT_APP_EOSIO_HOST","REACT_APP_EOSIO_CHAIN_ID","REACT_APP_EOSIO_PROTOCOL","REACT_APP_EOSIO_PORT","ourNetwork","chainId","rpcEndpoints","protocol","host","port","contract_account","defaultState","activeUser","accountName","eosio","DecentralizeApp","constructor","props","componentDidMount","componentDidUpdate","ual","state","updateAccountName","setState","getAccountName","localStorage","setItem","setActiveEosAccount","creators","getTableScope","daotokensList","getTableRows","console","log","totalData","rows","length","JSON","stringify","i","count","setCreatorsList","data","setDaotokensList","daoList","setOrganisationList","creatorsList","updateAccountBalance","e","warn","rpc","render","propsData","mapStateToProps","organisationList","organisations","organistionList","selectedDAO","activeEosAccount","mapDispatchToProps","dispatch","value"],"mappings":";AAAA,SAASA,OAAT,QAAwB,OAAxB;AACA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,sBAAP,MAAmC,+CAAnC;AACA,OAAO,sCAAP;AACA,SAASC,aAAa,IAAIC,MAA1B,EAAkCC,KAAlC,EAAyCC,MAAzC,QAAuD,kBAAvD;AACA,OAAOC,QAAP,MAAqB,4BAArB;AACA,OAAOC,kBAAP,MAA+B,gDAA/B;AACA,OAAOC,WAAP,MAAwB,4BAAxB;AACA,OAAOC,YAAP,MAAyB,gCAAzB;AACA,OAAOC,cAAP,MAA2B,oCAA3B;AACA,OAAOC,YAAP,MAAyB,qCAAzB;AACA,OAAOC,QAAP,MAAqB,+BAArB;AACA,OAAO,KAAKC,OAAZ,MAAyB,8BAAzB;AACA,SAASC,OAAT,QAAwB,aAAxB;AAGA,SAASC,gCAAT,EAA2CC,uBAA3C,EAAoEC,oBAApE,EAA0FC,wBAA1F,EAAoHC,wBAApH,EAA8IC,oBAA9I,QAA0K,qBAA1K;;AAGA,MAAMC,UAAU,GAAG;AACjBC,EAAAA,OAAO,EAAEJ,wBADQ;AAEjBK,EAAAA,YAAY,EAAE,CAAC;AAAEC,IAAAA,QAAQ,EAAEL,wBAAZ;AAAsCM,IAAAA,IAAI,EAAER,oBAA5C;AAAkES,IAAAA,IAAI,EAAEN;AAAxE,GAAD;AAFG,CAAnB;AAIA,MAAMO,gBAAgB,GAAGX,uBAAzB;AACA,MAAMY,YAAY,GAAG;AACnBC,EAAAA,UAAU,EAAE,IADO;AAEnBC,EAAAA,WAAW,EAAE,EAFM;AAGnBC,EAAAA,KAAK,EAAE,IAAInB,QAAJ,CAAaG,gCAAb;AAHY,CAArB;;AAMA,MAAMiB,eAAN,SAA8BhC,SAA9B,CAAwC;AAEtCiC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAUnBC,iBAVmB,GAUC,MAAM,CACzB,CAXkB;;AAAA,SAYnBC,kBAZmB,GAYE,YAAY;AAC/B,YAAM;AAAEC,QAAAA,GAAG,EAAE;AAAER,UAAAA;AAAF;AAAP,UAA0B,KAAKK,KAArC;;AACA,UAAIL,UAAU,IAAI,CAAC,KAAKS,KAAL,CAAWT,UAA9B,EAA0C;AACxC,cAAM,KAAKU,iBAAL,CAAuBV,UAAvB,CAAN;AACD,OAFD,MAEO,IAAI,CAACA,UAAD,IAAe,KAAKS,KAAL,CAAWT,UAA9B,EAA0C;AAC/C,aAAKW,QAAL,CAAcZ,YAAd;AACD;AACF,KAnBkB;;AAAA,SAqBnBW,iBArBmB,GAqBC,MAAOV,UAAP,IAAsB;AACxC,UAAI;AACF,cAAMC,WAAW,GAAG,MAAMD,UAAU,CAACY,cAAX,EAA1B;AACAC,QAAAA,YAAY,CAACC,OAAb,CAAqB,kBAArB,EAAyCb,WAAzC;AACA,cAAM,KAAKI,KAAL,CAAWU,mBAAX,CAA+Bd,WAA/B,CAAN;AACA,aAAKU,QAAL,CAAc;AAAEX,UAAAA,UAAF;AAAcC,UAAAA;AAAd,SAAd;AACA,YAAIe,QAAQ,GAAG,MAAM,KAAKP,KAAL,CAAWP,KAAX,CAAiBe,aAAjB,CAA+B,cAA/B,EAA+C,UAA/C,EAA2D,cAA3D,CAArB;AACA,YAAIC,aAAa,GAAG,MAAM,KAAKT,KAAL,CAAWP,KAAX,CAAiBiB,YAAjB,CAA8B,cAA9B,EAA8ClB,WAA9C,EAA2D,UAA3D,CAA1B;AACAmB,QAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BL,QAA3B;AACAI,QAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCH,aAAnC;AACA,YAAII,SAAS,GAAG,CAAhB;;AACA,YAAIN,QAAQ,CAACO,IAAT,IAAiBP,QAAQ,CAACO,IAAT,CAAcC,MAAd,GAAuB,CAA5C,EAA+C;AAC7CX,UAAAA,YAAY,CAACC,OAAb,CAAqB,cAArB,EAAqCW,IAAI,CAACC,SAAL,CAAeV,QAAQ,CAACO,IAAxB,CAArC;;AACA,eAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGX,QAAQ,CAACO,IAAT,CAAcC,MAAlC,EAA0CG,CAAC,EAA3C,EACEL,SAAS,IAAIN,QAAQ,CAACO,IAAT,CAAcI,CAAd,EAAiBC,KAA9B;;AACF,gBAAM,KAAKvB,KAAL,CAAWwB,eAAX,CAA2Bb,QAAQ,CAACO,IAApC,CAAN;AACD;;AACD,YAAIL,aAAa,CAACY,IAAd,CAAmBP,IAAnB,IAA2BL,aAAa,CAACY,IAAd,CAAmBP,IAAnB,CAAwBC,MAAxB,GAAiC,CAAhE,EAAmE;AACjEX,UAAAA,YAAY,CAACC,OAAb,CAAqB,kBAArB,EAAyCW,IAAI,CAACC,SAAL,CAAeR,aAAa,CAACY,IAAd,CAAmBP,IAAlC,CAAzC;;AACA,eAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,aAAa,CAACY,IAAd,CAAmBP,IAAnB,CAAwBC,MAA5C,EAAoDG,CAAC,EAArD,EACE,MAAM,KAAKtB,KAAL,CAAW0B,gBAAX,CAA4Bb,aAAa,CAACY,IAAd,CAAmBP,IAA/C,CAAN;AACH;;AACD,YAAIS,OAAO,GAAG,EAAd;;AACA,YAAIV,SAAS,GAAG,CAAhB,EAAmB;AACjBU,UAAAA,OAAO,GAAG,MAAM,KAAKvB,KAAL,CAAWP,KAAX,CAAiBiB,YAAjB,CAA8BjC,gCAA9B,EAAgE,cAAhE,EAAgF,KAAhF,EAAuF,CAAvF,EAA0FoC,SAA1F,EAAqGA,SAArG,CAAhB;AACA,cAAIU,OAAO,CAACF,IAAR,CAAaP,IAAb,IAAqBS,OAAO,CAACF,IAAR,CAAaP,IAAb,CAAkBC,MAAlB,GAA2B,CAApD,EACEX,YAAY,CAACC,OAAb,CAAqB,SAArB,EAAgCW,IAAI,CAACC,SAAL,CAAeM,OAAO,CAACF,IAAR,CAAaP,IAA5B,CAAhC;AACF,gBAAM,KAAKlB,KAAL,CAAW4B,mBAAX,CAA+BD,OAAO,CAACF,IAAR,CAAaP,IAA5C,CAAN;AACD;;AACD,aAAKZ,QAAL,CAAc;AAAEV,UAAAA,WAAF;AAAeiB,UAAAA,aAAa,EAAEA,aAAa,CAACY,IAAd,IAAsBZ,aAAa,CAACY,IAAd,CAAmBP,IAAzC,IAAiDL,aAAa,CAACY,IAAd,CAAmBP,IAAlG;AAAwGW,UAAAA,YAAY,EAAElB,QAAQ,CAACO,IAAT,IAAiBP,QAAQ,CAACO,IAAhJ;AAAsJS,UAAAA,OAAO,EAAEA,OAAO,CAACF,IAAR,CAAaP,IAAb,IAAqBS,OAAO,CAACF,IAAR,CAAaP;AAAjM,SAAd,EAAuN,KAAKY,oBAA5N;AACD,OA7BD,CA6BE,OAAOC,CAAP,EAAU;AACVhB,QAAAA,OAAO,CAACC,GAAR,CAAYe,CAAZ;AACAhB,QAAAA,OAAO,CAACiB,IAAR,CAAaD,CAAb;AACD;AACF,KAvDkB;;AAEjB,SAAK3B,KAAL,GAAa,EACX,GAAGV,YADQ;AAEXmC,MAAAA,YAAY,EAAE,EAFH;AAGXF,MAAAA,OAAO,EAAE,EAHE;AAIXd,MAAAA,aAAa,EAAE,EAJJ;AAKXoB,MAAAA,GAAG,EAAE,IAAIrE,OAAJ,CAAa,GAAEuB,UAAU,CAACE,YAAX,CAAwB,CAAxB,EAA2BC,QAAS,MAAKH,UAAU,CAACE,YAAX,CAAwB,CAAxB,EAA2BE,IAAK,GAAEJ,UAAU,CAACE,YAAX,CAAwB,CAAxB,EAA2BG,IAA3B,KAAoC,EAApC,GAAyC,GAAzC,GAA+C,EAAG,GAAEL,UAAU,CAACE,YAAX,CAAwB,CAAxB,EAA2BG,IAAK,EAA9K;AALM,KAAb;AAOD;;AAgDD0C,EAAAA,MAAM,GAAG;AACP,UAAM;AAAE/B,MAAAA,GAAG,EAAE;AAAER,QAAAA;AAAF;AAAP,QAA0B,KAAKK,KAArC;AACA,UAAM;AAAEJ,MAAAA,WAAF;AAAe+B,MAAAA,OAAf;AAAwBE,MAAAA,YAAxB;AAAsChB,MAAAA;AAAtC,QAAwD,KAAKT,KAAnE;AACA,QAAI+B,SAAS,GAAG;AACdvC,MAAAA,WADc;AACDD,MAAAA,UADC;AACWQ,MAAAA,GAAG,EAAE,KAAKH,KAAL,CAAWG,GAD3B;AACgCwB,MAAAA,OADhC;AACyCE,MAAAA,YADzC;AACuDhB,MAAAA;AADvD,KAAhB;AAGA,wBACE;AAAK,MAAA,SAAS,EAAC,sBAAf;AAAA,6BACE,QAAC,MAAD;AAAA,+BACE,QAAC,WAAD;AAAA,iCACE,QAAC,MAAD;AAAA,oCACE,QAAC,KAAD;AAAO,cAAA,KAAK,MAAZ;AAAa,cAAA,IAAI,EAAC,yBAAlB;AAA4C,cAAA,MAAM,EAAGb,KAAD,iBAAW,QAAC,cAAD,OAAoBmC,SAApB;AAAA,uCAA+B,QAAC,YAAD,IAAoB,GAAGnC,KAAvB;AAA8B,qBAAGmC;AAAjC;AAAA;AAAA;AAAA;AAAA;AAA/B;AAAA;AAAA;AAAA;AAAA;AAA/D;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE,QAAC,KAAD;AAAO,cAAA,KAAK,MAAZ;AAAa,cAAA,IAAI,EAAC,GAAlB;AAAsB,cAAA,MAAM,EAAE,mBAAM,QAAC,YAAD,OAAkBA,SAAlB;AAAA,uCAA8B,QAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAA9B;AAAA;AAAA;AAAA;AAAA;AAApC;AAAA;AAAA;AAAA;AAAA,oBAFF,eAGE,QAAC,KAAD;AAAO,cAAA,KAAK,MAAZ;AAAa,cAAA,IAAI,EAAC,qBAAlB;AACE,cAAA,MAAM,EAAGnC,KAAD,iBAAW,QAAC,YAAD,OAAkBmC,SAAlB;AAAA,uCAA8B,QAAC,kBAAD,IAA0B,GAAGnC,KAA7B;AAAoC,qBAAGmC;AAAvC;AAAA;AAAA;AAAA;AAAA;AAA9B;AAAA;AAAA;AAAA;AAAA;AADrB;AAAA;AAAA;AAAA;AAAA,oBAHF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADF;AAeD;;AAhFqC;;AAmFxC,SAASC,eAAT,CAAyBhC,KAAzB,EAAgC;AAC9B,SAAO;AACLiC,IAAAA,gBAAgB,EAAEjC,KAAK,CAACkC,aAAN,CAAoBC,eADjC;AAELV,IAAAA,YAAY,EAAEzB,KAAK,CAACkC,aAAN,CAAoBT,YAF7B;AAGLhB,IAAAA,aAAa,EAAET,KAAK,CAACkC,aAAN,CAAoBzB,aAH9B;AAIL2B,IAAAA,WAAW,EAAEpC,KAAK,CAACkC,aAAN,CAAoBE,WAJ5B;AAKLC,IAAAA,gBAAgB,EAAErC,KAAK,CAACkC,aAAN,CAAoBG;AALjC,GAAP;AAOD;;AACD,MAAMC,kBAAkB,GAAGC,QAAQ,IAAI;AACrC,SAAO;AACLjB,IAAAA,gBAAgB,EAAGkB,KAAD,IAAWD,QAAQ,CAAChE,OAAO,CAAC+C,gBAAR,CAAyBkB,KAAzB,CAAD,CADhC;AAELpB,IAAAA,eAAe,EAAGoB,KAAD,IAAWD,QAAQ,CAAChE,OAAO,CAAC6C,eAAR,CAAwBoB,KAAxB,CAAD,CAF/B;AAGLhB,IAAAA,mBAAmB,EAAGgB,KAAD,IAAWD,QAAQ,CAAChE,OAAO,CAACiD,mBAAR,CAA4BgB,KAA5B,CAAD,CAHnC;AAILlC,IAAAA,mBAAmB,EAAGkC,KAAD,IAAWD,QAAQ,CAAChE,OAAO,CAAC+B,mBAAR,CAA4BkC,KAA5B,CAAD;AAJnC,GAAP;AAMD,CAPD;;AASA,eAAehE,OAAO,CAACwD,eAAD,EAAkBM,kBAAlB,CAAP,CAA6C5C,eAA7C,CAAf","sourcesContent":["import { JsonRpc } from 'eosjs'\nimport React, { Component } from 'react';\nimport OrganisationDatePicker from \"../Pages/Organisations/OrganisationDatePicker\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport HomePage from '../Pages/HomePage/HomePage';\nimport CreateOrganisation from '../Pages/CreateOrganisation/CreateOrganisation';\nimport ScrollToTop from '../ScrollToTop/ScrollToTop';\nimport HeaderLayout from '../layouts/Header/HeaderLayout';\nimport SideMenuLayout from \"../layouts/SideMenu/SideMenuLayout\";\nimport Organisation from \"../Pages/Organisations/Organisation\";\nimport EOSIOApi from '../../common/eosio-apiService';\nimport * as actions from \"../Pages/Redux/Actions/index\";\nimport { connect } from \"react-redux\";\n\n\nimport { REACT_APP_EOSIO_CONTRACT_ACCOUNT, REACT_APP_EOSIO_ACCOUNT, REACT_APP_EOSIO_HOST, REACT_APP_EOSIO_CHAIN_ID, REACT_APP_EOSIO_PROTOCOL, REACT_APP_EOSIO_PORT } from \"../../common/config\";\n\n\nconst ourNetwork = {\n  chainId: REACT_APP_EOSIO_CHAIN_ID,\n  rpcEndpoints: [{ protocol: REACT_APP_EOSIO_PROTOCOL, host: REACT_APP_EOSIO_HOST, port: REACT_APP_EOSIO_PORT }]\n}\nconst contract_account = REACT_APP_EOSIO_ACCOUNT;\nconst defaultState = {\n  activeUser: null,\n  accountName: '',\n  eosio: new EOSIOApi(REACT_APP_EOSIO_CONTRACT_ACCOUNT),\n};\n\nclass DecentralizeApp extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      ...defaultState,\n      creatorsList: [],\n      daoList: [],\n      daotokensList: [],\n      rpc: new JsonRpc(`${ourNetwork.rpcEndpoints[0].protocol}://${ourNetwork.rpcEndpoints[0].host}${ourNetwork.rpcEndpoints[0].port !== \"\" ? \":\" : \"\"}${ourNetwork.rpcEndpoints[0].port}`),\n    }\n  }\n  componentDidMount = () => {\n  }\n  componentDidUpdate = async () => {\n    const { ual: { activeUser } } = this.props\n    if (activeUser && !this.state.activeUser) {\n      await this.updateAccountName(activeUser)\n    } else if (!activeUser && this.state.activeUser) {\n      this.setState(defaultState)\n    }\n  }\n\n  updateAccountName = async (activeUser) => {\n    try {\n      const accountName = await activeUser.getAccountName()\n      localStorage.setItem('activeEosAccount', accountName)\n      await this.props.setActiveEosAccount(accountName)\n      this.setState({ activeUser, accountName })\n      let creators = await this.state.eosio.getTableScope('daotokens123', 'accounts', 'bigpicturesw')\n      let daotokensList = await this.state.eosio.getTableRows('daotokens123', accountName, 'accounts')\n      console.log(\"creators...\", creators)\n      console.log(\"daotokensList......\", daotokensList)\n      let totalData = 0\n      if (creators.rows && creators.rows.length > 0) {\n        localStorage.setItem('creatorsList', JSON.stringify(creators.rows))\n        for (var i = 0; i < creators.rows.length; i++)\n          totalData += creators.rows[i].count;\n        await this.props.setCreatorsList(creators.rows)\n      }\n      if (daotokensList.data.rows && daotokensList.data.rows.length > 0) {\n        localStorage.setItem('setDaotokensList', JSON.stringify(daotokensList.data.rows))\n        for (var i = 0; i < daotokensList.data.rows.length; i++)\n          await this.props.setDaotokensList(daotokensList.data.rows)\n      }\n      let daoList = {}\n      if (totalData > 0) {\n        daoList = await this.state.eosio.getTableRows(REACT_APP_EOSIO_CONTRACT_ACCOUNT, 'bigpicturesw', 'dao', 0, totalData, totalData)\n        if (daoList.data.rows && daoList.data.rows.length > 0)\n          localStorage.setItem('daoList', JSON.stringify(daoList.data.rows))\n        await this.props.setOrganisationList(daoList.data.rows)\n      }\n      this.setState({ accountName, daotokensList: daotokensList.data && daotokensList.data.rows && daotokensList.data.rows, creatorsList: creators.rows && creators.rows, daoList: daoList.data.rows && daoList.data.rows }, this.updateAccountBalance)\n    } catch (e) {\n      console.log(e)\n      console.warn(e)\n    }\n  }\n\n  render() {\n    const { ual: { activeUser } } = this.props\n    const { accountName, daoList, creatorsList, daotokensList } = this.state\n    let propsData = {\n      accountName, activeUser, ual: this.props.ual, daoList, creatorsList, daotokensList\n    }\n    return (\n      <div className=\"DecentralizeApp_main\">\n        <Router >\n          <ScrollToTop>\n            <Switch>\n              <Route exact path=\"/organisation/:menu/:id\" render={(props) => <SideMenuLayout {...propsData}><Organisation {...{ ...props, ...propsData }} /></SideMenuLayout>} />\n              <Route exact path=\"/\" render={() => <HeaderLayout {...propsData} ><HomePage /></HeaderLayout>} />\n              <Route exact path=\"/CreateOrganisation\"\n                render={(props) => <HeaderLayout {...propsData} ><CreateOrganisation {...{ ...props, ...propsData }}/>\n                </HeaderLayout>} />\n            </Switch>\n          </ScrollToTop>\n        </Router>\n      </div>\n    )\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    organisationList: state.organisations.organistionList,\n    creatorsList: state.organisations.creatorsList,\n    daotokensList: state.organisations.daotokensList,\n    selectedDAO: state.organisations.selectedDAO,\n    activeEosAccount: state.organisations.activeEosAccount\n  };\n}\nconst mapDispatchToProps = dispatch => {\n  return {\n    setDaotokensList: (value) => dispatch(actions.setDaotokensList(value)),\n    setCreatorsList: (value) => dispatch(actions.setCreatorsList(value)),\n    setOrganisationList: (value) => dispatch(actions.setOrganisationList(value)),\n    setActiveEosAccount: (value) => dispatch(actions.setActiveEosAccount(value))\n  }\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DecentralizeApp);"]},"metadata":{},"sourceType":"module"}