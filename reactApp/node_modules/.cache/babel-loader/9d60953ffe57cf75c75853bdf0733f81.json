{"ast":null,"code":"var _jsxFileName = \"/home/turbo/devel/MyGame/contracts/eos-hackathon/decentralize-io-ui/src/components/Main/DecentralizeApp.js\";\nimport { JsonRpc } from 'eosjs';\nimport React, { Component } from 'react';\nimport OrganisationDatePicker from \"../Pages/Organisations/OrganisationDatePicker\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport HomePage from '../Pages/HomePage/HomePage';\nimport CreateOrganisation from '../Pages/CreateOrganisation/CreateOrganisation';\nimport ScrollToTop from '../ScrollToTop/ScrollToTop';\nimport HeaderLayout from '../layouts/Header/HeaderLayout';\nimport SideMenuLayout from \"../layouts/SideMenu/SideMenuLayout\";\nimport Organisation from \"../Pages/Organisations/Organisation\";\nimport EOSIOApi from '../../common/eosio-apiService';\nimport * as actions from \"../Pages/Redux/Actions/index\";\nimport { connect } from \"react-redux\";\nimport { REACT_APP_EOSIO_CONTRACT_ACCOUNT, REACT_APP_EOSIO_ACCOUNT, REACT_APP_EOSIO_HOST, REACT_APP_EOSIO_CHAIN_ID, REACT_APP_EOSIO_PROTOCOL, REACT_APP_EOSIO_PORT } from \"../../common/config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ourNetwork = {\n  chainId: REACT_APP_EOSIO_CHAIN_ID,\n  rpcEndpoints: [{\n    protocol: REACT_APP_EOSIO_PROTOCOL,\n    host: REACT_APP_EOSIO_HOST,\n    port: REACT_APP_EOSIO_PORT\n  }]\n};\nconst contract_account = REACT_APP_EOSIO_ACCOUNT;\nconst defaultState = {\n  activeUser: null,\n  accountName: '',\n  eosio: new EOSIOApi(REACT_APP_EOSIO_CONTRACT_ACCOUNT)\n};\n\nclass DecentralizeApp extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {};\n\n    this.componentDidUpdate = async () => {\n      const {\n        ual: {\n          activeUser\n        }\n      } = this.props;\n\n      if (activeUser && !this.state.activeUser) {\n        await this.updateAccountName(activeUser);\n      } else if (!activeUser && this.state.activeUser) {\n        this.setState(defaultState);\n      }\n    };\n\n    this.updateAccountName = async activeUser => {\n      try {\n        const accountName = await activeUser.getAccountName();\n        localStorage.setItem('activeEosAccount', accountName);\n        await this.props.setActiveEosAccount(accountName);\n        this.setState({\n          activeUser,\n          accountName\n        });\n        let totalVotings = 0,\n            tokenprp = await this.state.eosio.getTableScope('bigpicturesw', 'tokenprp', 'bigpicturesw'),\n            votingprp = await this.state.eosio.getTableScope('bigpicturesw', 'votingprp', 'bigpicturesw');\n\n        if (tokenprp.rows && tokenprp.rows.length > 0) {\n          for (var i = 0; i < tokenprp.rows.length; i++) totalVotings += tokenprp.rows[i].count;\n        }\n\n        if (votingprp.rows && votingprp.rows.length > 0) {\n          for (var i = 0; i < votingprp.rows.length; i++) totalVotings += votingprp.rows[i].count;\n        }\n\n        let totalData = 0,\n            creators = await this.state.eosio.getTableScope('daotokens123', 'accounts', 'bigpicturesw');\n        let creatorsCount = creators.rows.filter(obj => obj.scope === accountName);\n        console.log(\"creatorsCount......\", creatorsCount);\n        let daotokensList = await this.state.eosio.getTableRows('daotokens123', accountName, 'accounts', 0, creatorsCount[0].count, creatorsCount[0].count);\n\n        if (creators.rows && creators.rows.length > 0) {\n          for (var i = 0; i < creators.rows.length; i++) totalData += creators.rows[i].count;\n\n          await this.props.setCreatorsList(creators.rows);\n        }\n\n        if (daotokensList.data.rows && daotokensList.data.rows.length > 0) {\n          for (var i = 0; i < daotokensList.data.rows.length; i++) await this.props.setDaotokensList(daotokensList.data.rows);\n        }\n\n        let daoList = {};\n\n        if (totalData > 0) {\n          daoList = await this.state.eosio.getTableRows(REACT_APP_EOSIO_CONTRACT_ACCOUNT, 'bigpicturesw', 'dao', 0, totalData, totalData);\n          await this.props.setOrganisationList(daoList.data.rows);\n        }\n\n        this.setState({\n          accountName,\n          totalVotings,\n          creatorsList: creators.rows && creators.rows,\n          daoList: daoList.data.rows && daoList.data.rows,\n          daotokensList: daotokensList.data && daotokensList.data.rows && daotokensList.data.rows\n        }, this.updateAccountBalance);\n      } catch (e) {\n        console.log(e);\n        console.warn(e);\n      }\n    };\n\n    this.state = { ...defaultState,\n      creatorsList: [],\n      daoList: [],\n      daotokensList: [],\n      totalVotings: 0,\n      rpc: new JsonRpc(`${ourNetwork.rpcEndpoints[0].protocol}://${ourNetwork.rpcEndpoints[0].host}${ourNetwork.rpcEndpoints[0].port !== \"\" ? \":\" : \"\"}${ourNetwork.rpcEndpoints[0].port}`)\n    };\n  }\n\n  render() {\n    const {\n      ual: {\n        activeUser\n      }\n    } = this.props;\n    const {\n      accountName,\n      daoList,\n      creatorsList,\n      daotokensList,\n      totalVotings\n    } = this.state;\n    let propsData = {\n      accountName,\n      activeUser,\n      ual: this.props.ual,\n      daoList,\n      creatorsList,\n      daotokensList,\n      totalVotings\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"DecentralizeApp_main\",\n      children: /*#__PURE__*/_jsxDEV(Router, {\n        children: /*#__PURE__*/_jsxDEV(ScrollToTop, {\n          children: /*#__PURE__*/_jsxDEV(Switch, {\n            children: [/*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/organisation/:menu/:id\",\n              render: props => /*#__PURE__*/_jsxDEV(SideMenuLayout, { ...propsData,\n                children: /*#__PURE__*/_jsxDEV(Organisation, { ...props,\n                  ...propsData\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 119,\n                  columnNumber: 109\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 78\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/\",\n              render: () => /*#__PURE__*/_jsxDEV(HeaderLayout, { ...propsData,\n                children: /*#__PURE__*/_jsxDEV(HomePage, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 81\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 51\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/CreateOrganisation\",\n              render: props => /*#__PURE__*/_jsxDEV(HeaderLayout, { ...propsData,\n                children: /*#__PURE__*/_jsxDEV(CreateOrganisation, { ...props,\n                  ...propsData\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 122,\n                  columnNumber: 66\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 36\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    organisationList: state.organisations.organistionList,\n    creatorsList: state.organisations.creatorsList,\n    daotokensList: state.organisations.daotokensList,\n    selectedDAO: state.organisations.selectedDAO,\n    activeEosAccount: state.organisations.activeEosAccount\n  };\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setDaotokensList: value => dispatch(actions.setDaotokensList(value)),\n    setCreatorsList: value => dispatch(actions.setCreatorsList(value)),\n    setOrganisationList: value => dispatch(actions.setOrganisationList(value)),\n    setActiveEosAccount: value => dispatch(actions.setActiveEosAccount(value))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DecentralizeApp);","map":{"version":3,"sources":["/home/turbo/devel/MyGame/contracts/eos-hackathon/decentralize-io-ui/src/components/Main/DecentralizeApp.js"],"names":["JsonRpc","React","Component","OrganisationDatePicker","BrowserRouter","Router","Route","Switch","HomePage","CreateOrganisation","ScrollToTop","HeaderLayout","SideMenuLayout","Organisation","EOSIOApi","actions","connect","REACT_APP_EOSIO_CONTRACT_ACCOUNT","REACT_APP_EOSIO_ACCOUNT","REACT_APP_EOSIO_HOST","REACT_APP_EOSIO_CHAIN_ID","REACT_APP_EOSIO_PROTOCOL","REACT_APP_EOSIO_PORT","ourNetwork","chainId","rpcEndpoints","protocol","host","port","contract_account","defaultState","activeUser","accountName","eosio","DecentralizeApp","constructor","props","componentDidMount","componentDidUpdate","ual","state","updateAccountName","setState","getAccountName","localStorage","setItem","setActiveEosAccount","totalVotings","tokenprp","getTableScope","votingprp","rows","length","i","count","totalData","creators","creatorsCount","filter","obj","scope","console","log","daotokensList","getTableRows","setCreatorsList","data","setDaotokensList","daoList","setOrganisationList","creatorsList","updateAccountBalance","e","warn","rpc","render","propsData","mapStateToProps","organisationList","organisations","organistionList","selectedDAO","activeEosAccount","mapDispatchToProps","dispatch","value"],"mappings":"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","sourcesContent":["import { JsonRpc } from 'eosjs'\nimport React, { Component } from 'react';\nimport OrganisationDatePicker from \"../Pages/Organisations/OrganisationDatePicker\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport HomePage from '../Pages/HomePage/HomePage';\nimport CreateOrganisation from '../Pages/CreateOrganisation/CreateOrganisation';\nimport ScrollToTop from '../ScrollToTop/ScrollToTop';\nimport HeaderLayout from '../layouts/Header/HeaderLayout';\nimport SideMenuLayout from \"../layouts/SideMenu/SideMenuLayout\";\nimport Organisation from \"../Pages/Organisations/Organisation\";\nimport EOSIOApi from '../../common/eosio-apiService';\nimport * as actions from \"../Pages/Redux/Actions/index\";\nimport { connect } from \"react-redux\";\n\n\nimport { REACT_APP_EOSIO_CONTRACT_ACCOUNT, REACT_APP_EOSIO_ACCOUNT, REACT_APP_EOSIO_HOST, REACT_APP_EOSIO_CHAIN_ID, REACT_APP_EOSIO_PROTOCOL, REACT_APP_EOSIO_PORT } from \"../../common/config\";\n\n\nconst ourNetwork = {\n  chainId: REACT_APP_EOSIO_CHAIN_ID,\n  rpcEndpoints: [{ protocol: REACT_APP_EOSIO_PROTOCOL, host: REACT_APP_EOSIO_HOST, port: REACT_APP_EOSIO_PORT }]\n}\nconst contract_account = REACT_APP_EOSIO_ACCOUNT;\nconst defaultState = {\n  activeUser: null,\n  accountName: '',\n  eosio: new EOSIOApi(REACT_APP_EOSIO_CONTRACT_ACCOUNT),\n};\n\nclass DecentralizeApp extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      ...defaultState,\n      creatorsList: [],\n      daoList: [],\n      daotokensList: [],\n      totalVotings: 0,\n      rpc: new JsonRpc(`${ourNetwork.rpcEndpoints[0].protocol}://${ourNetwork.rpcEndpoints[0].host}${ourNetwork.rpcEndpoints[0].port !== \"\" ? \":\" : \"\"}${ourNetwork.rpcEndpoints[0].port}`),\n    }\n  }\n  componentDidMount = () => {\n  }\n  componentDidUpdate = async () => {\n    const { ual: { activeUser } } = this.props\n    if (activeUser && !this.state.activeUser) {\n      await this.updateAccountName(activeUser)\n    } else if (!activeUser && this.state.activeUser) {\n      this.setState(defaultState)\n    }\n  }\n\n  updateAccountName = async (activeUser) => {\n    try {\n      const accountName = await activeUser.getAccountName()\n      localStorage.setItem('activeEosAccount', accountName)\n      await this.props.setActiveEosAccount(accountName)\n      this.setState({ activeUser, accountName })\n      let totalVotings = 0,\n        tokenprp = await this.state.eosio.getTableScope('bigpicturesw', 'tokenprp', 'bigpicturesw'),\n        votingprp = await this.state.eosio.getTableScope('bigpicturesw', 'votingprp', 'bigpicturesw')\n\n      if (tokenprp.rows && tokenprp.rows.length > 0) {\n        for (var i = 0; i < tokenprp.rows.length; i++)\n          totalVotings += tokenprp.rows[i].count;\n      }\n\n      if (votingprp.rows && votingprp.rows.length > 0) {\n        for (var i = 0; i < votingprp.rows.length; i++)\n          totalVotings += votingprp.rows[i].count;\n      }\n\n      let totalData = 0,\n        creators = await this.state.eosio.getTableScope('daotokens123', 'accounts', 'bigpicturesw')\n      let creatorsCount= creators.rows.filter(obj=>obj.scope===accountName)\n       console.log(\"creatorsCount......\",creatorsCount)\n      let daotokensList = await this.state.eosio.getTableRows('daotokens123', accountName, 'accounts',0,creatorsCount[0].count,creatorsCount[0].count)\n\n      if (creators.rows && creators.rows.length > 0) {\n        for (var i = 0; i < creators.rows.length; i++)\n          totalData += creators.rows[i].count;\n        await this.props.setCreatorsList(creators.rows)\n      }\n      if (daotokensList.data.rows && daotokensList.data.rows.length > 0) {\n        for (var i = 0; i < daotokensList.data.rows.length; i++)\n          await this.props.setDaotokensList(daotokensList.data.rows)\n      }\n      let daoList = {}\n      if (totalData > 0) {\n        daoList = await this.state.eosio.getTableRows(REACT_APP_EOSIO_CONTRACT_ACCOUNT, 'bigpicturesw', 'dao', 0, totalData, totalData)\n        await this.props.setOrganisationList(daoList.data.rows)\n      }\n      this.setState({\n        accountName,\n        totalVotings,\n        creatorsList: creators.rows && creators.rows,\n        daoList: daoList.data.rows && daoList.data.rows,\n        daotokensList: daotokensList.data && daotokensList.data.rows && daotokensList.data.rows\n      }, this.updateAccountBalance)\n    } catch (e) {\n      console.log(e)\n      console.warn(e)\n    }\n  }\n\n  render() {\n    const { ual: { activeUser } } = this.props\n    const { accountName, daoList, creatorsList, daotokensList, totalVotings } = this.state\n    let propsData = {\n      accountName, activeUser, ual: this.props.ual, daoList, creatorsList, daotokensList, totalVotings\n    }\n    return (\n      <div className=\"DecentralizeApp_main\">\n        <Router >\n          <ScrollToTop>\n            <Switch>\n              <Route exact path=\"/organisation/:menu/:id\" render={(props) => <SideMenuLayout {...propsData}><Organisation {...{ ...props, ...propsData }} /></SideMenuLayout>} />\n              <Route exact path=\"/\" render={() => <HeaderLayout {...propsData} ><HomePage /></HeaderLayout>} />\n              <Route exact path=\"/CreateOrganisation\"\n                render={(props) => <HeaderLayout {...propsData} ><CreateOrganisation {...{ ...props, ...propsData }} />\n                </HeaderLayout>} />\n            </Switch>\n          </ScrollToTop>\n        </Router>\n      </div>\n    )\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    organisationList: state.organisations.organistionList,\n    creatorsList: state.organisations.creatorsList,\n    daotokensList: state.organisations.daotokensList,\n    selectedDAO: state.organisations.selectedDAO,\n    activeEosAccount: state.organisations.activeEosAccount\n  };\n}\nconst mapDispatchToProps = dispatch => {\n  return {\n    setDaotokensList: (value) => dispatch(actions.setDaotokensList(value)),\n    setCreatorsList: (value) => dispatch(actions.setCreatorsList(value)),\n    setOrganisationList: (value) => dispatch(actions.setOrganisationList(value)),\n    setActiveEosAccount: (value) => dispatch(actions.setActiveEosAccount(value))\n  }\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DecentralizeApp);"]},"metadata":{},"sourceType":"module"}