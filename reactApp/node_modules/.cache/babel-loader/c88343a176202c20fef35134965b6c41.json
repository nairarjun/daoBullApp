{"ast":null,"code":"/**\n * Anchor Link Browser Transport v3.1.2\n * https://github.com/greymass/anchor-link-browser-transport\n *\n * @license\n * Copyright (c) 2020 Greymass Inc. All Rights Reserved.\n * \n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n * \n *  1. Redistribution of source code must retain the above copyright notice, this\n *     list of conditions and the following disclaimer.\n * \n *  2. Redistribution in binary form must reproduce the above copyright notice,\n *     this list of conditions and the following disclaimer in the documentation\n *     and/or other materials provided with the distribution.\n * \n *  3. Neither the name of the copyright holder nor the names of its contributors\n *     may be used to endorse or promote products derived from this software without\n *     specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n * \n * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE\n * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.\n */\nimport { Signature, SigningRequest, PlaceholderName, Link, Base64u, isInstanceOf, APIError } from 'anchor-link';\nvar styleText = `\n/* Anchor Link */\n\n.%prefix% * {\n    box-sizing: border-box;\n    line-height: 1;\n}\n\n.%prefix% {\n    font-family: -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue',\n        Arial, sans-serif;\n    font-size: 13px;\n    background: rgba(0, 0, 0, 0.65);\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    z-index: 2147483647;\n    display: none;\n    align-items: center;\n    justify-content: center;\n}\n\n.%prefix%-active {\n    display: flex;\n}\n\n.%prefix%-inner {\n    background: #EFF1F7;\n    margin: 20px;\n    padding-top: 50px;\n    border-radius: 20px;\n    box-shadow: 0px 4px 100px rgba(0, 0, 0, .5);\n    width: 340px;\n    position: relative;\n}\n\n.%prefix%-close {\n    display: block;\n    position: absolute;\n    top: 11px;\n    right: 16px;\n    width: 28px;\n    height: 28px;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M.57 12.1a.96.96 0 000 1.34c.37.36 1 .36 1.34 0L7 8.37l5.09 5.09c.36.35.97.35 1.34-.01a.96.96 0 000-1.34L8.34 7.01l5.08-5.08a.95.95 0 000-1.33.97.97 0 00-1.34-.01L6.99 5.68 1.91.59a.96.96 0 00-1.33 0 .97.97 0 00-.01 1.34l5.09 5.08-5.1 5.1z' fill='%23007AFF'/%3E%3C/svg%3E\");\n    background-size: 14px;\n    background-repeat: no-repeat;\n    background-position: 50% 7px;\n    border-radius: 100%;\n    cursor: pointer;\n}\n\n.%prefix%-close:hover {\n    background-color: white;\n}\n\n.%prefix%-version {\n    position: absolute;\n    top: 19px;\n    left: 20px;\n    cursor: help;\n    color: #B8C0DA;\n    opacity: 0.1;\n}\n\n.%prefix%-version:hover {\n    opacity: 1;\n}\n\n.%prefix%-logo {\n    width: 70px;\n    height: 70px;\n    margin: 0 auto;\n    margin-top: -56px;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23fff' d='M18.81 9.19h33.25V59.5H18.81z'/%3E%3Cpath d='M38.45 28.88h-6.9L35 21.77l3.45 7.1z' fill='%233650A2'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M35 70a35 35 0 100-70 35 35 0 000 70zm2.36-55.4a2.62 2.62 0 00-4.72 0L21.9 36.75h5.84l1.7-3.5h11.13l1.7 3.5h5.83L37.36 14.6zM48.13 44.2h-5.26a7.76 7.76 0 01-5.24 7v-10.5a2.62 2.62 0 10-5.25 0v10.5a7.76 7.76 0 01-5.25-7h-5.25c.16 7.06 6 12.69 13.12 12.69 7.12 0 12.97-5.63 13.13-12.7z' fill='%233650A2'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-fuel {\n    width: 70px;\n    height: 70px;\n    margin: 0 auto;\n    margin-top: -56px;\n    background-image: url(\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='linear-gradient-25' x1='104.79' y1='197.49' x2='131.55' y2='108.35' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0.38' stop-color='%23f6b621'/%3E%3Cstop offset='0.59' stop-color='%23e89124'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cg id='brain-logo' style='' transform='matrix(1, 0, 0, 1, -0.005538, -0.040005)'%3E%3Cg%3E%3Cpath class='cls-4' d='M251.93,111.13,221.28,71.51A23.76,23.76,0,0,0,209,63.61l-77.7-18.09a25.86,25.86,0,0,0-5.78-.6,28.22,28.22,0,0,0-7.88,1L99.06,51.58a6.31,6.31,0,0,0-.61-5l-5.3-9a6.36,6.36,0,0,0-5.47-3.13h0a6.57,6.57,0,0,0-1.92.29L49.61,46.21a6.34,6.34,0,0,0-4.41,6.28l.46,12.2a6.2,6.2,0,0,0,.78,2.81L38.2,70a21.1,21.1,0,0,0-11.73,9.76L3,125.21a17.78,17.78,0,0,0,.54,16.32l12.68,21A16.19,16.19,0,0,0,29.69,170a13.25,13.25,0,0,0,1.67-.1L65,165.81a17.22,17.22,0,0,0,9.2,13.64l12.86,6.08a32.51,32.51,0,0,0,12.26,2.63c.35,0,.7,0,1,0l29.17-1.61a6.12,6.12,0,0,1,2.64,1l29.05,28.79a20,20,0,0,0,13.27,5.29c.52,0,1,0,1.53-.07l23.93-2.47c4.31-.44,7.67-2.87,9-6.48s.36-7.64-2.63-10.78l-10.09-10.64,19.07-5.64a15.76,15.76,0,0,0,10.83-13.09L227.65,157a10.69,10.69,0,0,1,1.86-4.19l21.74-24a14,14,0,0,0,.68-17.65Z' style='fill: rgb(255, 255, 255);'/%3E%3Cg%3E%3Ccircle class='cls-2' cx='173.24' cy='107.45' r='6.19' transform='translate(7.67 226.39) rotate(-67.5)' style='fill: rgb(246, 182, 33);'/%3E%3Cpath class='cls-2' d='M101,97.06a3.71,3.71,0,1,0-3.71-3.71A3.71,3.71,0,0,0,101,97.06Z' style='fill: rgb(246, 182, 33);'/%3E%3Ccircle class='cls-2' cx='135.4' cy='76.29' r='3.71' style='fill: rgb(246, 182, 33);'/%3E%3Cg%3E%3Cpath class='cls-21' d='M79.24,128c-16.71,0-37.79,7.36-48.93,11.68a2.39,2.39,0,0,0-1.19,3.46L33.8,151a2.38,2.38,0,0,0,2.34,1.14L69.27,148a12.74,12.74,0,0,1,1.63-.1,13.22,13.22,0,0,1,13.26,12.74l0,1.1a2.4,2.4,0,0,0,1.37,2.07l10.56,5a14.8,14.8,0,0,0,4.69.95H101L129,168.24c.28,0,.57,0,.85,0a21.23,21.23,0,0,1,14.06,5.68l27.82,27.56a4,4,0,0,0,1.26.45l6.07-.75a1.22,1.22,0,0,0,.86-1.9l-3-4.36a11.51,11.51,0,0,1,5.21-19.44l23.4-6.93a1.44,1.44,0,0,0,1-1.23l1.26-12.72v0a1.44,1.44,0,0,0-1.81-1.54c-8.26,2.21-22.73,5.72-31.63,5.72C136.65,158.74,108.72,128,79.24,128Zm32.48,27a2.77,2.77,0,0,1-1,1,3.78,3.78,0,0,1-5.23-5.23,2.77,2.77,0,0,1,1-1A3.78,3.78,0,0,1,111.72,155Zm63.76,13.39a2.62,2.62,0,0,1-1,1,3.78,3.78,0,0,1-5.23-5.23,2.77,2.77,0,0,1,1-1A3.78,3.78,0,0,1,175.48,168.36Z' style='fill: url(%23linear-gradient-25);'/%3E%3Cpath class='cls-2' d='M173.34,127.62c-37.69,0-69.59-16.73-92.46-16.73-16.08,0-43.36,12.17-55.32,21a2,2,0,0,0-.65,2.46c.35.8.82,1.84,1.26,2.82a2,2,0,0,0,2.62,1C39.07,134,61,125.9,79.24,125.9c30.45,0,58.48,27,91.13,27,14.49,0,35.75-5.69,41.3-10.16,2.42-2.52,10.36-11.93,16-17.78a2.39,2.39,0,0,0-2.32-3.94C214.49,123.51,193.73,127.62,173.34,127.62Zm-1.68,14.25a5.28,5.28,0,0,1-2.49,2.49,6.27,6.27,0,0,1-8.48-8.48,5.37,5.37,0,0,1,2.49-2.49A6.27,6.27,0,0,1,171.66,141.87Z' style='fill: rgb(246, 182, 33);'/%3E%3C/g%3E%3Cpath class='cls-1' d='M248.71,113.13,218.06,73.51a20.05,20.05,0,0,0-10-6.43L130.34,49a25.7,25.7,0,0,0-11.57.38L91.41,57.65a.05.05,0,0,1-.07,0L89.56,53a.05.05,0,0,1,0-.07l4.06-1.46a2.45,2.45,0,0,0,1-.62,2.29,2.29,0,0,0,.29-2.72l-5.29-9a2.3,2.3,0,0,0-2.67-1L50.83,49.59a2.28,2.28,0,0,0-1.59,2.27l.46,12.2a2.27,2.27,0,0,0,1,1.8,2.3,2.3,0,0,0,1.28.4,2.33,2.33,0,0,0,.78-.14l9.18-3.29a0,0,0,0,1,.06,0L63.58,66a0,0,0,0,1,0,.07L39.37,73.4a17.25,17.25,0,0,0-9.31,7.74L6.58,126.59A13.67,13.67,0,0,0,7,139l12.68,21a12.1,12.1,0,0,0,11.19,5.45l37.08-4.54a.83.83,0,0,1,.68.18.82.82,0,0,1,.28.64l.14,3.22a13.25,13.25,0,0,0,6.88,10.39l12.86,6.08a28,28,0,0,0,11.32,2.21l29.2-1.61a9.38,9.38,0,0,1,5.68,2.16L164,212.94a16,16,0,0,0,10.41,4.12,10,10,0,0,0,1.11-.06l23.93-2.46c2.77-.29,4.82-1.69,5.62-3.85s.15-4.56-1.77-6.58l-14.6-15.38a.06.06,0,0,1,0-.09l25.35-7.5a11.74,11.74,0,0,0,7.94-9.59l1.53-15.46a14.22,14.22,0,0,1,2.9-6.52l21.74-24A9.94,9.94,0,0,0,248.71,113.13ZM56.08,56.65,56,54.81a1.29,1.29,0,0,1,.88-1.29l28-9a1.28,1.28,0,0,1,1.48.57l.48.83a1.27,1.27,0,0,1-.68,1.83l-28.35,10A1.27,1.27,0,0,1,56.08,56.65Zm186.57,63.93-21.71,24a21.37,21.37,0,0,0-4.79,10.8l-1.54,15.46A4.37,4.37,0,0,1,212,174l-26.5,7.84a6.52,6.52,0,0,0-3,11.2L194,205.17a1.49,1.49,0,0,1-.93,2.5l-18.31,1.89a8.37,8.37,0,0,1-5.49-1.94l-29.06-28.8a16.74,16.74,0,0,0-10.77-4.33l-.59,0-29.21,1.61a20.07,20.07,0,0,1-7.69-1.5l-12.87-6.09a5,5,0,0,1-2.61-3.93l-.13-3.22A8.27,8.27,0,0,0,67,153.44L29.94,158a4.75,4.75,0,0,1-3.87-1.88l-12.68-21a6.38,6.38,0,0,1-.17-5.05L36.71,84.58a10.08,10.08,0,0,1,4.82-4l79.41-24a18.68,18.68,0,0,1,7.7-.25l77.7,18.09a12.72,12.72,0,0,1,5.8,3.72l30.62,39.59A2.35,2.35,0,0,1,242.65,120.58Z' style='fill: rgb(42, 54, 64);'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo.loading {\n    border-radius: 100%;\n    background-color: #3650A2;\n    background-image: url(\"data:image/svg+xml,%3Csvg viewBox='0.5 0.5 45 45' xmlns='http://www.w3.org/2000/svg' stroke='%23fff'%3E%3Cg fill='none' fill-rule='evenodd' transform='translate(1 1)' stroke-width='2'%3E%3Ccircle cx='22' cy='22' r='6' stroke-opacity='0'%3E%3Canimate attributeName='r' begin='1.5s' dur='3s' values='6;22' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-opacity' begin='1.5s' dur='3s' values='1;0' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-width' begin='1.5s' dur='3s' values='2;0' calcMode='linear' repeatCount='indefinite' /%3E%3C/circle%3E%3Ccircle cx='22' cy='22' r='6' stroke-opacity='0'%3E%3Canimate attributeName='r' begin='3s' dur='3s' values='6;22' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-opacity' begin='3s' dur='3s' values='1;0' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-width' begin='3s' dur='3s' values='2;0' calcMode='linear' repeatCount='indefinite' /%3E%3C/circle%3E%3Ccircle cx='22' cy='22' r='8'%3E%3Canimate attributeName='r' begin='0s' dur='1.5s' values='6;1;2;3;4;5;6' calcMode='linear' repeatCount='indefinite' /%3E%3C/circle%3E%3C/g%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo.error {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%23FC3D39'/%3E%3Cpath fill='%23fff' d='M22.3 48h25.4c2.5 0 4-1.7 4-4a4 4 0 00-.5-2L38.5 19.3a4 4 0 00-3.5-2 4 4 0 00-3.5 2L18.8 42.1c-.3.6-.5 1.3-.5 2 0 2.2 1.6 4 4 4zM35 37c-.9 0-1.4-.6-1.4-1.5l-.2-7.7c0-.9.6-1.6 1.6-1.6s1.7.7 1.7 1.6l-.3 7.7c0 1-.5 1.5-1.4 1.5zm0 6c-1 0-1.9-.8-1.9-1.8s.9-1.8 2-1.8c1 0 1.8.7 1.8 1.8 0 1-.9 1.8-1.9 1.8z'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo.success {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%233DC55D'/%3E%3Cpath fill='%23fff' d='M30.9 49.7a2 2 0 001.8-1L48 24.9c.3-.5.4-1 .4-1.4 0-1-.7-1.7-1.7-1.7-.8 0-1.2.3-1.6 1L30.8 45.4 23.5 36c-.5-.6-1-.9-1.6-.9-1 0-1.8.8-1.8 1.8 0 .4.2.9.6 1.3L29 48.7c.6.7 1.1 1 1.9 1z'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-request {\n    padding: 20px;\n    border-radius: 20px;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n    background: white;\n}\n\n.%prefix%-fee,\n.%prefix%-info {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.%prefix%-title {\n    color: #000000;\n    font-size: 25px;\n    margin-top: 14px;\n    font-weight: 700;\n    line-height: 30px;\n    letter-spacing: 0.5px;\n}\n\n.%prefix%-subtitle {\n    margin-top: 14px;\n    color: #5C5C5C;\n    text-align: center;\n    line-height: 1.4;\n    word-break: break-word;\n}\n\n.%prefix%-subtitle a {\n    color: #000000;\n    cursor: pointer;\n    text-decoration: underline;\n}\n\n.%prefix%-actions {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.%prefix%-uri {\n    width: 100%;\n}\n\n.%prefix%-button {\n    color: #007AFF;\n    background: #EFF1F7;\n    border: 1px solid #EFF1F7;\n    text-decoration: none;\n    font-size: 17px;\n    flex-grow: 1;\n    flex: 1;\n    width: 100%;\n    line-height: 1;\n    padding: 20px 18px;\n    border-radius: 12px;\n    font-weight: 400;\n    text-align: center;\n    display: block;\n    margin-top: 21px;\n    cursor: pointer;\n}\n\n.%prefix%-button:hover {\n    border: 1px solid #007AFF;\n}\n\n.%prefix%-qr {\n    margin-top: 21px;\n}\n\n.%prefix%-qr svg {\n    width: 100%;\n    display: block;\n    shape-rendering: crispEdges;\n}\n\n.%prefix%-qr svg rect {\n    fill: black;\n}\n\n.%prefix%-footnote {\n    text-align: center;\n    width: 100%;\n    position: absolute;\n    bottom: -26px;\n    left: 0;\n    color: white;\n}\n\n.%prefix%-footnote a {\n    color: white;\n    text-decoration: underline;\n}\n\n.%prefix%-wskeepalive {\n    display: none;\n}\n\n.%prefix%-choice {\n    text-align: center;\n    width: 100%;\n    color: #666;\n}\n\n.%prefix%-choice span {\n    display: block;\n    margin-top: 1em;\n}\n\n.%prefix%-choice a:not(.%prefix%-button) {\n    display: block;\n    cursor: pointer;\n    text-decoration: underline;\n    margin-top: 1em;\n}\n\n@media (prefers-color-scheme: dark) {\n    .%prefix%-inner {\n        background: #262D43;\n        color: white;\n    }\n    .%prefix%-request {\n        background: #131B33;\n    }\n    .%prefix%-title {\n        color: #FCFCFC;\n    }\n    .%prefix%-subtitle {\n        color: #B8C0DA;\n    }\n    .%prefix%-subtitle a {\n        color: #FCFCFC;\n    }\n    .%prefix%-qr svg rect {\n        fill: white;\n    }\n    .%prefix%-version {\n        color: #546AAF;\n    }\n    .%prefix%-choice {\n        color: #888ea1;\n    }\n    .%prefix%-button {\n        color: #FCFCFC;\n        background: #262D43;\n        border: 1px solid #262D43;\n    }\n    .%prefix%-button:hover {\n        color: #FCFCFC;\n        border: 1px solid #FCFCFC;\n        background: #333A50;\n    }\n    .%prefix%-close {\n        background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M.57 12.1a.96.96 0 000 1.34c.37.36 1 .36 1.34 0L7 8.37l5.09 5.09c.36.35.97.35 1.34-.01a.96.96 0 000-1.34L8.34 7.01l5.08-5.08a.95.95 0 000-1.33.97.97 0 00-1.34-.01L6.99 5.68 1.91.59a.96.96 0 00-1.33 0 .97.97 0 00-.01 1.34l5.09 5.08-5.1 5.1z' fill='%23FCFCFC'/%3E%3C/svg%3E\");\n    }\n    .%prefix%-close:hover {\n        background-color: black;\n    }\n}\n\n@media (max-height: 600px) { .%prefix%-inner { transform: scale(0.9); } }\n@media (max-height: 540px) { .%prefix%-inner { transform: scale(0.8); } }\n@media (max-height: 480px) { .%prefix%-inner { transform: scale(0.7); } }\n@media (max-height: 420px) { .%prefix%-inner { transform: scale(0.6); } }\n@media (max-height: 360px) { .%prefix%-inner { transform: scale(0.5); } }\n@media (max-height: 300px) { .%prefix%-inner { transform: scale(0.4); } }\n\n`;\nvar ErrorCorrectLevel = {\n  L: 1,\n  M: 0,\n  Q: 3,\n  H: 2\n};\nvar Mode = {\n  MODE_NUMBER: 1 << 0,\n  MODE_ALPHA_NUM: 1 << 1,\n  MODE_8BIT_BYTE: 1 << 2,\n  MODE_KANJI: 1 << 3\n};\n\nclass QR8bitByte {\n  constructor(data) {\n    this.mode = Mode.MODE_8BIT_BYTE;\n    this.data = data;\n  }\n\n  getLength() {\n    return this.data.length;\n  }\n\n  write(buffer) {\n    for (let i = 0; i < this.data.length; i++) {\n      // not JIS ...\n      buffer.put(this.data.charCodeAt(i), 8);\n    }\n  }\n\n}\n\nclass QRBitBuffer {\n  constructor() {\n    this.buffer = [];\n    this.length = 0;\n  }\n\n  get(index) {\n    const bufIndex = Math.floor(index / 8);\n    return (this.buffer[bufIndex] >>> 7 - index % 8 & 1) == 1;\n  }\n\n  put(num, length) {\n    for (let i = 0; i < length; i++) {\n      this.putBit((num >>> length - i - 1 & 1) == 1);\n    }\n  }\n\n  getLengthInBits() {\n    return this.length;\n  }\n\n  putBit(bit) {\n    const bufIndex = Math.floor(this.length / 8);\n\n    if (this.buffer.length <= bufIndex) {\n      this.buffer.push(0);\n    }\n\n    if (bit) {\n      this.buffer[bufIndex] |= 0x80 >>> this.length % 8;\n    }\n\n    this.length++;\n  }\n\n}\n\nconst QRMath = {\n  glog: function (n) {\n    if (n < 1) {\n      throw new Error('glog(' + n + ')');\n    }\n\n    return QRMath.LOG_TABLE[n];\n  },\n  gexp: function (n) {\n    while (n < 0) {\n      n += 255;\n    }\n\n    while (n >= 256) {\n      n -= 255;\n    }\n\n    return QRMath.EXP_TABLE[n];\n  },\n  EXP_TABLE: new Array(256),\n  LOG_TABLE: new Array(256)\n};\n\nfor (let i = 0; i < 8; i++) {\n  QRMath.EXP_TABLE[i] = 1 << i;\n}\n\nfor (let i = 8; i < 256; i++) {\n  QRMath.EXP_TABLE[i] = QRMath.EXP_TABLE[i - 4] ^ QRMath.EXP_TABLE[i - 5] ^ QRMath.EXP_TABLE[i - 6] ^ QRMath.EXP_TABLE[i - 8];\n}\n\nfor (let i = 0; i < 255; i++) {\n  QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]] = i;\n}\n\nclass QRPolynomial {\n  constructor(num, shift) {\n    if (num.length == undefined) {\n      throw new Error(num.length + '/' + shift);\n    }\n\n    let offset = 0;\n\n    while (offset < num.length && num[offset] == 0) {\n      offset++;\n    }\n\n    this.num = new Array(num.length - offset + shift);\n\n    for (let i = 0; i < num.length - offset; i++) {\n      this.num[i] = num[i + offset];\n    }\n  }\n\n  get(index) {\n    return this.num[index];\n  }\n\n  getLength() {\n    return this.num.length;\n  }\n\n  multiply(e) {\n    const num = new Array(this.getLength() + e.getLength() - 1);\n\n    for (let i = 0; i < this.getLength(); i++) {\n      for (let j = 0; j < e.getLength(); j++) {\n        num[i + j] ^= QRMath.gexp(QRMath.glog(this.get(i)) + QRMath.glog(e.get(j)));\n      }\n    }\n\n    return new QRPolynomial(num, 0);\n  }\n\n  mod(e) {\n    if (this.getLength() - e.getLength() < 0) {\n      return this;\n    }\n\n    const ratio = QRMath.glog(this.get(0)) - QRMath.glog(e.get(0));\n    const num = new Array(this.getLength());\n\n    for (let i = 0; i < this.getLength(); i++) {\n      num[i] = this.get(i);\n    }\n\n    for (let i = 0; i < e.getLength(); i++) {\n      num[i] ^= QRMath.gexp(QRMath.glog(e.get(i)) + ratio);\n    } // recursive call\n\n\n    return new QRPolynomial(num, 0).mod(e);\n  }\n\n} // ErrorCorrectLevel\n\n\nclass QRRSBlock {\n  constructor(totalCount, dataCount) {\n    this.totalCount = totalCount;\n    this.dataCount = dataCount;\n  }\n\n  static getRSBlocks(typeNumber, errorCorrectLevel) {\n    const rsBlock = QRRSBlock.getRsBlockTable(typeNumber, errorCorrectLevel);\n\n    if (rsBlock == undefined) {\n      throw new Error('bad rs block @ typeNumber:' + typeNumber + '/errorCorrectLevel:' + errorCorrectLevel);\n    }\n\n    const length = rsBlock.length / 3;\n    const list = [];\n\n    for (let i = 0; i < length; i++) {\n      const count = rsBlock[i * 3 + 0];\n      const totalCount = rsBlock[i * 3 + 1];\n      const dataCount = rsBlock[i * 3 + 2];\n\n      for (let j = 0; j < count; j++) {\n        list.push(new QRRSBlock(totalCount, dataCount));\n      }\n    }\n\n    return list;\n  }\n\n  static getRsBlockTable(typeNumber, errorCorrectLevel) {\n    switch (errorCorrectLevel) {\n      case ErrorCorrectLevel.L:\n        return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 0];\n\n      case ErrorCorrectLevel.M:\n        return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 1];\n\n      case ErrorCorrectLevel.Q:\n        return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 2];\n\n      case ErrorCorrectLevel.H:\n        return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 3];\n\n      default:\n        return undefined;\n    }\n  }\n\n}\n\nQRRSBlock.RS_BLOCK_TABLE = [// L\n// M\n// Q\n// H\n// 1\n[1, 26, 19], [1, 26, 16], [1, 26, 13], [1, 26, 9], // 2\n[1, 44, 34], [1, 44, 28], [1, 44, 22], [1, 44, 16], // 3\n[1, 70, 55], [1, 70, 44], [2, 35, 17], [2, 35, 13], // 4\n[1, 100, 80], [2, 50, 32], [2, 50, 24], [4, 25, 9], // 5\n[1, 134, 108], [2, 67, 43], [2, 33, 15, 2, 34, 16], [2, 33, 11, 2, 34, 12], // 6\n[2, 86, 68], [4, 43, 27], [4, 43, 19], [4, 43, 15], // 7\n[2, 98, 78], [4, 49, 31], [2, 32, 14, 4, 33, 15], [4, 39, 13, 1, 40, 14], // 8\n[2, 121, 97], [2, 60, 38, 2, 61, 39], [4, 40, 18, 2, 41, 19], [4, 40, 14, 2, 41, 15], // 9\n[2, 146, 116], [3, 58, 36, 2, 59, 37], [4, 36, 16, 4, 37, 17], [4, 36, 12, 4, 37, 13], // 10\n[2, 86, 68, 2, 87, 69], [4, 69, 43, 1, 70, 44], [6, 43, 19, 2, 44, 20], [6, 43, 15, 2, 44, 16], // 11\n[4, 101, 81], [1, 80, 50, 4, 81, 51], [4, 50, 22, 4, 51, 23], [3, 36, 12, 8, 37, 13], // 12\n[2, 116, 92, 2, 117, 93], [6, 58, 36, 2, 59, 37], [4, 46, 20, 6, 47, 21], [7, 42, 14, 4, 43, 15], // 13\n[4, 133, 107], [8, 59, 37, 1, 60, 38], [8, 44, 20, 4, 45, 21], [12, 33, 11, 4, 34, 12], // 14\n[3, 145, 115, 1, 146, 116], [4, 64, 40, 5, 65, 41], [11, 36, 16, 5, 37, 17], [11, 36, 12, 5, 37, 13], // 15\n[5, 109, 87, 1, 110, 88], [5, 65, 41, 5, 66, 42], [5, 54, 24, 7, 55, 25], [11, 36, 12], // 16\n[5, 122, 98, 1, 123, 99], [7, 73, 45, 3, 74, 46], [15, 43, 19, 2, 44, 20], [3, 45, 15, 13, 46, 16], // 17\n[1, 135, 107, 5, 136, 108], [10, 74, 46, 1, 75, 47], [1, 50, 22, 15, 51, 23], [2, 42, 14, 17, 43, 15], // 18\n[5, 150, 120, 1, 151, 121], [9, 69, 43, 4, 70, 44], [17, 50, 22, 1, 51, 23], [2, 42, 14, 19, 43, 15], // 19\n[3, 141, 113, 4, 142, 114], [3, 70, 44, 11, 71, 45], [17, 47, 21, 4, 48, 22], [9, 39, 13, 16, 40, 14], // 20\n[3, 135, 107, 5, 136, 108], [3, 67, 41, 13, 68, 42], [15, 54, 24, 5, 55, 25], [15, 43, 15, 10, 44, 16], // 21\n[4, 144, 116, 4, 145, 117], [17, 68, 42], [17, 50, 22, 6, 51, 23], [19, 46, 16, 6, 47, 17], // 22\n[2, 139, 111, 7, 140, 112], [17, 74, 46], [7, 54, 24, 16, 55, 25], [34, 37, 13], // 23\n[4, 151, 121, 5, 152, 122], [4, 75, 47, 14, 76, 48], [11, 54, 24, 14, 55, 25], [16, 45, 15, 14, 46, 16], // 24\n[6, 147, 117, 4, 148, 118], [6, 73, 45, 14, 74, 46], [11, 54, 24, 16, 55, 25], [30, 46, 16, 2, 47, 17], // 25\n[8, 132, 106, 4, 133, 107], [8, 75, 47, 13, 76, 48], [7, 54, 24, 22, 55, 25], [22, 45, 15, 13, 46, 16], // 26\n[10, 142, 114, 2, 143, 115], [19, 74, 46, 4, 75, 47], [28, 50, 22, 6, 51, 23], [33, 46, 16, 4, 47, 17], // 27\n[8, 152, 122, 4, 153, 123], [22, 73, 45, 3, 74, 46], [8, 53, 23, 26, 54, 24], [12, 45, 15, 28, 46, 16], // 28\n[3, 147, 117, 10, 148, 118], [3, 73, 45, 23, 74, 46], [4, 54, 24, 31, 55, 25], [11, 45, 15, 31, 46, 16], // 29\n[7, 146, 116, 7, 147, 117], [21, 73, 45, 7, 74, 46], [1, 53, 23, 37, 54, 24], [19, 45, 15, 26, 46, 16], // 30\n[5, 145, 115, 10, 146, 116], [19, 75, 47, 10, 76, 48], [15, 54, 24, 25, 55, 25], [23, 45, 15, 25, 46, 16], // 31\n[13, 145, 115, 3, 146, 116], [2, 74, 46, 29, 75, 47], [42, 54, 24, 1, 55, 25], [23, 45, 15, 28, 46, 16], // 32\n[17, 145, 115], [10, 74, 46, 23, 75, 47], [10, 54, 24, 35, 55, 25], [19, 45, 15, 35, 46, 16], // 33\n[17, 145, 115, 1, 146, 116], [14, 74, 46, 21, 75, 47], [29, 54, 24, 19, 55, 25], [11, 45, 15, 46, 46, 16], // 34\n[13, 145, 115, 6, 146, 116], [14, 74, 46, 23, 75, 47], [44, 54, 24, 7, 55, 25], [59, 46, 16, 1, 47, 17], // 35\n[12, 151, 121, 7, 152, 122], [12, 75, 47, 26, 76, 48], [39, 54, 24, 14, 55, 25], [22, 45, 15, 41, 46, 16], // 36\n[6, 151, 121, 14, 152, 122], [6, 75, 47, 34, 76, 48], [46, 54, 24, 10, 55, 25], [2, 45, 15, 64, 46, 16], // 37\n[17, 152, 122, 4, 153, 123], [29, 74, 46, 14, 75, 47], [49, 54, 24, 10, 55, 25], [24, 45, 15, 46, 46, 16], // 38\n[4, 152, 122, 18, 153, 123], [13, 74, 46, 32, 75, 47], [48, 54, 24, 14, 55, 25], [42, 45, 15, 32, 46, 16], // 39\n[20, 147, 117, 4, 148, 118], [40, 75, 47, 7, 76, 48], [43, 54, 24, 22, 55, 25], [10, 45, 15, 67, 46, 16], // 40\n[19, 148, 118, 6, 149, 119], [18, 75, 47, 31, 76, 48], [34, 54, 24, 34, 55, 25], [20, 45, 15, 61, 46, 16]];\nconst QRMaskPattern = {\n  PATTERN000: 0,\n  PATTERN001: 1,\n  PATTERN010: 2,\n  PATTERN011: 3,\n  PATTERN100: 4,\n  PATTERN101: 5,\n  PATTERN110: 6,\n  PATTERN111: 7\n};\nconst QRUtil = {\n  PATTERN_POSITION_TABLE: [[], [6, 18], [6, 22], [6, 26], [6, 30], [6, 34], [6, 22, 38], [6, 24, 42], [6, 26, 46], [6, 28, 50], [6, 30, 54], [6, 32, 58], [6, 34, 62], [6, 26, 46, 66], [6, 26, 48, 70], [6, 26, 50, 74], [6, 30, 54, 78], [6, 30, 56, 82], [6, 30, 58, 86], [6, 34, 62, 90], [6, 28, 50, 72, 94], [6, 26, 50, 74, 98], [6, 30, 54, 78, 102], [6, 28, 54, 80, 106], [6, 32, 58, 84, 110], [6, 30, 58, 86, 114], [6, 34, 62, 90, 118], [6, 26, 50, 74, 98, 122], [6, 30, 54, 78, 102, 126], [6, 26, 52, 78, 104, 130], [6, 30, 56, 82, 108, 134], [6, 34, 60, 86, 112, 138], [6, 30, 58, 86, 114, 142], [6, 34, 62, 90, 118, 146], [6, 30, 54, 78, 102, 126, 150], [6, 24, 50, 76, 102, 128, 154], [6, 28, 54, 80, 106, 132, 158], [6, 32, 58, 84, 110, 136, 162], [6, 26, 54, 82, 110, 138, 166], [6, 30, 58, 86, 114, 142, 170]],\n  G15: 1 << 10 | 1 << 8 | 1 << 5 | 1 << 4 | 1 << 2 | 1 << 1 | 1 << 0,\n  G18: 1 << 12 | 1 << 11 | 1 << 10 | 1 << 9 | 1 << 8 | 1 << 5 | 1 << 2 | 1 << 0,\n  G15_MASK: 1 << 14 | 1 << 12 | 1 << 10 | 1 << 4 | 1 << 1,\n  getBCHTypeInfo: function (data) {\n    let d = data << 10;\n\n    while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15) >= 0) {\n      d ^= QRUtil.G15 << QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15);\n    }\n\n    return (data << 10 | d) ^ QRUtil.G15_MASK;\n  },\n  getBCHTypeNumber: function (data) {\n    let d = data << 12;\n\n    while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18) >= 0) {\n      d ^= QRUtil.G18 << QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18);\n    }\n\n    return data << 12 | d;\n  },\n  getBCHDigit: function (data) {\n    let digit = 0;\n\n    while (data != 0) {\n      digit++;\n      data >>>= 1;\n    }\n\n    return digit;\n  },\n  getPatternPosition: function (typeNumber) {\n    return QRUtil.PATTERN_POSITION_TABLE[typeNumber - 1];\n  },\n  getMask: function (maskPattern, i, j) {\n    switch (maskPattern) {\n      case QRMaskPattern.PATTERN000:\n        return (i + j) % 2 == 0;\n\n      case QRMaskPattern.PATTERN001:\n        return i % 2 == 0;\n\n      case QRMaskPattern.PATTERN010:\n        return j % 3 == 0;\n\n      case QRMaskPattern.PATTERN011:\n        return (i + j) % 3 == 0;\n\n      case QRMaskPattern.PATTERN100:\n        return (Math.floor(i / 2) + Math.floor(j / 3)) % 2 == 0;\n\n      case QRMaskPattern.PATTERN101:\n        return i * j % 2 + i * j % 3 == 0;\n\n      case QRMaskPattern.PATTERN110:\n        return (i * j % 2 + i * j % 3) % 2 == 0;\n\n      case QRMaskPattern.PATTERN111:\n        return (i * j % 3 + (i + j) % 2) % 2 == 0;\n\n      default:\n        throw new Error('bad maskPattern:' + maskPattern);\n    }\n  },\n  getErrorCorrectPolynomial: function (errorCorrectLength) {\n    let a = new QRPolynomial([1], 0);\n\n    for (let i = 0; i < errorCorrectLength; i++) {\n      a = a.multiply(new QRPolynomial([1, QRMath.gexp(i)], 0));\n    }\n\n    return a;\n  },\n  getLengthInBits: function (mode, type) {\n    if (1 <= type && type < 10) {\n      // 1 - 9\n      switch (mode) {\n        case Mode.MODE_NUMBER:\n          return 10;\n\n        case Mode.MODE_ALPHA_NUM:\n          return 9;\n\n        case Mode.MODE_8BIT_BYTE:\n          return 8;\n\n        case Mode.MODE_KANJI:\n          return 8;\n\n        default:\n          throw new Error('mode:' + mode);\n      }\n    } else if (type < 27) {\n      // 10 - 26\n      switch (mode) {\n        case Mode.MODE_NUMBER:\n          return 12;\n\n        case Mode.MODE_ALPHA_NUM:\n          return 11;\n\n        case Mode.MODE_8BIT_BYTE:\n          return 16;\n\n        case Mode.MODE_KANJI:\n          return 10;\n\n        default:\n          throw new Error('mode:' + mode);\n      }\n    } else if (type < 41) {\n      // 27 - 40\n      switch (mode) {\n        case Mode.MODE_NUMBER:\n          return 14;\n\n        case Mode.MODE_ALPHA_NUM:\n          return 13;\n\n        case Mode.MODE_8BIT_BYTE:\n          return 16;\n\n        case Mode.MODE_KANJI:\n          return 12;\n\n        default:\n          throw new Error('mode:' + mode);\n      }\n    } else {\n      throw new Error('type:' + type);\n    }\n  },\n  getLostPoint: function (qrCode) {\n    const moduleCount = qrCode.getModuleCount();\n    let lostPoint = 0; // LEVEL1\n\n    for (let row = 0; row < moduleCount; row++) {\n      for (let col = 0; col < moduleCount; col++) {\n        let sameCount = 0;\n        const dark = qrCode.isDark(row, col);\n\n        for (let r = -1; r <= 1; r++) {\n          if (row + r < 0 || moduleCount <= row + r) {\n            continue;\n          }\n\n          for (let c = -1; c <= 1; c++) {\n            if (col + c < 0 || moduleCount <= col + c) {\n              continue;\n            }\n\n            if (r == 0 && c == 0) {\n              continue;\n            }\n\n            if (dark == qrCode.isDark(row + r, col + c)) {\n              sameCount++;\n            }\n          }\n        }\n\n        if (sameCount > 5) {\n          lostPoint += 3 + sameCount - 5;\n        }\n      }\n    } // LEVEL2\n\n\n    for (let row = 0; row < moduleCount - 1; row++) {\n      for (let col = 0; col < moduleCount - 1; col++) {\n        let count = 0;\n        if (qrCode.isDark(row, col)) count++;\n        if (qrCode.isDark(row + 1, col)) count++;\n        if (qrCode.isDark(row, col + 1)) count++;\n        if (qrCode.isDark(row + 1, col + 1)) count++;\n\n        if (count == 0 || count == 4) {\n          lostPoint += 3;\n        }\n      }\n    } // LEVEL3\n\n\n    for (let row = 0; row < moduleCount; row++) {\n      for (let col = 0; col < moduleCount - 6; col++) {\n        if (qrCode.isDark(row, col) && !qrCode.isDark(row, col + 1) && qrCode.isDark(row, col + 2) && qrCode.isDark(row, col + 3) && qrCode.isDark(row, col + 4) && !qrCode.isDark(row, col + 5) && qrCode.isDark(row, col + 6)) {\n          lostPoint += 40;\n        }\n      }\n    }\n\n    for (let col = 0; col < moduleCount; col++) {\n      for (let row = 0; row < moduleCount - 6; row++) {\n        if (qrCode.isDark(row, col) && !qrCode.isDark(row + 1, col) && qrCode.isDark(row + 2, col) && qrCode.isDark(row + 3, col) && qrCode.isDark(row + 4, col) && !qrCode.isDark(row + 5, col) && qrCode.isDark(row + 6, col)) {\n          lostPoint += 40;\n        }\n      }\n    } // LEVEL4\n\n\n    let darkCount = 0;\n\n    for (let col = 0; col < moduleCount; col++) {\n      for (let row = 0; row < moduleCount; row++) {\n        if (qrCode.isDark(row, col)) {\n          darkCount++;\n        }\n      }\n    }\n\n    const ratio = Math.abs(100 * darkCount / moduleCount / moduleCount - 50) / 5;\n    lostPoint += ratio * 10;\n    return lostPoint;\n  }\n};\n\nclass QRCode {\n  constructor(typeNumber, errorCorrectLevel) {\n    this.typeNumber = typeNumber;\n    this.errorCorrectLevel = errorCorrectLevel;\n    this.modules = null;\n    this.moduleCount = 0;\n    this.dataCache = null;\n    this.dataList = [];\n  }\n\n  addData(data) {\n    const newData = new QR8bitByte(data);\n    this.dataList.push(newData);\n    this.dataCache = null;\n  }\n\n  isDark(row, col) {\n    if (row < 0 || this.moduleCount <= row || col < 0 || this.moduleCount <= col) {\n      throw new Error(row + ',' + col);\n    }\n\n    return this.modules[row][col];\n  }\n\n  getModuleCount() {\n    return this.moduleCount;\n  }\n\n  make() {\n    // Calculate automatically typeNumber if provided is < 1\n    if (this.typeNumber < 1) {\n      let typeNumber = 1;\n\n      for (typeNumber = 1; typeNumber < 40; typeNumber++) {\n        const rsBlocks = QRRSBlock.getRSBlocks(typeNumber, this.errorCorrectLevel);\n        const buffer = new QRBitBuffer();\n        let totalDataCount = 0;\n\n        for (let i = 0; i < rsBlocks.length; i++) {\n          totalDataCount += rsBlocks[i].dataCount;\n        }\n\n        for (let i = 0; i < this.dataList.length; i++) {\n          const data = this.dataList[i];\n          buffer.put(data.mode, 4);\n          buffer.put(data.getLength(), QRUtil.getLengthInBits(data.mode, typeNumber));\n          data.write(buffer);\n        }\n\n        if (buffer.getLengthInBits() <= totalDataCount * 8) break;\n      }\n\n      this.typeNumber = typeNumber;\n    }\n\n    this.makeImpl(false, this.getBestMaskPattern());\n  }\n\n  makeImpl(test, maskPattern) {\n    this.moduleCount = this.typeNumber * 4 + 17;\n    this.modules = new Array(this.moduleCount);\n\n    for (let row = 0; row < this.moduleCount; row++) {\n      this.modules[row] = new Array(this.moduleCount);\n\n      for (let col = 0; col < this.moduleCount; col++) {\n        this.modules[row][col] = null; //(col + row) % 3;\n      }\n    }\n\n    this.setupPositionProbePattern(0, 0);\n    this.setupPositionProbePattern(this.moduleCount - 7, 0);\n    this.setupPositionProbePattern(0, this.moduleCount - 7);\n    this.setupPositionAdjustPattern();\n    this.setupTimingPattern();\n    this.setupTypeInfo(test, maskPattern);\n\n    if (this.typeNumber >= 7) {\n      this.setupTypeNumber(test);\n    }\n\n    if (this.dataCache == null) {\n      this.dataCache = QRCode.createData(this.typeNumber, this.errorCorrectLevel, this.dataList);\n    }\n\n    this.mapData(this.dataCache, maskPattern);\n  }\n\n  setupPositionProbePattern(row, col) {\n    for (let r = -1; r <= 7; r++) {\n      if (row + r <= -1 || this.moduleCount <= row + r) continue;\n\n      for (let c = -1; c <= 7; c++) {\n        if (col + c <= -1 || this.moduleCount <= col + c) continue;\n\n        if (0 <= r && r <= 6 && (c == 0 || c == 6) || 0 <= c && c <= 6 && (r == 0 || r == 6) || 2 <= r && r <= 4 && 2 <= c && c <= 4) {\n          this.modules[row + r][col + c] = true;\n        } else {\n          this.modules[row + r][col + c] = false;\n        }\n      }\n    }\n  }\n\n  getBestMaskPattern() {\n    let minLostPoint = 0;\n    let pattern = 0;\n\n    for (let i = 0; i < 8; i++) {\n      this.makeImpl(true, i);\n      const lostPoint = QRUtil.getLostPoint(this);\n\n      if (i == 0 || minLostPoint > lostPoint) {\n        minLostPoint = lostPoint;\n        pattern = i;\n      }\n    }\n\n    return pattern;\n  }\n\n  setupTimingPattern() {\n    for (let r = 8; r < this.moduleCount - 8; r++) {\n      if (this.modules[r][6] != null) {\n        continue;\n      }\n\n      this.modules[r][6] = r % 2 == 0;\n    }\n\n    for (let c = 8; c < this.moduleCount - 8; c++) {\n      if (this.modules[6][c] != null) {\n        continue;\n      }\n\n      this.modules[6][c] = c % 2 == 0;\n    }\n  }\n\n  setupPositionAdjustPattern() {\n    const pos = QRUtil.getPatternPosition(this.typeNumber);\n\n    for (let i = 0; i < pos.length; i++) {\n      for (let j = 0; j < pos.length; j++) {\n        const row = pos[i];\n        const col = pos[j];\n\n        if (this.modules[row][col] != null) {\n          continue;\n        }\n\n        for (let r = -2; r <= 2; r++) {\n          for (let c = -2; c <= 2; c++) {\n            if (r == -2 || r == 2 || c == -2 || c == 2 || r == 0 && c == 0) {\n              this.modules[row + r][col + c] = true;\n            } else {\n              this.modules[row + r][col + c] = false;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  setupTypeNumber(test) {\n    const bits = QRUtil.getBCHTypeNumber(this.typeNumber);\n\n    for (let i = 0; i < 18; i++) {\n      const mod = !test && (bits >> i & 1) == 1;\n      this.modules[Math.floor(i / 3)][i % 3 + this.moduleCount - 8 - 3] = mod;\n    }\n\n    for (let i = 0; i < 18; i++) {\n      const mod = !test && (bits >> i & 1) == 1;\n      this.modules[i % 3 + this.moduleCount - 8 - 3][Math.floor(i / 3)] = mod;\n    }\n  }\n\n  setupTypeInfo(test, maskPattern) {\n    const data = this.errorCorrectLevel << 3 | maskPattern;\n    const bits = QRUtil.getBCHTypeInfo(data); // vertical\n\n    for (let i = 0; i < 15; i++) {\n      const mod = !test && (bits >> i & 1) == 1;\n\n      if (i < 6) {\n        this.modules[i][8] = mod;\n      } else if (i < 8) {\n        this.modules[i + 1][8] = mod;\n      } else {\n        this.modules[this.moduleCount - 15 + i][8] = mod;\n      }\n    } // horizontal\n\n\n    for (let i = 0; i < 15; i++) {\n      const mod = !test && (bits >> i & 1) == 1;\n\n      if (i < 8) {\n        this.modules[8][this.moduleCount - i - 1] = mod;\n      } else if (i < 9) {\n        this.modules[8][15 - i - 1 + 1] = mod;\n      } else {\n        this.modules[8][15 - i - 1] = mod;\n      }\n    } // fixed module\n\n\n    this.modules[this.moduleCount - 8][8] = !test;\n  }\n\n  mapData(data, maskPattern) {\n    let inc = -1;\n    let row = this.moduleCount - 1;\n    let bitIndex = 7;\n    let byteIndex = 0;\n\n    for (let col = this.moduleCount - 1; col > 0; col -= 2) {\n      if (col == 6) col--;\n\n      for (;;) {\n        for (let c = 0; c < 2; c++) {\n          if (this.modules[row][col - c] == null) {\n            let dark = false;\n\n            if (byteIndex < data.length) {\n              dark = (data[byteIndex] >>> bitIndex & 1) == 1;\n            }\n\n            const mask = QRUtil.getMask(maskPattern, row, col - c);\n\n            if (mask) {\n              dark = !dark;\n            }\n\n            this.modules[row][col - c] = dark;\n            bitIndex--;\n\n            if (bitIndex == -1) {\n              byteIndex++;\n              bitIndex = 7;\n            }\n          }\n        }\n\n        row += inc;\n\n        if (row < 0 || this.moduleCount <= row) {\n          row -= inc;\n          inc = -inc;\n          break;\n        }\n      }\n    }\n  }\n\n  static createData(typeNumber, errorCorrectLevel, dataList) {\n    const rsBlocks = QRRSBlock.getRSBlocks(typeNumber, errorCorrectLevel);\n    const buffer = new QRBitBuffer();\n\n    for (let i = 0; i < dataList.length; i++) {\n      const data = dataList[i];\n      buffer.put(data.mode, 4);\n      buffer.put(data.getLength(), QRUtil.getLengthInBits(data.mode, typeNumber));\n      data.write(buffer);\n    } // calc num max data.\n\n\n    let totalDataCount = 0;\n\n    for (let i = 0; i < rsBlocks.length; i++) {\n      totalDataCount += rsBlocks[i].dataCount;\n    }\n\n    if (buffer.getLengthInBits() > totalDataCount * 8) {\n      throw new Error('code length overflow. (' + buffer.getLengthInBits() + '>' + totalDataCount * 8 + ')');\n    } // end code\n\n\n    if (buffer.getLengthInBits() + 4 <= totalDataCount * 8) {\n      buffer.put(0, 4);\n    } // padding\n\n\n    while (buffer.getLengthInBits() % 8 != 0) {\n      buffer.putBit(false);\n    } // padding\n\n\n    for (;;) {\n      if (buffer.getLengthInBits() >= totalDataCount * 8) {\n        break;\n      }\n\n      buffer.put(QRCode.PAD0, 8);\n\n      if (buffer.getLengthInBits() >= totalDataCount * 8) {\n        break;\n      }\n\n      buffer.put(QRCode.PAD1, 8);\n    }\n\n    return QRCode.createBytes(buffer, rsBlocks);\n  }\n\n  static createBytes(buffer, rsBlocks) {\n    let offset = 0;\n    let maxDcCount = 0;\n    let maxEcCount = 0;\n    const dcdata = new Array(rsBlocks.length);\n    const ecdata = new Array(rsBlocks.length);\n\n    for (let r = 0; r < rsBlocks.length; r++) {\n      const dcCount = rsBlocks[r].dataCount;\n      const ecCount = rsBlocks[r].totalCount - dcCount;\n      maxDcCount = Math.max(maxDcCount, dcCount);\n      maxEcCount = Math.max(maxEcCount, ecCount);\n      dcdata[r] = new Array(dcCount);\n\n      for (let i = 0; i < dcdata[r].length; i++) {\n        dcdata[r][i] = 0xff & buffer.buffer[i + offset];\n      }\n\n      offset += dcCount;\n      const rsPoly = QRUtil.getErrorCorrectPolynomial(ecCount);\n      const rawPoly = new QRPolynomial(dcdata[r], rsPoly.getLength() - 1);\n      const modPoly = rawPoly.mod(rsPoly);\n      ecdata[r] = new Array(rsPoly.getLength() - 1);\n\n      for (let i = 0; i < ecdata[r].length; i++) {\n        const modIndex = i + modPoly.getLength() - ecdata[r].length;\n        ecdata[r][i] = modIndex >= 0 ? modPoly.get(modIndex) : 0;\n      }\n    }\n\n    let totalCodeCount = 0;\n\n    for (let i = 0; i < rsBlocks.length; i++) {\n      totalCodeCount += rsBlocks[i].totalCount;\n    }\n\n    const data = new Array(totalCodeCount);\n    let index = 0;\n\n    for (let i = 0; i < maxDcCount; i++) {\n      for (let r = 0; r < rsBlocks.length; r++) {\n        if (i < dcdata[r].length) {\n          data[index++] = dcdata[r][i];\n        }\n      }\n    }\n\n    for (let i = 0; i < maxEcCount; i++) {\n      for (let r = 0; r < rsBlocks.length; r++) {\n        if (i < ecdata[r].length) {\n          data[index++] = ecdata[r][i];\n        }\n      }\n    }\n\n    return data;\n  }\n\n}\n\nQRCode.PAD0 = 0xec;\nQRCode.PAD1 = 0x11;\n/**\n * Generate QR SVG\n * @author Johan Nordberg <code@johan-nordberg.com>\n */\n\nfunction generate(text, level = 'L', version = -1) {\n  const qr = new QRCode(version, ErrorCorrectLevel[level]);\n  const rects = [];\n  qr.addData(text);\n  qr.make();\n  const rows = qr.modules;\n  const size = rows.length;\n\n  for (const [y, row] of rows.entries()) {\n    let rect;\n\n    for (const [x, on] of row.entries()) {\n      if (on) {\n        if (!rect) rect = {\n          x,\n          y,\n          width: 0,\n          height: 1\n        };\n        rect.width++;\n      } else {\n        if (rect && rect.width > 0) {\n          rects.push(rect);\n        }\n\n        rect = undefined;\n      }\n    }\n\n    if (rect && rect.width > 0) {\n      rects.push(rect);\n    }\n  }\n\n  const svg = [`<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 ${size} ${size}\">`];\n\n  for (const {\n    x,\n    y,\n    width,\n    height\n  } of rects) {\n    svg.push(`<rect x=\"${x}\" y=\"${y}\" width=\"${width}\" height=\"${height}\" />`);\n  }\n\n  svg.push('</svg>');\n  return svg.join('');\n}\n\nasync function apiCall(url, body) {\n  return (await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: body ? JSON.stringify(body) : undefined\n  })).json();\n}\n\nconst version = 'fuel/2';\n/** Return true if otherVersion is same or greater than current fuel version. */\n\nfunction compareVersion(otherVersion) {\n  return parseVersion(otherVersion) >= parseVersion(version);\n}\n\nfunction parseVersion(string) {\n  const parts = string.trim().split('/');\n\n  if (parts.length === 2 && parts[0] === 'fuel') {\n    return parseInt(parts[1]) || 0;\n  }\n\n  return -1;\n}\n\nasync function fuel(request, session, updatePrepareStatus, supportedChains, referrer) {\n  assertEligible(request, session);\n  updatePrepareStatus('Detecting if network resources are required.');\n  const chainId = request.getChainId();\n  const nodeUrl = supportedChains[String(chainId)];\n\n  if (!nodeUrl) {\n    throw new Error(`Blockchain not supported by this resource provider.`);\n  }\n\n  const result = await apiCall(nodeUrl + '/v1/resource_provider/request_transaction', {\n    ref: referrer,\n    request,\n    signer: session.auth\n  });\n\n  if (!result || !result.data) {\n    throw new Error('Invalid response from resource provider.');\n  }\n\n  if (!result.data.signatures || !result.data.signatures[0]) {\n    throw new Error('No signature returned from resource provider.');\n  }\n\n  if (result.code === 402 && !result.data.fee) {\n    throw new Error('Resource provider returned a response indicating required payment, but provided no fee amount.');\n  } // Clone the request for modification\n\n\n  const cloned = request.clone(); // Set the required fee onto the request for signature providers\n\n  if (result.code === 402) {\n    if (request.getInfoKey('no_fee')) {\n      throw new Error('Fee required but sender opted out.');\n    }\n\n    cloned.setInfoKey('txfee', result.data.fee);\n  } // If the fee costs exist, set them on the request for the signature provider to consume\n\n\n  if (result.data.costs) {\n    cloned.setInfoKey('txfeecpu', result.data.costs.cpu);\n    cloned.setInfoKey('txfeenet', result.data.costs.net);\n    cloned.setInfoKey('txfeeram', result.data.costs.ram);\n  } // Set the cosigner signature onto the request for signature providers\n\n\n  const signatures = result.data.signatures.map(s => Signature.from(s));\n  cloned.setInfoKey('cosig', signatures, {\n    type: Signature,\n    array: true\n  }); // Modify the request based on the response from the API\n\n  cloned.data.req = (await SigningRequest.create({\n    transaction: { ...result.data.request[1]\n    }\n  }, {\n    abiProvider: request.abiProvider\n  })).data.req;\n  return cloned;\n}\n\nfunction assertEligible(request, session) {\n  if (request.getRawInfoKey('no_modify')) {\n    throw new Error('Request cannot be modified.');\n  }\n\n  if (request.isIdentity()) {\n    throw new Error('Identity requests cannot be co-signed.');\n  }\n\n  const firstAction = request.getRawActions()[0];\n\n  if (!firstAction) {\n    throw new Error('No actions in request.');\n  }\n\n  const firstAuthorizer = firstAction.authorization[0];\n\n  if (!firstAction) {\n    throw new Error('First authorization missing.');\n  }\n\n  if (!firstAuthorizer.actor.equals(session.auth.actor) && !firstAuthorizer.actor.equals(PlaceholderName)) {\n    throw new Error('Not first authorizer.');\n  }\n}\n\nconst AbortPrepare = Symbol();\nconst SkipFee = Symbol();\nconst defaultSupportedChains = {\n  aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906: 'https://eos.greymass.com',\n  '2a02a0053e5a8cf73a56ba0fda11e4d92e0238a4a2aa74fccf46d5a910746840': 'https://jungle3.greymass.com',\n  '4667b205c6838ef70ff7988f6e8257e8be0e1284a2f59699054a018f743b1d11': 'https://telos.greymass.com',\n  '1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4': 'https://wax.greymass.com'\n};\n\nclass Storage {\n  constructor(keyPrefix) {\n    this.keyPrefix = keyPrefix;\n  }\n\n  async write(key, data) {\n    localStorage.setItem(this.storageKey(key), data);\n  }\n\n  async read(key) {\n    return localStorage.getItem(this.storageKey(key));\n  }\n\n  async remove(key) {\n    localStorage.removeItem(this.storageKey(key));\n  }\n\n  storageKey(key) {\n    return `${this.keyPrefix}-${key}`;\n  }\n\n}\n\nclass BrowserTransport {\n  constructor(options = {}) {\n    this.options = options;\n    this.classPrefix = options.classPrefix || 'anchor-link';\n    this.injectStyles = !(options.injectStyles === false);\n    this.importantStyles = !(options.importantStyles === false);\n    this.requestStatus = !(options.requestStatus === false);\n    this.fuelEnabled = options.disableGreymassFuel !== true;\n    this.fuelReferrer = options.fuelReferrer || 'teamgreymass';\n    this.storage = new Storage(options.storagePrefix || 'anchor-link');\n    this.supportedChains = options.supportedChains || defaultSupportedChains;\n  }\n\n  closeModal() {\n    this.hide();\n\n    if (this.activeCancel) {\n      this.activeRequest = undefined;\n      this.activeCancel('Modal closed');\n      this.activeCancel = undefined;\n    }\n  }\n\n  setupElements() {\n    if (this.injectStyles && !this.styleEl) {\n      this.styleEl = document.createElement('style');\n      this.styleEl.type = 'text/css';\n      let css = styleText.replace(/%prefix%/g, this.classPrefix);\n\n      if (this.importantStyles) {\n        css = css.split('\\n').map(line => line.replace(/;$/i, ' !important;')).join('\\n');\n      }\n\n      this.styleEl.appendChild(document.createTextNode(css));\n      document.head.appendChild(this.styleEl);\n    }\n\n    if (!this.containerEl) {\n      this.containerEl = this.createEl();\n      this.containerEl.className = this.classPrefix;\n\n      this.containerEl.onclick = event => {\n        if (event.target === this.containerEl) {\n          event.stopPropagation();\n          this.closeModal();\n        }\n      };\n\n      document.body.appendChild(this.containerEl);\n    }\n\n    if (!this.requestEl) {\n      const wrapper = this.createEl({\n        class: 'inner'\n      });\n      const closeButton = this.createEl({\n        class: 'close'\n      });\n\n      closeButton.onclick = event => {\n        event.stopPropagation();\n        this.closeModal();\n      };\n\n      this.requestEl = this.createEl({\n        class: 'request'\n      });\n      wrapper.appendChild(this.requestEl);\n      wrapper.appendChild(closeButton);\n      const version = this.createEl({\n        class: 'version',\n        text: `${BrowserTransport.version} (${Link.version})`\n      });\n\n      version.onclick = event => {\n        event.stopPropagation();\n        window.open('https://github.com/greymass/anchor-link', '_blank');\n      };\n\n      wrapper.appendChild(version);\n      this.containerEl.appendChild(wrapper);\n    }\n  }\n\n  createEl(attrs) {\n    if (!attrs) attrs = {};\n    const el = document.createElement(attrs.tag || 'div');\n\n    if (attrs) {\n      for (const attr of Object.keys(attrs)) {\n        const value = attrs[attr];\n\n        switch (attr) {\n          case 'src':\n            el.setAttribute(attr, value);\n            break;\n\n          case 'tag':\n            break;\n\n          case 'text':\n            el.appendChild(document.createTextNode(value));\n            break;\n\n          case 'class':\n            el.className = `${this.classPrefix}-${value}`;\n            break;\n\n          default:\n            el.setAttribute(attr, value);\n        }\n      }\n    }\n\n    return el;\n  }\n\n  hide() {\n    if (this.containerEl) {\n      this.containerEl.classList.remove(`${this.classPrefix}-active`);\n    }\n\n    this.clearTimers();\n  }\n\n  show() {\n    if (this.containerEl) {\n      this.containerEl.classList.add(`${this.classPrefix}-active`);\n    }\n  }\n\n  async displayRequest(request) {\n    this.setupElements();\n    const sameDeviceRequest = request.clone();\n    const returnUrl = generateReturnUrl();\n    sameDeviceRequest.setInfoKey('same_device', true);\n    sameDeviceRequest.setInfoKey('return_path', returnUrl);\n    const sameDeviceUri = sameDeviceRequest.encode(true, false);\n    const crossDeviceUri = request.encode(true, false);\n    const isIdentity = request.isIdentity();\n    const title = isIdentity ? 'Login' : 'Sign';\n    const subtitle = 'Scan the QR-code with Anchor on another device or use the button to open Anchor on this device.';\n    const qrEl = this.createEl({\n      class: 'qr'\n    });\n\n    try {\n      qrEl.innerHTML = generate(crossDeviceUri);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.warn('Unable to generate QR code', error);\n    }\n\n    const linkEl = this.createEl({\n      class: 'uri'\n    });\n    const linkA = this.createEl({\n      tag: 'a',\n      class: 'button',\n      href: crossDeviceUri,\n      text: 'Launch Anchor'\n    });\n    linkEl.appendChild(linkA);\n\n    if (isFirefox()) {\n      // this prevents firefox from killing the websocket connection once the link is clicked\n      const iframe = this.createEl({\n        class: 'wskeepalive',\n        src: 'about:blank',\n        tag: 'iframe'\n      });\n      linkEl.appendChild(iframe);\n      linkA.addEventListener('click', event => {\n        event.preventDefault();\n        iframe.setAttribute('src', sameDeviceUri);\n      });\n    } else {\n      linkA.addEventListener('click', event => {\n        event.preventDefault();\n        window.location.href = sameDeviceUri;\n      });\n    }\n\n    const infoEl = this.createEl({\n      class: 'info'\n    });\n    const infoTitle = this.createEl({\n      class: 'title',\n      tag: 'span',\n      text: title\n    });\n    const infoSubtitle = this.createEl({\n      class: 'subtitle',\n      tag: 'span',\n      text: subtitle\n    });\n    infoEl.appendChild(infoTitle);\n    infoEl.appendChild(infoSubtitle);\n    const actionEl = this.createEl({\n      class: 'actions'\n    });\n    actionEl.appendChild(qrEl);\n    actionEl.appendChild(linkEl);\n    let footnoteEl;\n\n    if (isIdentity) {\n      footnoteEl = this.createEl({\n        class: 'footnote',\n        text: \"Don't have Anchor yet? \"\n      });\n      const footnoteLink = this.createEl({\n        tag: 'a',\n        target: '_blank',\n        href: 'https://greymass.com/anchor',\n        text: 'Download now'\n      });\n      footnoteEl.appendChild(footnoteLink);\n    } else {\n      footnoteEl = this.createEl({\n        class: 'footnote',\n        text: 'Anchor signing is brought to you by '\n      });\n      const footnoteLink = this.createEl({\n        tag: 'a',\n        target: '_blank',\n        href: 'https://greymass.com',\n        text: 'Greymass'\n      });\n      footnoteEl.appendChild(footnoteLink);\n    }\n\n    emptyElement(this.requestEl);\n    const logoEl = this.createEl({\n      class: 'logo'\n    });\n    this.requestEl.appendChild(logoEl);\n    this.requestEl.appendChild(infoEl);\n    this.requestEl.appendChild(actionEl);\n    this.requestEl.appendChild(footnoteEl);\n    this.show();\n  }\n\n  async showLoading() {\n    this.setupElements();\n    emptyElement(this.requestEl);\n    const infoEl = this.createEl({\n      class: 'info'\n    });\n    const infoTitle = this.createEl({\n      class: 'title',\n      tag: 'span',\n      text: 'Loading'\n    });\n    const infoSubtitle = this.createEl({\n      class: 'subtitle',\n      tag: 'span',\n      text: 'Preparing request...'\n    });\n    this.prepareStatusEl = infoSubtitle;\n    infoEl.appendChild(infoTitle);\n    infoEl.appendChild(infoSubtitle);\n    const logoEl = this.createEl({\n      class: 'logo loading'\n    });\n    this.requestEl.appendChild(logoEl);\n    this.requestEl.appendChild(infoEl);\n    this.show();\n  }\n\n  onRequest(request, cancel) {\n    this.activeRequest = request;\n    this.activeCancel = cancel;\n    this.displayRequest(request).catch(cancel);\n  }\n\n  onSessionRequest(session, request, cancel) {\n    if (session.metadata.sameDevice) {\n      request.setInfoKey('return_path', generateReturnUrl());\n    }\n\n    if (session.type === 'fallback') {\n      this.onRequest(request, cancel);\n\n      if (session.metadata.sameDevice) {\n        // trigger directly on a fallback same-device session\n        window.location.href = request.encode();\n      }\n\n      return;\n    }\n\n    this.activeRequest = request;\n    this.activeCancel = cancel;\n    this.setupElements();\n    const timeout = session.metadata.timeout || 60 * 1000 * 5;\n    const deviceName = session.metadata.name;\n    const infoTitle = this.createEl({\n      class: 'title',\n      tag: 'span',\n      text: 'Sign'\n    });\n    const expires = this.getExpiration(request, timeout);\n\n    const updateCountdown = () => {\n      infoTitle.textContent = `Sign - ${countdownFormat(expires)}`;\n    };\n\n    this.countdownTimer = setInterval(updateCountdown, 200);\n    updateCountdown();\n    const infoEl = this.createEl({\n      class: 'info'\n    });\n    infoEl.appendChild(infoTitle);\n    let subtitle;\n\n    if (deviceName && deviceName.length > 0) {\n      subtitle = `Please open your Anchor Wallet on your device ${deviceName} to review and sign the transaction.`;\n    } else {\n      subtitle = 'Please review and sign the transaction in the linked wallet.';\n    }\n\n    const infoSubtitle = this.createEl({\n      class: 'subtitle',\n      tag: 'span',\n      text: subtitle\n    });\n    infoEl.appendChild(infoSubtitle);\n    emptyElement(this.requestEl);\n    const logoEl = this.createEl({\n      class: 'logo'\n    });\n    this.requestEl.appendChild(logoEl);\n    this.requestEl.appendChild(infoEl);\n    this.show();\n\n    if (session.metadata.sameDevice) {\n      if (session.metadata.launchUrl) {\n        window.location.href = session.metadata.launchUrl;\n      } else if (isAppleHandheld()) {\n        window.location.href = 'anchor://link';\n      }\n    }\n  }\n\n  sendSessionPayload(payload, session) {\n    if (!session.metadata.triggerUrl || !session.metadata.sameDevice) {\n      // not same device or no trigger url supported\n      return false;\n    }\n\n    if (payload.array.length > 700) {\n      // url could be clipped by iOS\n      return false;\n    }\n\n    window.location.href = session.metadata.triggerUrl.replace('%s', Base64u.encode(payload.array));\n    return true;\n  }\n\n  clearTimers() {\n    if (this.closeTimer) {\n      clearTimeout(this.closeTimer);\n      this.closeTimer = undefined;\n    }\n\n    if (this.countdownTimer) {\n      clearTimeout(this.countdownTimer);\n      this.countdownTimer = undefined;\n    }\n  }\n\n  getExpiration(request, timeout = 0) {\n    // Get expiration of the transaction\n    const {\n      expiration\n    } = request.getRawTransaction();\n\n    if (expiration.equals(0)) {\n      // If no expiration is present, use the timeout on the session\n      return new Date(Date.now() + timeout);\n    } else {\n      return expiration.toDate();\n    }\n  }\n\n  async showFee(request, fee) {\n    this.activeRequest = request;\n    const cancelPromise = new Promise((resolve, reject) => {\n      this.activeCancel = reason => {\n        let error;\n\n        if (typeof reason === 'string') {\n          error = new Error(reason);\n        } else {\n          error = reason;\n        }\n\n        error[AbortPrepare] = true;\n        reject(error);\n      };\n    });\n    this.setupElements();\n    emptyElement(this.requestEl);\n    const feeEl = this.createEl({\n      class: 'fee'\n    });\n    const feeTitle = this.createEl({\n      class: 'title',\n      tag: 'div',\n      text: 'Transaction Fee'\n    });\n    const feeSubtitle = this.createEl({\n      class: 'subtitle',\n      tag: 'span',\n      text: `Your account lacks the network resources for this transaction and it cannot be covered for free.`\n    });\n    const feePart1 = this.createEl({\n      tag: 'span',\n      text: 'You can try to '\n    });\n    const feeBypass = this.createEl({\n      tag: 'a',\n      text: 'proceed without the fee'\n    });\n    const feePart2 = this.createEl({\n      tag: 'span',\n      text: ' or accept the fee shown below to pay for these costs.'\n    });\n    const feeDescription = this.createEl({\n      class: 'subtitle',\n      tag: 'span'\n    });\n    feeDescription.appendChild(feePart1);\n    feeDescription.appendChild(feeBypass);\n    feeDescription.appendChild(feePart2);\n    feeEl.appendChild(feeTitle);\n    feeEl.appendChild(feeSubtitle);\n    feeEl.appendChild(feeDescription);\n    const logoEl = this.createEl({\n      class: 'fuel'\n    });\n    this.requestEl.appendChild(logoEl);\n    this.requestEl.appendChild(feeEl);\n    const choiceEl = this.createEl({\n      class: 'choice'\n    });\n    const confirmEl = this.createEl({\n      tag: 'a',\n      class: 'button',\n      text: `Accept Fee of ${fee}`\n    });\n    const expireEl = this.createEl({\n      tag: 'span',\n      text: 'Offer expires in --:--'\n    });\n    choiceEl.appendChild(expireEl);\n    choiceEl.appendChild(confirmEl);\n    feeEl.appendChild(choiceEl);\n    const expires = this.getExpiration(request);\n    const expireTimer = setInterval(() => {\n      expireEl.textContent = `Offer expires in ${countdownFormat(expires)}`;\n\n      if (expires.getTime() < Date.now()) {\n        this.activeCancel('Offer expired');\n      }\n    }, 200);\n    const footnoteEl = this.createEl({\n      class: 'footnote',\n      text: 'Resources offered by '\n    });\n    const footnoteLink = this.createEl({\n      tag: 'a',\n      target: '_blank',\n      href: 'https://greymass.com/en/fuel',\n      text: 'Greymass Fuel'\n    });\n    footnoteEl.appendChild(footnoteLink);\n    this.requestEl.appendChild(footnoteEl);\n    const skipPromise = waitForEvent(feeBypass, 'click').then(() => {\n      const error = new Error('Skipped fee');\n      error[SkipFee] = true;\n      throw error;\n    });\n    const confirmPromise = waitForEvent(confirmEl, 'click');\n    this.show();\n    await Promise.race([confirmPromise, skipPromise, cancelPromise]).finally(() => {\n      clearInterval(expireTimer);\n    });\n  }\n\n  async prepare(request, session) {\n    this.showLoading();\n\n    if (!this.fuelEnabled || !session || request.isIdentity()) {\n      // don't attempt to cosign id request or if we don't have a session attached\n      return request;\n    }\n\n    if (typeof session.metadata.cosignerVersion === 'string' && compareVersion(session.metadata.cosignerVersion)) {\n      // if signer has cosigner, only attempt to cosign here if we have a newer version\n      return request;\n    }\n\n    try {\n      const result = fuel(request, session, message => {\n        if (this.prepareStatusEl) {\n          this.prepareStatusEl.textContent = message;\n        }\n      }, this.supportedChains, this.fuelReferrer);\n      const timeout = new Promise(r => setTimeout(r, 5000)).then(() => {\n        throw new Error('API timeout after 5000ms');\n      });\n      const modified = await Promise.race([result, timeout]);\n      const fee = modified.getInfoKey('txfee');\n\n      if (fee) {\n        await this.showFee(modified, String(fee));\n      }\n\n      return modified;\n    } catch (error) {\n      if (error[AbortPrepare]) {\n        this.hide();\n        throw error;\n      } else {\n        // eslint-disable-next-line no-console\n        console.info(`Skipping resource provider: ${error.message || error}`);\n\n        if (error[SkipFee]) {\n          const modified = request.clone();\n          modified.setInfoKey('no_fee', true, 'bool');\n          return modified;\n        }\n      }\n    }\n\n    return request;\n  }\n\n  onSuccess(request) {\n    if (request === this.activeRequest) {\n      this.clearTimers();\n\n      if (this.requestStatus) {\n        this.setupElements();\n        const infoEl = this.createEl({\n          class: 'info'\n        });\n        const logoEl = this.createEl({\n          class: 'logo'\n        });\n        logoEl.classList.add('success');\n        const infoTitle = this.createEl({\n          class: 'title',\n          tag: 'span',\n          text: 'Success!'\n        });\n        const subtitle = request.isIdentity() ? 'Login completed.' : 'Transaction signed.';\n        const infoSubtitle = this.createEl({\n          class: 'subtitle',\n          tag: 'span',\n          text: subtitle\n        });\n        infoEl.appendChild(infoTitle);\n        infoEl.appendChild(infoSubtitle);\n        emptyElement(this.requestEl);\n        this.requestEl.appendChild(logoEl);\n        this.requestEl.appendChild(infoEl);\n        this.show();\n        this.closeTimer = setTimeout(() => {\n          this.hide();\n        }, 1.5 * 1000);\n      } else {\n        this.hide();\n      }\n    }\n  }\n\n  onFailure(request, error) {\n    if (request === this.activeRequest && error['code'] !== 'E_CANCEL') {\n      this.clearTimers();\n\n      if (this.requestStatus) {\n        this.setupElements();\n        const infoEl = this.createEl({\n          class: 'info'\n        });\n        const logoEl = this.createEl({\n          class: 'logo'\n        });\n        logoEl.classList.add('error');\n        const infoTitle = this.createEl({\n          class: 'title',\n          tag: 'span',\n          text: 'Transaction Error'\n        });\n        let errorMessage;\n\n        if (isInstanceOf(error, APIError)) {\n          if (error.name === 'eosio_assert_message_exception') {\n            errorMessage = error.details[0].message;\n          } else if (error.details.length > 0) {\n            errorMessage = error.details.map(d => d.message).join('\\n');\n          } else {\n            errorMessage = error.message;\n          }\n        } else {\n          errorMessage = error.message || String(error);\n        }\n\n        const infoSubtitle = this.createEl({\n          class: 'subtitle',\n          tag: 'span',\n          text: errorMessage\n        });\n        infoEl.appendChild(infoTitle);\n        infoEl.appendChild(infoSubtitle);\n        emptyElement(this.requestEl);\n        this.requestEl.appendChild(logoEl);\n        this.requestEl.appendChild(infoEl);\n        this.show();\n      } else {\n        this.hide();\n      }\n    } else {\n      this.hide();\n    }\n  }\n\n  userAgent() {\n    return `BrowserTransport/${BrowserTransport.version} ${navigator.userAgent}`;\n  }\n\n}\n/** Package version. */\n\n\nBrowserTransport.version = '3.1.2'; // replaced by build script\n\nfunction waitForEvent(element, eventName, timeout) {\n  return new Promise((resolve, reject) => {\n    const listener = event => {\n      element.removeEventListener(eventName, listener);\n      resolve(event);\n    };\n\n    element.addEventListener(eventName, listener);\n\n    if (timeout) {\n      setTimeout(() => {\n        element.removeEventListener(eventName, listener);\n        reject(new Error(`Timed out waiting for ${eventName}`));\n      }, timeout);\n    }\n  });\n}\n\nfunction countdownFormat(date) {\n  const timeLeft = date.getTime() - Date.now();\n\n  if (timeLeft > 0) {\n    return new Date(timeLeft).toISOString().substr(14, 5);\n  }\n\n  return '00:00';\n}\n\nfunction emptyElement(el) {\n  while (el.firstChild) {\n    el.removeChild(el.firstChild);\n  }\n}\n/** Generate a return url that Anchor will redirect back to w/o reload. */\n\n\nfunction generateReturnUrl() {\n  if (isChromeiOS()) {\n    // google chrome on iOS will always open new tab so we just ask it to open again as a workaround\n    return 'googlechrome://';\n  }\n\n  if (isFirefoxiOS()) {\n    // same for firefox\n    return 'firefox:://';\n  }\n\n  if (isAppleHandheld() && isBrave()) {\n    // and brave ios\n    return 'brave://';\n  }\n\n  if (isAppleHandheld()) {\n    // return url with unique fragment required for iOS safari to trigger the return url\n    const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    let rv = window.location.href.split('#')[0] + '#';\n\n    for (let i = 0; i < 8; i++) {\n      rv += alphabet.charAt(Math.floor(Math.random() * alphabet.length));\n    }\n\n    return rv;\n  }\n\n  if (isAndroid() && isFirefox()) {\n    return 'android-intent://org.mozilla.firefox';\n  }\n\n  if (isAndroid() && isEdge()) {\n    return 'android-intent://com.microsoft.emmx';\n  }\n\n  if (isAndroid() && isOpera()) {\n    return 'android-intent://com.opera.browser';\n  }\n\n  if (isAndroid() && isBrave()) {\n    return 'android-intent://com.brave.browser';\n  }\n\n  if (isAndroid() && isAndroidWebView()) {\n    return 'android-intent://webview';\n  }\n\n  if (isAndroid() && isChromeMobile()) {\n    return 'android-intent://com.android.chrome';\n  }\n\n  return window.location.href;\n}\n\nfunction isAppleHandheld() {\n  return /iP(ad|od|hone)/i.test(navigator.userAgent);\n}\n\nfunction isChromeiOS() {\n  return /CriOS/.test(navigator.userAgent);\n}\n\nfunction isChromeMobile() {\n  return /Chrome\\/[.0-9]* Mobile/i.test(navigator.userAgent);\n}\n\nfunction isFirefox() {\n  return /Firefox/i.test(navigator.userAgent);\n}\n\nfunction isFirefoxiOS() {\n  return /FxiOS/.test(navigator.userAgent);\n}\n\nfunction isOpera() {\n  return /OPR/.test(navigator.userAgent) || /Opera/.test(navigator.userAgent);\n}\n\nfunction isEdge() {\n  return /Edg/.test(navigator.userAgent);\n}\n\nfunction isBrave() {\n  return navigator['brave'] && typeof navigator['brave'].isBrave === 'function';\n}\n\nfunction isAndroid() {\n  return /Android/.test(navigator.userAgent);\n}\n\nfunction isAndroidWebView() {\n  return /wv/.test(navigator.userAgent);\n}\n\nexport default BrowserTransport;","map":{"version":3,"sources":["../src/styles.ts","../src/qrcode/ErrorCorrectLevel.ts","../src/qrcode/mode.ts","../src/qrcode/8BitByte.ts","../src/qrcode/BitBuffer.ts","../src/qrcode/math.ts","../src/qrcode/Polynomial.ts","../src/qrcode/RSBlock.ts","../src/qrcode/util.ts","../src/qrcode/QRCode.ts","../src/qrcode/index.ts","../src/fuel.ts","../src/index.ts"],"names":["mode","math","ECL","Polynomial","BitByte","RSBlock","BitBuffer","util","generateQr","fuelVersion"],"mappings":"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","sourcesContent":["/**\n * Anchor Link Browser Transport v3.1.2\n * https://github.com/greymass/anchor-link-browser-transport\n *\n * @license\n * Copyright (c) 2020 Greymass Inc. All Rights Reserved.\n * \n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n * \n *  1. Redistribution of source code must retain the above copyright notice, this\n *     list of conditions and the following disclaimer.\n * \n *  2. Redistribution in binary form must reproduce the above copyright notice,\n *     this list of conditions and the following disclaimer in the documentation\n *     and/or other materials provided with the distribution.\n * \n *  3. Neither the name of the copyright holder nor the names of its contributors\n *     may be used to endorse or promote products derived from this software without\n *     specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n * \n * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE\n * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.\n */\nimport { Signature, SigningRequest, PlaceholderName, Link, Base64u, isInstanceOf, APIError } from 'anchor-link';\n\nvar styleText = `\n/* Anchor Link */\n\n.%prefix% * {\n    box-sizing: border-box;\n    line-height: 1;\n}\n\n.%prefix% {\n    font-family: -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue',\n        Arial, sans-serif;\n    font-size: 13px;\n    background: rgba(0, 0, 0, 0.65);\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    z-index: 2147483647;\n    display: none;\n    align-items: center;\n    justify-content: center;\n}\n\n.%prefix%-active {\n    display: flex;\n}\n\n.%prefix%-inner {\n    background: #EFF1F7;\n    margin: 20px;\n    padding-top: 50px;\n    border-radius: 20px;\n    box-shadow: 0px 4px 100px rgba(0, 0, 0, .5);\n    width: 340px;\n    position: relative;\n}\n\n.%prefix%-close {\n    display: block;\n    position: absolute;\n    top: 11px;\n    right: 16px;\n    width: 28px;\n    height: 28px;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M.57 12.1a.96.96 0 000 1.34c.37.36 1 .36 1.34 0L7 8.37l5.09 5.09c.36.35.97.35 1.34-.01a.96.96 0 000-1.34L8.34 7.01l5.08-5.08a.95.95 0 000-1.33.97.97 0 00-1.34-.01L6.99 5.68 1.91.59a.96.96 0 00-1.33 0 .97.97 0 00-.01 1.34l5.09 5.08-5.1 5.1z' fill='%23007AFF'/%3E%3C/svg%3E\");\n    background-size: 14px;\n    background-repeat: no-repeat;\n    background-position: 50% 7px;\n    border-radius: 100%;\n    cursor: pointer;\n}\n\n.%prefix%-close:hover {\n    background-color: white;\n}\n\n.%prefix%-version {\n    position: absolute;\n    top: 19px;\n    left: 20px;\n    cursor: help;\n    color: #B8C0DA;\n    opacity: 0.1;\n}\n\n.%prefix%-version:hover {\n    opacity: 1;\n}\n\n.%prefix%-logo {\n    width: 70px;\n    height: 70px;\n    margin: 0 auto;\n    margin-top: -56px;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23fff' d='M18.81 9.19h33.25V59.5H18.81z'/%3E%3Cpath d='M38.45 28.88h-6.9L35 21.77l3.45 7.1z' fill='%233650A2'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M35 70a35 35 0 100-70 35 35 0 000 70zm2.36-55.4a2.62 2.62 0 00-4.72 0L21.9 36.75h5.84l1.7-3.5h11.13l1.7 3.5h5.83L37.36 14.6zM48.13 44.2h-5.26a7.76 7.76 0 01-5.24 7v-10.5a2.62 2.62 0 10-5.25 0v10.5a7.76 7.76 0 01-5.25-7h-5.25c.16 7.06 6 12.69 13.12 12.69 7.12 0 12.97-5.63 13.13-12.7z' fill='%233650A2'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-fuel {\n    width: 70px;\n    height: 70px;\n    margin: 0 auto;\n    margin-top: -56px;\n    background-image: url(\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='linear-gradient-25' x1='104.79' y1='197.49' x2='131.55' y2='108.35' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0.38' stop-color='%23f6b621'/%3E%3Cstop offset='0.59' stop-color='%23e89124'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cg id='brain-logo' style='' transform='matrix(1, 0, 0, 1, -0.005538, -0.040005)'%3E%3Cg%3E%3Cpath class='cls-4' d='M251.93,111.13,221.28,71.51A23.76,23.76,0,0,0,209,63.61l-77.7-18.09a25.86,25.86,0,0,0-5.78-.6,28.22,28.22,0,0,0-7.88,1L99.06,51.58a6.31,6.31,0,0,0-.61-5l-5.3-9a6.36,6.36,0,0,0-5.47-3.13h0a6.57,6.57,0,0,0-1.92.29L49.61,46.21a6.34,6.34,0,0,0-4.41,6.28l.46,12.2a6.2,6.2,0,0,0,.78,2.81L38.2,70a21.1,21.1,0,0,0-11.73,9.76L3,125.21a17.78,17.78,0,0,0,.54,16.32l12.68,21A16.19,16.19,0,0,0,29.69,170a13.25,13.25,0,0,0,1.67-.1L65,165.81a17.22,17.22,0,0,0,9.2,13.64l12.86,6.08a32.51,32.51,0,0,0,12.26,2.63c.35,0,.7,0,1,0l29.17-1.61a6.12,6.12,0,0,1,2.64,1l29.05,28.79a20,20,0,0,0,13.27,5.29c.52,0,1,0,1.53-.07l23.93-2.47c4.31-.44,7.67-2.87,9-6.48s.36-7.64-2.63-10.78l-10.09-10.64,19.07-5.64a15.76,15.76,0,0,0,10.83-13.09L227.65,157a10.69,10.69,0,0,1,1.86-4.19l21.74-24a14,14,0,0,0,.68-17.65Z' style='fill: rgb(255, 255, 255);'/%3E%3Cg%3E%3Ccircle class='cls-2' cx='173.24' cy='107.45' r='6.19' transform='translate(7.67 226.39) rotate(-67.5)' style='fill: rgb(246, 182, 33);'/%3E%3Cpath class='cls-2' d='M101,97.06a3.71,3.71,0,1,0-3.71-3.71A3.71,3.71,0,0,0,101,97.06Z' style='fill: rgb(246, 182, 33);'/%3E%3Ccircle class='cls-2' cx='135.4' cy='76.29' r='3.71' style='fill: rgb(246, 182, 33);'/%3E%3Cg%3E%3Cpath class='cls-21' d='M79.24,128c-16.71,0-37.79,7.36-48.93,11.68a2.39,2.39,0,0,0-1.19,3.46L33.8,151a2.38,2.38,0,0,0,2.34,1.14L69.27,148a12.74,12.74,0,0,1,1.63-.1,13.22,13.22,0,0,1,13.26,12.74l0,1.1a2.4,2.4,0,0,0,1.37,2.07l10.56,5a14.8,14.8,0,0,0,4.69.95H101L129,168.24c.28,0,.57,0,.85,0a21.23,21.23,0,0,1,14.06,5.68l27.82,27.56a4,4,0,0,0,1.26.45l6.07-.75a1.22,1.22,0,0,0,.86-1.9l-3-4.36a11.51,11.51,0,0,1,5.21-19.44l23.4-6.93a1.44,1.44,0,0,0,1-1.23l1.26-12.72v0a1.44,1.44,0,0,0-1.81-1.54c-8.26,2.21-22.73,5.72-31.63,5.72C136.65,158.74,108.72,128,79.24,128Zm32.48,27a2.77,2.77,0,0,1-1,1,3.78,3.78,0,0,1-5.23-5.23,2.77,2.77,0,0,1,1-1A3.78,3.78,0,0,1,111.72,155Zm63.76,13.39a2.62,2.62,0,0,1-1,1,3.78,3.78,0,0,1-5.23-5.23,2.77,2.77,0,0,1,1-1A3.78,3.78,0,0,1,175.48,168.36Z' style='fill: url(%23linear-gradient-25);'/%3E%3Cpath class='cls-2' d='M173.34,127.62c-37.69,0-69.59-16.73-92.46-16.73-16.08,0-43.36,12.17-55.32,21a2,2,0,0,0-.65,2.46c.35.8.82,1.84,1.26,2.82a2,2,0,0,0,2.62,1C39.07,134,61,125.9,79.24,125.9c30.45,0,58.48,27,91.13,27,14.49,0,35.75-5.69,41.3-10.16,2.42-2.52,10.36-11.93,16-17.78a2.39,2.39,0,0,0-2.32-3.94C214.49,123.51,193.73,127.62,173.34,127.62Zm-1.68,14.25a5.28,5.28,0,0,1-2.49,2.49,6.27,6.27,0,0,1-8.48-8.48,5.37,5.37,0,0,1,2.49-2.49A6.27,6.27,0,0,1,171.66,141.87Z' style='fill: rgb(246, 182, 33);'/%3E%3C/g%3E%3Cpath class='cls-1' d='M248.71,113.13,218.06,73.51a20.05,20.05,0,0,0-10-6.43L130.34,49a25.7,25.7,0,0,0-11.57.38L91.41,57.65a.05.05,0,0,1-.07,0L89.56,53a.05.05,0,0,1,0-.07l4.06-1.46a2.45,2.45,0,0,0,1-.62,2.29,2.29,0,0,0,.29-2.72l-5.29-9a2.3,2.3,0,0,0-2.67-1L50.83,49.59a2.28,2.28,0,0,0-1.59,2.27l.46,12.2a2.27,2.27,0,0,0,1,1.8,2.3,2.3,0,0,0,1.28.4,2.33,2.33,0,0,0,.78-.14l9.18-3.29a0,0,0,0,1,.06,0L63.58,66a0,0,0,0,1,0,.07L39.37,73.4a17.25,17.25,0,0,0-9.31,7.74L6.58,126.59A13.67,13.67,0,0,0,7,139l12.68,21a12.1,12.1,0,0,0,11.19,5.45l37.08-4.54a.83.83,0,0,1,.68.18.82.82,0,0,1,.28.64l.14,3.22a13.25,13.25,0,0,0,6.88,10.39l12.86,6.08a28,28,0,0,0,11.32,2.21l29.2-1.61a9.38,9.38,0,0,1,5.68,2.16L164,212.94a16,16,0,0,0,10.41,4.12,10,10,0,0,0,1.11-.06l23.93-2.46c2.77-.29,4.82-1.69,5.62-3.85s.15-4.56-1.77-6.58l-14.6-15.38a.06.06,0,0,1,0-.09l25.35-7.5a11.74,11.74,0,0,0,7.94-9.59l1.53-15.46a14.22,14.22,0,0,1,2.9-6.52l21.74-24A9.94,9.94,0,0,0,248.71,113.13ZM56.08,56.65,56,54.81a1.29,1.29,0,0,1,.88-1.29l28-9a1.28,1.28,0,0,1,1.48.57l.48.83a1.27,1.27,0,0,1-.68,1.83l-28.35,10A1.27,1.27,0,0,1,56.08,56.65Zm186.57,63.93-21.71,24a21.37,21.37,0,0,0-4.79,10.8l-1.54,15.46A4.37,4.37,0,0,1,212,174l-26.5,7.84a6.52,6.52,0,0,0-3,11.2L194,205.17a1.49,1.49,0,0,1-.93,2.5l-18.31,1.89a8.37,8.37,0,0,1-5.49-1.94l-29.06-28.8a16.74,16.74,0,0,0-10.77-4.33l-.59,0-29.21,1.61a20.07,20.07,0,0,1-7.69-1.5l-12.87-6.09a5,5,0,0,1-2.61-3.93l-.13-3.22A8.27,8.27,0,0,0,67,153.44L29.94,158a4.75,4.75,0,0,1-3.87-1.88l-12.68-21a6.38,6.38,0,0,1-.17-5.05L36.71,84.58a10.08,10.08,0,0,1,4.82-4l79.41-24a18.68,18.68,0,0,1,7.7-.25l77.7,18.09a12.72,12.72,0,0,1,5.8,3.72l30.62,39.59A2.35,2.35,0,0,1,242.65,120.58Z' style='fill: rgb(42, 54, 64);'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo.loading {\n    border-radius: 100%;\n    background-color: #3650A2;\n    background-image: url(\"data:image/svg+xml,%3Csvg viewBox='0.5 0.5 45 45' xmlns='http://www.w3.org/2000/svg' stroke='%23fff'%3E%3Cg fill='none' fill-rule='evenodd' transform='translate(1 1)' stroke-width='2'%3E%3Ccircle cx='22' cy='22' r='6' stroke-opacity='0'%3E%3Canimate attributeName='r' begin='1.5s' dur='3s' values='6;22' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-opacity' begin='1.5s' dur='3s' values='1;0' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-width' begin='1.5s' dur='3s' values='2;0' calcMode='linear' repeatCount='indefinite' /%3E%3C/circle%3E%3Ccircle cx='22' cy='22' r='6' stroke-opacity='0'%3E%3Canimate attributeName='r' begin='3s' dur='3s' values='6;22' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-opacity' begin='3s' dur='3s' values='1;0' calcMode='linear' repeatCount='indefinite' /%3E%3Canimate attributeName='stroke-width' begin='3s' dur='3s' values='2;0' calcMode='linear' repeatCount='indefinite' /%3E%3C/circle%3E%3Ccircle cx='22' cy='22' r='8'%3E%3Canimate attributeName='r' begin='0s' dur='1.5s' values='6;1;2;3;4;5;6' calcMode='linear' repeatCount='indefinite' /%3E%3C/circle%3E%3C/g%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo.error {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%23FC3D39'/%3E%3Cpath fill='%23fff' d='M22.3 48h25.4c2.5 0 4-1.7 4-4a4 4 0 00-.5-2L38.5 19.3a4 4 0 00-3.5-2 4 4 0 00-3.5 2L18.8 42.1c-.3.6-.5 1.3-.5 2 0 2.2 1.6 4 4 4zM35 37c-.9 0-1.4-.6-1.4-1.5l-.2-7.7c0-.9.6-1.6 1.6-1.6s1.7.7 1.7 1.6l-.3 7.7c0 1-.5 1.5-1.4 1.5zm0 6c-1 0-1.9-.8-1.9-1.8s.9-1.8 2-1.8c1 0 1.8.7 1.8 1.8 0 1-.9 1.8-1.9 1.8z'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo.success {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%233DC55D'/%3E%3Cpath fill='%23fff' d='M30.9 49.7a2 2 0 001.8-1L48 24.9c.3-.5.4-1 .4-1.4 0-1-.7-1.7-1.7-1.7-.8 0-1.2.3-1.6 1L30.8 45.4 23.5 36c-.5-.6-1-.9-1.6-.9-1 0-1.8.8-1.8 1.8 0 .4.2.9.6 1.3L29 48.7c.6.7 1.1 1 1.9 1z'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-request {\n    padding: 20px;\n    border-radius: 20px;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n    background: white;\n}\n\n.%prefix%-fee,\n.%prefix%-info {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.%prefix%-title {\n    color: #000000;\n    font-size: 25px;\n    margin-top: 14px;\n    font-weight: 700;\n    line-height: 30px;\n    letter-spacing: 0.5px;\n}\n\n.%prefix%-subtitle {\n    margin-top: 14px;\n    color: #5C5C5C;\n    text-align: center;\n    line-height: 1.4;\n    word-break: break-word;\n}\n\n.%prefix%-subtitle a {\n    color: #000000;\n    cursor: pointer;\n    text-decoration: underline;\n}\n\n.%prefix%-actions {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.%prefix%-uri {\n    width: 100%;\n}\n\n.%prefix%-button {\n    color: #007AFF;\n    background: #EFF1F7;\n    border: 1px solid #EFF1F7;\n    text-decoration: none;\n    font-size: 17px;\n    flex-grow: 1;\n    flex: 1;\n    width: 100%;\n    line-height: 1;\n    padding: 20px 18px;\n    border-radius: 12px;\n    font-weight: 400;\n    text-align: center;\n    display: block;\n    margin-top: 21px;\n    cursor: pointer;\n}\n\n.%prefix%-button:hover {\n    border: 1px solid #007AFF;\n}\n\n.%prefix%-qr {\n    margin-top: 21px;\n}\n\n.%prefix%-qr svg {\n    width: 100%;\n    display: block;\n    shape-rendering: crispEdges;\n}\n\n.%prefix%-qr svg rect {\n    fill: black;\n}\n\n.%prefix%-footnote {\n    text-align: center;\n    width: 100%;\n    position: absolute;\n    bottom: -26px;\n    left: 0;\n    color: white;\n}\n\n.%prefix%-footnote a {\n    color: white;\n    text-decoration: underline;\n}\n\n.%prefix%-wskeepalive {\n    display: none;\n}\n\n.%prefix%-choice {\n    text-align: center;\n    width: 100%;\n    color: #666;\n}\n\n.%prefix%-choice span {\n    display: block;\n    margin-top: 1em;\n}\n\n.%prefix%-choice a:not(.%prefix%-button) {\n    display: block;\n    cursor: pointer;\n    text-decoration: underline;\n    margin-top: 1em;\n}\n\n@media (prefers-color-scheme: dark) {\n    .%prefix%-inner {\n        background: #262D43;\n        color: white;\n    }\n    .%prefix%-request {\n        background: #131B33;\n    }\n    .%prefix%-title {\n        color: #FCFCFC;\n    }\n    .%prefix%-subtitle {\n        color: #B8C0DA;\n    }\n    .%prefix%-subtitle a {\n        color: #FCFCFC;\n    }\n    .%prefix%-qr svg rect {\n        fill: white;\n    }\n    .%prefix%-version {\n        color: #546AAF;\n    }\n    .%prefix%-choice {\n        color: #888ea1;\n    }\n    .%prefix%-button {\n        color: #FCFCFC;\n        background: #262D43;\n        border: 1px solid #262D43;\n    }\n    .%prefix%-button:hover {\n        color: #FCFCFC;\n        border: 1px solid #FCFCFC;\n        background: #333A50;\n    }\n    .%prefix%-close {\n        background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M.57 12.1a.96.96 0 000 1.34c.37.36 1 .36 1.34 0L7 8.37l5.09 5.09c.36.35.97.35 1.34-.01a.96.96 0 000-1.34L8.34 7.01l5.08-5.08a.95.95 0 000-1.33.97.97 0 00-1.34-.01L6.99 5.68 1.91.59a.96.96 0 00-1.33 0 .97.97 0 00-.01 1.34l5.09 5.08-5.1 5.1z' fill='%23FCFCFC'/%3E%3C/svg%3E\");\n    }\n    .%prefix%-close:hover {\n        background-color: black;\n    }\n}\n\n@media (max-height: 600px) { .%prefix%-inner { transform: scale(0.9); } }\n@media (max-height: 540px) { .%prefix%-inner { transform: scale(0.8); } }\n@media (max-height: 480px) { .%prefix%-inner { transform: scale(0.7); } }\n@media (max-height: 420px) { .%prefix%-inner { transform: scale(0.6); } }\n@media (max-height: 360px) { .%prefix%-inner { transform: scale(0.5); } }\n@media (max-height: 300px) { .%prefix%-inner { transform: scale(0.4); } }\n\n`;\n\nvar ErrorCorrectLevel = {\n    L: 1,\n    M: 0,\n    Q: 3,\n    H: 2,\n};\n\nvar Mode = {\n    MODE_NUMBER: 1 << 0,\n    MODE_ALPHA_NUM: 1 << 1,\n    MODE_8BIT_BYTE: 1 << 2,\n    MODE_KANJI: 1 << 3,\n};\n\nclass QR8bitByte {\n    constructor(data) {\n        this.mode = Mode.MODE_8BIT_BYTE;\n        this.data = data;\n    }\n    getLength() {\n        return this.data.length;\n    }\n    write(buffer) {\n        for (let i = 0; i < this.data.length; i++) {\n            // not JIS ...\n            buffer.put(this.data.charCodeAt(i), 8);\n        }\n    }\n}\n\nclass QRBitBuffer {\n    constructor() {\n        this.buffer = [];\n        this.length = 0;\n    }\n    get(index) {\n        const bufIndex = Math.floor(index / 8);\n        return ((this.buffer[bufIndex] >>> (7 - (index % 8))) & 1) == 1;\n    }\n    put(num, length) {\n        for (let i = 0; i < length; i++) {\n            this.putBit(((num >>> (length - i - 1)) & 1) == 1);\n        }\n    }\n    getLengthInBits() {\n        return this.length;\n    }\n    putBit(bit) {\n        const bufIndex = Math.floor(this.length / 8);\n        if (this.buffer.length <= bufIndex) {\n            this.buffer.push(0);\n        }\n        if (bit) {\n            this.buffer[bufIndex] |= 0x80 >>> this.length % 8;\n        }\n        this.length++;\n    }\n}\n\nconst QRMath = {\n    glog: function (n) {\n        if (n < 1) {\n            throw new Error('glog(' + n + ')');\n        }\n        return QRMath.LOG_TABLE[n];\n    },\n    gexp: function (n) {\n        while (n < 0) {\n            n += 255;\n        }\n        while (n >= 256) {\n            n -= 255;\n        }\n        return QRMath.EXP_TABLE[n];\n    },\n    EXP_TABLE: new Array(256),\n    LOG_TABLE: new Array(256),\n};\nfor (let i = 0; i < 8; i++) {\n    QRMath.EXP_TABLE[i] = 1 << i;\n}\nfor (let i = 8; i < 256; i++) {\n    QRMath.EXP_TABLE[i] =\n        QRMath.EXP_TABLE[i - 4] ^\n            QRMath.EXP_TABLE[i - 5] ^\n            QRMath.EXP_TABLE[i - 6] ^\n            QRMath.EXP_TABLE[i - 8];\n}\nfor (let i = 0; i < 255; i++) {\n    QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]] = i;\n}\n\nclass QRPolynomial {\n    constructor(num, shift) {\n        if (num.length == undefined) {\n            throw new Error(num.length + '/' + shift);\n        }\n        let offset = 0;\n        while (offset < num.length && num[offset] == 0) {\n            offset++;\n        }\n        this.num = new Array(num.length - offset + shift);\n        for (let i = 0; i < num.length - offset; i++) {\n            this.num[i] = num[i + offset];\n        }\n    }\n    get(index) {\n        return this.num[index];\n    }\n    getLength() {\n        return this.num.length;\n    }\n    multiply(e) {\n        const num = new Array(this.getLength() + e.getLength() - 1);\n        for (let i = 0; i < this.getLength(); i++) {\n            for (let j = 0; j < e.getLength(); j++) {\n                num[i + j] ^= QRMath.gexp(QRMath.glog(this.get(i)) + QRMath.glog(e.get(j)));\n            }\n        }\n        return new QRPolynomial(num, 0);\n    }\n    mod(e) {\n        if (this.getLength() - e.getLength() < 0) {\n            return this;\n        }\n        const ratio = QRMath.glog(this.get(0)) - QRMath.glog(e.get(0));\n        const num = new Array(this.getLength());\n        for (let i = 0; i < this.getLength(); i++) {\n            num[i] = this.get(i);\n        }\n        for (let i = 0; i < e.getLength(); i++) {\n            num[i] ^= QRMath.gexp(QRMath.glog(e.get(i)) + ratio);\n        }\n        // recursive call\n        return new QRPolynomial(num, 0).mod(e);\n    }\n}\n\n// ErrorCorrectLevel\nclass QRRSBlock {\n    constructor(totalCount, dataCount) {\n        this.totalCount = totalCount;\n        this.dataCount = dataCount;\n    }\n    static getRSBlocks(typeNumber, errorCorrectLevel) {\n        const rsBlock = QRRSBlock.getRsBlockTable(typeNumber, errorCorrectLevel);\n        if (rsBlock == undefined) {\n            throw new Error('bad rs block @ typeNumber:' +\n                typeNumber +\n                '/errorCorrectLevel:' +\n                errorCorrectLevel);\n        }\n        const length = rsBlock.length / 3;\n        const list = [];\n        for (let i = 0; i < length; i++) {\n            const count = rsBlock[i * 3 + 0];\n            const totalCount = rsBlock[i * 3 + 1];\n            const dataCount = rsBlock[i * 3 + 2];\n            for (let j = 0; j < count; j++) {\n                list.push(new QRRSBlock(totalCount, dataCount));\n            }\n        }\n        return list;\n    }\n    static getRsBlockTable(typeNumber, errorCorrectLevel) {\n        switch (errorCorrectLevel) {\n            case ErrorCorrectLevel.L:\n                return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 0];\n            case ErrorCorrectLevel.M:\n                return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 1];\n            case ErrorCorrectLevel.Q:\n                return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 2];\n            case ErrorCorrectLevel.H:\n                return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 3];\n            default:\n                return undefined;\n        }\n    }\n}\nQRRSBlock.RS_BLOCK_TABLE = [\n    // L\n    // M\n    // Q\n    // H\n    // 1\n    [1, 26, 19],\n    [1, 26, 16],\n    [1, 26, 13],\n    [1, 26, 9],\n    // 2\n    [1, 44, 34],\n    [1, 44, 28],\n    [1, 44, 22],\n    [1, 44, 16],\n    // 3\n    [1, 70, 55],\n    [1, 70, 44],\n    [2, 35, 17],\n    [2, 35, 13],\n    // 4\n    [1, 100, 80],\n    [2, 50, 32],\n    [2, 50, 24],\n    [4, 25, 9],\n    // 5\n    [1, 134, 108],\n    [2, 67, 43],\n    [2, 33, 15, 2, 34, 16],\n    [2, 33, 11, 2, 34, 12],\n    // 6\n    [2, 86, 68],\n    [4, 43, 27],\n    [4, 43, 19],\n    [4, 43, 15],\n    // 7\n    [2, 98, 78],\n    [4, 49, 31],\n    [2, 32, 14, 4, 33, 15],\n    [4, 39, 13, 1, 40, 14],\n    // 8\n    [2, 121, 97],\n    [2, 60, 38, 2, 61, 39],\n    [4, 40, 18, 2, 41, 19],\n    [4, 40, 14, 2, 41, 15],\n    // 9\n    [2, 146, 116],\n    [3, 58, 36, 2, 59, 37],\n    [4, 36, 16, 4, 37, 17],\n    [4, 36, 12, 4, 37, 13],\n    // 10\n    [2, 86, 68, 2, 87, 69],\n    [4, 69, 43, 1, 70, 44],\n    [6, 43, 19, 2, 44, 20],\n    [6, 43, 15, 2, 44, 16],\n    // 11\n    [4, 101, 81],\n    [1, 80, 50, 4, 81, 51],\n    [4, 50, 22, 4, 51, 23],\n    [3, 36, 12, 8, 37, 13],\n    // 12\n    [2, 116, 92, 2, 117, 93],\n    [6, 58, 36, 2, 59, 37],\n    [4, 46, 20, 6, 47, 21],\n    [7, 42, 14, 4, 43, 15],\n    // 13\n    [4, 133, 107],\n    [8, 59, 37, 1, 60, 38],\n    [8, 44, 20, 4, 45, 21],\n    [12, 33, 11, 4, 34, 12],\n    // 14\n    [3, 145, 115, 1, 146, 116],\n    [4, 64, 40, 5, 65, 41],\n    [11, 36, 16, 5, 37, 17],\n    [11, 36, 12, 5, 37, 13],\n    // 15\n    [5, 109, 87, 1, 110, 88],\n    [5, 65, 41, 5, 66, 42],\n    [5, 54, 24, 7, 55, 25],\n    [11, 36, 12],\n    // 16\n    [5, 122, 98, 1, 123, 99],\n    [7, 73, 45, 3, 74, 46],\n    [15, 43, 19, 2, 44, 20],\n    [3, 45, 15, 13, 46, 16],\n    // 17\n    [1, 135, 107, 5, 136, 108],\n    [10, 74, 46, 1, 75, 47],\n    [1, 50, 22, 15, 51, 23],\n    [2, 42, 14, 17, 43, 15],\n    // 18\n    [5, 150, 120, 1, 151, 121],\n    [9, 69, 43, 4, 70, 44],\n    [17, 50, 22, 1, 51, 23],\n    [2, 42, 14, 19, 43, 15],\n    // 19\n    [3, 141, 113, 4, 142, 114],\n    [3, 70, 44, 11, 71, 45],\n    [17, 47, 21, 4, 48, 22],\n    [9, 39, 13, 16, 40, 14],\n    // 20\n    [3, 135, 107, 5, 136, 108],\n    [3, 67, 41, 13, 68, 42],\n    [15, 54, 24, 5, 55, 25],\n    [15, 43, 15, 10, 44, 16],\n    // 21\n    [4, 144, 116, 4, 145, 117],\n    [17, 68, 42],\n    [17, 50, 22, 6, 51, 23],\n    [19, 46, 16, 6, 47, 17],\n    // 22\n    [2, 139, 111, 7, 140, 112],\n    [17, 74, 46],\n    [7, 54, 24, 16, 55, 25],\n    [34, 37, 13],\n    // 23\n    [4, 151, 121, 5, 152, 122],\n    [4, 75, 47, 14, 76, 48],\n    [11, 54, 24, 14, 55, 25],\n    [16, 45, 15, 14, 46, 16],\n    // 24\n    [6, 147, 117, 4, 148, 118],\n    [6, 73, 45, 14, 74, 46],\n    [11, 54, 24, 16, 55, 25],\n    [30, 46, 16, 2, 47, 17],\n    // 25\n    [8, 132, 106, 4, 133, 107],\n    [8, 75, 47, 13, 76, 48],\n    [7, 54, 24, 22, 55, 25],\n    [22, 45, 15, 13, 46, 16],\n    // 26\n    [10, 142, 114, 2, 143, 115],\n    [19, 74, 46, 4, 75, 47],\n    [28, 50, 22, 6, 51, 23],\n    [33, 46, 16, 4, 47, 17],\n    // 27\n    [8, 152, 122, 4, 153, 123],\n    [22, 73, 45, 3, 74, 46],\n    [8, 53, 23, 26, 54, 24],\n    [12, 45, 15, 28, 46, 16],\n    // 28\n    [3, 147, 117, 10, 148, 118],\n    [3, 73, 45, 23, 74, 46],\n    [4, 54, 24, 31, 55, 25],\n    [11, 45, 15, 31, 46, 16],\n    // 29\n    [7, 146, 116, 7, 147, 117],\n    [21, 73, 45, 7, 74, 46],\n    [1, 53, 23, 37, 54, 24],\n    [19, 45, 15, 26, 46, 16],\n    // 30\n    [5, 145, 115, 10, 146, 116],\n    [19, 75, 47, 10, 76, 48],\n    [15, 54, 24, 25, 55, 25],\n    [23, 45, 15, 25, 46, 16],\n    // 31\n    [13, 145, 115, 3, 146, 116],\n    [2, 74, 46, 29, 75, 47],\n    [42, 54, 24, 1, 55, 25],\n    [23, 45, 15, 28, 46, 16],\n    // 32\n    [17, 145, 115],\n    [10, 74, 46, 23, 75, 47],\n    [10, 54, 24, 35, 55, 25],\n    [19, 45, 15, 35, 46, 16],\n    // 33\n    [17, 145, 115, 1, 146, 116],\n    [14, 74, 46, 21, 75, 47],\n    [29, 54, 24, 19, 55, 25],\n    [11, 45, 15, 46, 46, 16],\n    // 34\n    [13, 145, 115, 6, 146, 116],\n    [14, 74, 46, 23, 75, 47],\n    [44, 54, 24, 7, 55, 25],\n    [59, 46, 16, 1, 47, 17],\n    // 35\n    [12, 151, 121, 7, 152, 122],\n    [12, 75, 47, 26, 76, 48],\n    [39, 54, 24, 14, 55, 25],\n    [22, 45, 15, 41, 46, 16],\n    // 36\n    [6, 151, 121, 14, 152, 122],\n    [6, 75, 47, 34, 76, 48],\n    [46, 54, 24, 10, 55, 25],\n    [2, 45, 15, 64, 46, 16],\n    // 37\n    [17, 152, 122, 4, 153, 123],\n    [29, 74, 46, 14, 75, 47],\n    [49, 54, 24, 10, 55, 25],\n    [24, 45, 15, 46, 46, 16],\n    // 38\n    [4, 152, 122, 18, 153, 123],\n    [13, 74, 46, 32, 75, 47],\n    [48, 54, 24, 14, 55, 25],\n    [42, 45, 15, 32, 46, 16],\n    // 39\n    [20, 147, 117, 4, 148, 118],\n    [40, 75, 47, 7, 76, 48],\n    [43, 54, 24, 22, 55, 25],\n    [10, 45, 15, 67, 46, 16],\n    // 40\n    [19, 148, 118, 6, 149, 119],\n    [18, 75, 47, 31, 76, 48],\n    [34, 54, 24, 34, 55, 25],\n    [20, 45, 15, 61, 46, 16],\n];\n\nconst QRMaskPattern = {\n    PATTERN000: 0,\n    PATTERN001: 1,\n    PATTERN010: 2,\n    PATTERN011: 3,\n    PATTERN100: 4,\n    PATTERN101: 5,\n    PATTERN110: 6,\n    PATTERN111: 7,\n};\nconst QRUtil = {\n    PATTERN_POSITION_TABLE: [\n        [],\n        [6, 18],\n        [6, 22],\n        [6, 26],\n        [6, 30],\n        [6, 34],\n        [6, 22, 38],\n        [6, 24, 42],\n        [6, 26, 46],\n        [6, 28, 50],\n        [6, 30, 54],\n        [6, 32, 58],\n        [6, 34, 62],\n        [6, 26, 46, 66],\n        [6, 26, 48, 70],\n        [6, 26, 50, 74],\n        [6, 30, 54, 78],\n        [6, 30, 56, 82],\n        [6, 30, 58, 86],\n        [6, 34, 62, 90],\n        [6, 28, 50, 72, 94],\n        [6, 26, 50, 74, 98],\n        [6, 30, 54, 78, 102],\n        [6, 28, 54, 80, 106],\n        [6, 32, 58, 84, 110],\n        [6, 30, 58, 86, 114],\n        [6, 34, 62, 90, 118],\n        [6, 26, 50, 74, 98, 122],\n        [6, 30, 54, 78, 102, 126],\n        [6, 26, 52, 78, 104, 130],\n        [6, 30, 56, 82, 108, 134],\n        [6, 34, 60, 86, 112, 138],\n        [6, 30, 58, 86, 114, 142],\n        [6, 34, 62, 90, 118, 146],\n        [6, 30, 54, 78, 102, 126, 150],\n        [6, 24, 50, 76, 102, 128, 154],\n        [6, 28, 54, 80, 106, 132, 158],\n        [6, 32, 58, 84, 110, 136, 162],\n        [6, 26, 54, 82, 110, 138, 166],\n        [6, 30, 58, 86, 114, 142, 170],\n    ],\n    G15: (1 << 10) | (1 << 8) | (1 << 5) | (1 << 4) | (1 << 2) | (1 << 1) | (1 << 0),\n    G18: (1 << 12) | (1 << 11) | (1 << 10) | (1 << 9) | (1 << 8) | (1 << 5) | (1 << 2) | (1 << 0),\n    G15_MASK: (1 << 14) | (1 << 12) | (1 << 10) | (1 << 4) | (1 << 1),\n    getBCHTypeInfo: function (data) {\n        let d = data << 10;\n        while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15) >= 0) {\n            d ^= QRUtil.G15 << (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15));\n        }\n        return ((data << 10) | d) ^ QRUtil.G15_MASK;\n    },\n    getBCHTypeNumber: function (data) {\n        let d = data << 12;\n        while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18) >= 0) {\n            d ^= QRUtil.G18 << (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18));\n        }\n        return (data << 12) | d;\n    },\n    getBCHDigit: function (data) {\n        let digit = 0;\n        while (data != 0) {\n            digit++;\n            data >>>= 1;\n        }\n        return digit;\n    },\n    getPatternPosition: function (typeNumber) {\n        return QRUtil.PATTERN_POSITION_TABLE[typeNumber - 1];\n    },\n    getMask: function (maskPattern, i, j) {\n        switch (maskPattern) {\n            case QRMaskPattern.PATTERN000:\n                return (i + j) % 2 == 0;\n            case QRMaskPattern.PATTERN001:\n                return i % 2 == 0;\n            case QRMaskPattern.PATTERN010:\n                return j % 3 == 0;\n            case QRMaskPattern.PATTERN011:\n                return (i + j) % 3 == 0;\n            case QRMaskPattern.PATTERN100:\n                return (Math.floor(i / 2) + Math.floor(j / 3)) % 2 == 0;\n            case QRMaskPattern.PATTERN101:\n                return ((i * j) % 2) + ((i * j) % 3) == 0;\n            case QRMaskPattern.PATTERN110:\n                return (((i * j) % 2) + ((i * j) % 3)) % 2 == 0;\n            case QRMaskPattern.PATTERN111:\n                return (((i * j) % 3) + ((i + j) % 2)) % 2 == 0;\n            default:\n                throw new Error('bad maskPattern:' + maskPattern);\n        }\n    },\n    getErrorCorrectPolynomial: function (errorCorrectLength) {\n        let a = new QRPolynomial([1], 0);\n        for (let i = 0; i < errorCorrectLength; i++) {\n            a = a.multiply(new QRPolynomial([1, QRMath.gexp(i)], 0));\n        }\n        return a;\n    },\n    getLengthInBits: function (mode, type) {\n        if (1 <= type && type < 10) {\n            // 1 - 9\n            switch (mode) {\n                case Mode.MODE_NUMBER:\n                    return 10;\n                case Mode.MODE_ALPHA_NUM:\n                    return 9;\n                case Mode.MODE_8BIT_BYTE:\n                    return 8;\n                case Mode.MODE_KANJI:\n                    return 8;\n                default:\n                    throw new Error('mode:' + mode);\n            }\n        }\n        else if (type < 27) {\n            // 10 - 26\n            switch (mode) {\n                case Mode.MODE_NUMBER:\n                    return 12;\n                case Mode.MODE_ALPHA_NUM:\n                    return 11;\n                case Mode.MODE_8BIT_BYTE:\n                    return 16;\n                case Mode.MODE_KANJI:\n                    return 10;\n                default:\n                    throw new Error('mode:' + mode);\n            }\n        }\n        else if (type < 41) {\n            // 27 - 40\n            switch (mode) {\n                case Mode.MODE_NUMBER:\n                    return 14;\n                case Mode.MODE_ALPHA_NUM:\n                    return 13;\n                case Mode.MODE_8BIT_BYTE:\n                    return 16;\n                case Mode.MODE_KANJI:\n                    return 12;\n                default:\n                    throw new Error('mode:' + mode);\n            }\n        }\n        else {\n            throw new Error('type:' + type);\n        }\n    },\n    getLostPoint: function (qrCode) {\n        const moduleCount = qrCode.getModuleCount();\n        let lostPoint = 0;\n        // LEVEL1\n        for (let row = 0; row < moduleCount; row++) {\n            for (let col = 0; col < moduleCount; col++) {\n                let sameCount = 0;\n                const dark = qrCode.isDark(row, col);\n                for (let r = -1; r <= 1; r++) {\n                    if (row + r < 0 || moduleCount <= row + r) {\n                        continue;\n                    }\n                    for (let c = -1; c <= 1; c++) {\n                        if (col + c < 0 || moduleCount <= col + c) {\n                            continue;\n                        }\n                        if (r == 0 && c == 0) {\n                            continue;\n                        }\n                        if (dark == qrCode.isDark(row + r, col + c)) {\n                            sameCount++;\n                        }\n                    }\n                }\n                if (sameCount > 5) {\n                    lostPoint += 3 + sameCount - 5;\n                }\n            }\n        }\n        // LEVEL2\n        for (let row = 0; row < moduleCount - 1; row++) {\n            for (let col = 0; col < moduleCount - 1; col++) {\n                let count = 0;\n                if (qrCode.isDark(row, col))\n                    count++;\n                if (qrCode.isDark(row + 1, col))\n                    count++;\n                if (qrCode.isDark(row, col + 1))\n                    count++;\n                if (qrCode.isDark(row + 1, col + 1))\n                    count++;\n                if (count == 0 || count == 4) {\n                    lostPoint += 3;\n                }\n            }\n        }\n        // LEVEL3\n        for (let row = 0; row < moduleCount; row++) {\n            for (let col = 0; col < moduleCount - 6; col++) {\n                if (qrCode.isDark(row, col) &&\n                    !qrCode.isDark(row, col + 1) &&\n                    qrCode.isDark(row, col + 2) &&\n                    qrCode.isDark(row, col + 3) &&\n                    qrCode.isDark(row, col + 4) &&\n                    !qrCode.isDark(row, col + 5) &&\n                    qrCode.isDark(row, col + 6)) {\n                    lostPoint += 40;\n                }\n            }\n        }\n        for (let col = 0; col < moduleCount; col++) {\n            for (let row = 0; row < moduleCount - 6; row++) {\n                if (qrCode.isDark(row, col) &&\n                    !qrCode.isDark(row + 1, col) &&\n                    qrCode.isDark(row + 2, col) &&\n                    qrCode.isDark(row + 3, col) &&\n                    qrCode.isDark(row + 4, col) &&\n                    !qrCode.isDark(row + 5, col) &&\n                    qrCode.isDark(row + 6, col)) {\n                    lostPoint += 40;\n                }\n            }\n        }\n        // LEVEL4\n        let darkCount = 0;\n        for (let col = 0; col < moduleCount; col++) {\n            for (let row = 0; row < moduleCount; row++) {\n                if (qrCode.isDark(row, col)) {\n                    darkCount++;\n                }\n            }\n        }\n        const ratio = Math.abs((100 * darkCount) / moduleCount / moduleCount - 50) / 5;\n        lostPoint += ratio * 10;\n        return lostPoint;\n    },\n};\n\nclass QRCode {\n    constructor(typeNumber, errorCorrectLevel) {\n        this.typeNumber = typeNumber;\n        this.errorCorrectLevel = errorCorrectLevel;\n        this.modules = null;\n        this.moduleCount = 0;\n        this.dataCache = null;\n        this.dataList = [];\n    }\n    addData(data) {\n        const newData = new QR8bitByte(data);\n        this.dataList.push(newData);\n        this.dataCache = null;\n    }\n    isDark(row, col) {\n        if (row < 0 || this.moduleCount <= row || col < 0 || this.moduleCount <= col) {\n            throw new Error(row + ',' + col);\n        }\n        return this.modules[row][col];\n    }\n    getModuleCount() {\n        return this.moduleCount;\n    }\n    make() {\n        // Calculate automatically typeNumber if provided is < 1\n        if (this.typeNumber < 1) {\n            let typeNumber = 1;\n            for (typeNumber = 1; typeNumber < 40; typeNumber++) {\n                const rsBlocks = QRRSBlock.getRSBlocks(typeNumber, this.errorCorrectLevel);\n                const buffer = new QRBitBuffer();\n                let totalDataCount = 0;\n                for (let i = 0; i < rsBlocks.length; i++) {\n                    totalDataCount += rsBlocks[i].dataCount;\n                }\n                for (let i = 0; i < this.dataList.length; i++) {\n                    const data = this.dataList[i];\n                    buffer.put(data.mode, 4);\n                    buffer.put(data.getLength(), QRUtil.getLengthInBits(data.mode, typeNumber));\n                    data.write(buffer);\n                }\n                if (buffer.getLengthInBits() <= totalDataCount * 8)\n                    break;\n            }\n            this.typeNumber = typeNumber;\n        }\n        this.makeImpl(false, this.getBestMaskPattern());\n    }\n    makeImpl(test, maskPattern) {\n        this.moduleCount = this.typeNumber * 4 + 17;\n        this.modules = new Array(this.moduleCount);\n        for (let row = 0; row < this.moduleCount; row++) {\n            this.modules[row] = new Array(this.moduleCount);\n            for (let col = 0; col < this.moduleCount; col++) {\n                this.modules[row][col] = null; //(col + row) % 3;\n            }\n        }\n        this.setupPositionProbePattern(0, 0);\n        this.setupPositionProbePattern(this.moduleCount - 7, 0);\n        this.setupPositionProbePattern(0, this.moduleCount - 7);\n        this.setupPositionAdjustPattern();\n        this.setupTimingPattern();\n        this.setupTypeInfo(test, maskPattern);\n        if (this.typeNumber >= 7) {\n            this.setupTypeNumber(test);\n        }\n        if (this.dataCache == null) {\n            this.dataCache = QRCode.createData(this.typeNumber, this.errorCorrectLevel, this.dataList);\n        }\n        this.mapData(this.dataCache, maskPattern);\n    }\n    setupPositionProbePattern(row, col) {\n        for (let r = -1; r <= 7; r++) {\n            if (row + r <= -1 || this.moduleCount <= row + r)\n                continue;\n            for (let c = -1; c <= 7; c++) {\n                if (col + c <= -1 || this.moduleCount <= col + c)\n                    continue;\n                if ((0 <= r && r <= 6 && (c == 0 || c == 6)) ||\n                    (0 <= c && c <= 6 && (r == 0 || r == 6)) ||\n                    (2 <= r && r <= 4 && 2 <= c && c <= 4)) {\n                    this.modules[row + r][col + c] = true;\n                }\n                else {\n                    this.modules[row + r][col + c] = false;\n                }\n            }\n        }\n    }\n    getBestMaskPattern() {\n        let minLostPoint = 0;\n        let pattern = 0;\n        for (let i = 0; i < 8; i++) {\n            this.makeImpl(true, i);\n            const lostPoint = QRUtil.getLostPoint(this);\n            if (i == 0 || minLostPoint > lostPoint) {\n                minLostPoint = lostPoint;\n                pattern = i;\n            }\n        }\n        return pattern;\n    }\n    setupTimingPattern() {\n        for (let r = 8; r < this.moduleCount - 8; r++) {\n            if (this.modules[r][6] != null) {\n                continue;\n            }\n            this.modules[r][6] = r % 2 == 0;\n        }\n        for (let c = 8; c < this.moduleCount - 8; c++) {\n            if (this.modules[6][c] != null) {\n                continue;\n            }\n            this.modules[6][c] = c % 2 == 0;\n        }\n    }\n    setupPositionAdjustPattern() {\n        const pos = QRUtil.getPatternPosition(this.typeNumber);\n        for (let i = 0; i < pos.length; i++) {\n            for (let j = 0; j < pos.length; j++) {\n                const row = pos[i];\n                const col = pos[j];\n                if (this.modules[row][col] != null) {\n                    continue;\n                }\n                for (let r = -2; r <= 2; r++) {\n                    for (let c = -2; c <= 2; c++) {\n                        if (r == -2 || r == 2 || c == -2 || c == 2 || (r == 0 && c == 0)) {\n                            this.modules[row + r][col + c] = true;\n                        }\n                        else {\n                            this.modules[row + r][col + c] = false;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    setupTypeNumber(test) {\n        const bits = QRUtil.getBCHTypeNumber(this.typeNumber);\n        for (let i = 0; i < 18; i++) {\n            const mod = !test && ((bits >> i) & 1) == 1;\n            this.modules[Math.floor(i / 3)][(i % 3) + this.moduleCount - 8 - 3] = mod;\n        }\n        for (let i = 0; i < 18; i++) {\n            const mod = !test && ((bits >> i) & 1) == 1;\n            this.modules[(i % 3) + this.moduleCount - 8 - 3][Math.floor(i / 3)] = mod;\n        }\n    }\n    setupTypeInfo(test, maskPattern) {\n        const data = (this.errorCorrectLevel << 3) | maskPattern;\n        const bits = QRUtil.getBCHTypeInfo(data);\n        // vertical\n        for (let i = 0; i < 15; i++) {\n            const mod = !test && ((bits >> i) & 1) == 1;\n            if (i < 6) {\n                this.modules[i][8] = mod;\n            }\n            else if (i < 8) {\n                this.modules[i + 1][8] = mod;\n            }\n            else {\n                this.modules[this.moduleCount - 15 + i][8] = mod;\n            }\n        }\n        // horizontal\n        for (let i = 0; i < 15; i++) {\n            const mod = !test && ((bits >> i) & 1) == 1;\n            if (i < 8) {\n                this.modules[8][this.moduleCount - i - 1] = mod;\n            }\n            else if (i < 9) {\n                this.modules[8][15 - i - 1 + 1] = mod;\n            }\n            else {\n                this.modules[8][15 - i - 1] = mod;\n            }\n        }\n        // fixed module\n        this.modules[this.moduleCount - 8][8] = !test;\n    }\n    mapData(data, maskPattern) {\n        let inc = -1;\n        let row = this.moduleCount - 1;\n        let bitIndex = 7;\n        let byteIndex = 0;\n        for (let col = this.moduleCount - 1; col > 0; col -= 2) {\n            if (col == 6)\n                col--;\n            for (;;) {\n                for (let c = 0; c < 2; c++) {\n                    if (this.modules[row][col - c] == null) {\n                        let dark = false;\n                        if (byteIndex < data.length) {\n                            dark = ((data[byteIndex] >>> bitIndex) & 1) == 1;\n                        }\n                        const mask = QRUtil.getMask(maskPattern, row, col - c);\n                        if (mask) {\n                            dark = !dark;\n                        }\n                        this.modules[row][col - c] = dark;\n                        bitIndex--;\n                        if (bitIndex == -1) {\n                            byteIndex++;\n                            bitIndex = 7;\n                        }\n                    }\n                }\n                row += inc;\n                if (row < 0 || this.moduleCount <= row) {\n                    row -= inc;\n                    inc = -inc;\n                    break;\n                }\n            }\n        }\n    }\n    static createData(typeNumber, errorCorrectLevel, dataList) {\n        const rsBlocks = QRRSBlock.getRSBlocks(typeNumber, errorCorrectLevel);\n        const buffer = new QRBitBuffer();\n        for (let i = 0; i < dataList.length; i++) {\n            const data = dataList[i];\n            buffer.put(data.mode, 4);\n            buffer.put(data.getLength(), QRUtil.getLengthInBits(data.mode, typeNumber));\n            data.write(buffer);\n        }\n        // calc num max data.\n        let totalDataCount = 0;\n        for (let i = 0; i < rsBlocks.length; i++) {\n            totalDataCount += rsBlocks[i].dataCount;\n        }\n        if (buffer.getLengthInBits() > totalDataCount * 8) {\n            throw new Error('code length overflow. (' +\n                buffer.getLengthInBits() +\n                '>' +\n                totalDataCount * 8 +\n                ')');\n        }\n        // end code\n        if (buffer.getLengthInBits() + 4 <= totalDataCount * 8) {\n            buffer.put(0, 4);\n        }\n        // padding\n        while (buffer.getLengthInBits() % 8 != 0) {\n            buffer.putBit(false);\n        }\n        // padding\n        for (;;) {\n            if (buffer.getLengthInBits() >= totalDataCount * 8) {\n                break;\n            }\n            buffer.put(QRCode.PAD0, 8);\n            if (buffer.getLengthInBits() >= totalDataCount * 8) {\n                break;\n            }\n            buffer.put(QRCode.PAD1, 8);\n        }\n        return QRCode.createBytes(buffer, rsBlocks);\n    }\n    static createBytes(buffer, rsBlocks) {\n        let offset = 0;\n        let maxDcCount = 0;\n        let maxEcCount = 0;\n        const dcdata = new Array(rsBlocks.length);\n        const ecdata = new Array(rsBlocks.length);\n        for (let r = 0; r < rsBlocks.length; r++) {\n            const dcCount = rsBlocks[r].dataCount;\n            const ecCount = rsBlocks[r].totalCount - dcCount;\n            maxDcCount = Math.max(maxDcCount, dcCount);\n            maxEcCount = Math.max(maxEcCount, ecCount);\n            dcdata[r] = new Array(dcCount);\n            for (let i = 0; i < dcdata[r].length; i++) {\n                dcdata[r][i] = 0xff & buffer.buffer[i + offset];\n            }\n            offset += dcCount;\n            const rsPoly = QRUtil.getErrorCorrectPolynomial(ecCount);\n            const rawPoly = new QRPolynomial(dcdata[r], rsPoly.getLength() - 1);\n            const modPoly = rawPoly.mod(rsPoly);\n            ecdata[r] = new Array(rsPoly.getLength() - 1);\n            for (let i = 0; i < ecdata[r].length; i++) {\n                const modIndex = i + modPoly.getLength() - ecdata[r].length;\n                ecdata[r][i] = modIndex >= 0 ? modPoly.get(modIndex) : 0;\n            }\n        }\n        let totalCodeCount = 0;\n        for (let i = 0; i < rsBlocks.length; i++) {\n            totalCodeCount += rsBlocks[i].totalCount;\n        }\n        const data = new Array(totalCodeCount);\n        let index = 0;\n        for (let i = 0; i < maxDcCount; i++) {\n            for (let r = 0; r < rsBlocks.length; r++) {\n                if (i < dcdata[r].length) {\n                    data[index++] = dcdata[r][i];\n                }\n            }\n        }\n        for (let i = 0; i < maxEcCount; i++) {\n            for (let r = 0; r < rsBlocks.length; r++) {\n                if (i < ecdata[r].length) {\n                    data[index++] = ecdata[r][i];\n                }\n            }\n        }\n        return data;\n    }\n}\nQRCode.PAD0 = 0xec;\nQRCode.PAD1 = 0x11;\n\n/**\n * Generate QR SVG\n * @author Johan Nordberg <code@johan-nordberg.com>\n */\nfunction generate(text, level = 'L', version = -1) {\n    const qr = new QRCode(version, ErrorCorrectLevel[level]);\n    const rects = [];\n    qr.addData(text);\n    qr.make();\n    const rows = qr.modules;\n    const size = rows.length;\n    for (const [y, row] of rows.entries()) {\n        let rect;\n        for (const [x, on] of row.entries()) {\n            if (on) {\n                if (!rect)\n                    rect = { x, y, width: 0, height: 1 };\n                rect.width++;\n            }\n            else {\n                if (rect && rect.width > 0) {\n                    rects.push(rect);\n                }\n                rect = undefined;\n            }\n        }\n        if (rect && rect.width > 0) {\n            rects.push(rect);\n        }\n    }\n    const svg = [`<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 ${size} ${size}\">`];\n    for (const { x, y, width, height } of rects) {\n        svg.push(`<rect x=\"${x}\" y=\"${y}\" width=\"${width}\" height=\"${height}\" />`);\n    }\n    svg.push('</svg>');\n    return svg.join('');\n}\n\nasync function apiCall(url, body) {\n    return (await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: body ? JSON.stringify(body) : undefined,\n    })).json();\n}\nconst version = 'fuel/2';\n/** Return true if otherVersion is same or greater than current fuel version. */\nfunction compareVersion(otherVersion) {\n    return parseVersion(otherVersion) >= parseVersion(version);\n}\nfunction parseVersion(string) {\n    const parts = string.trim().split('/');\n    if (parts.length === 2 && parts[0] === 'fuel') {\n        return parseInt(parts[1]) || 0;\n    }\n    return -1;\n}\nasync function fuel(request, session, updatePrepareStatus, supportedChains, referrer) {\n    assertEligible(request, session);\n    updatePrepareStatus('Detecting if network resources are required.');\n    const chainId = request.getChainId();\n    const nodeUrl = supportedChains[String(chainId)];\n    if (!nodeUrl) {\n        throw new Error(`Blockchain not supported by this resource provider.`);\n    }\n    const result = await apiCall(nodeUrl + '/v1/resource_provider/request_transaction', {\n        ref: referrer,\n        request,\n        signer: session.auth,\n    });\n    if (!result || !result.data) {\n        throw new Error('Invalid response from resource provider.');\n    }\n    if (!result.data.signatures || !result.data.signatures[0]) {\n        throw new Error('No signature returned from resource provider.');\n    }\n    if (result.code === 402 && !result.data.fee) {\n        throw new Error('Resource provider returned a response indicating required payment, but provided no fee amount.');\n    }\n    // Clone the request for modification\n    const cloned = request.clone();\n    // Set the required fee onto the request for signature providers\n    if (result.code === 402) {\n        if (request.getInfoKey('no_fee')) {\n            throw new Error('Fee required but sender opted out.');\n        }\n        cloned.setInfoKey('txfee', result.data.fee);\n    }\n    // If the fee costs exist, set them on the request for the signature provider to consume\n    if (result.data.costs) {\n        cloned.setInfoKey('txfeecpu', result.data.costs.cpu);\n        cloned.setInfoKey('txfeenet', result.data.costs.net);\n        cloned.setInfoKey('txfeeram', result.data.costs.ram);\n    }\n    // Set the cosigner signature onto the request for signature providers\n    const signatures = result.data.signatures.map((s) => Signature.from(s));\n    cloned.setInfoKey('cosig', signatures, { type: Signature, array: true });\n    // Modify the request based on the response from the API\n    cloned.data.req = (await SigningRequest.create({ transaction: { ...result.data.request[1] } }, { abiProvider: request.abiProvider })).data.req;\n    return cloned;\n}\nfunction assertEligible(request, session) {\n    if (request.getRawInfoKey('no_modify')) {\n        throw new Error('Request cannot be modified.');\n    }\n    if (request.isIdentity()) {\n        throw new Error('Identity requests cannot be co-signed.');\n    }\n    const firstAction = request.getRawActions()[0];\n    if (!firstAction) {\n        throw new Error('No actions in request.');\n    }\n    const firstAuthorizer = firstAction.authorization[0];\n    if (!firstAction) {\n        throw new Error('First authorization missing.');\n    }\n    if (!firstAuthorizer.actor.equals(session.auth.actor) &&\n        !firstAuthorizer.actor.equals(PlaceholderName)) {\n        throw new Error('Not first authorizer.');\n    }\n}\n\nconst AbortPrepare = Symbol();\nconst SkipFee = Symbol();\nconst defaultSupportedChains = {\n    aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906: 'https://eos.greymass.com',\n    '2a02a0053e5a8cf73a56ba0fda11e4d92e0238a4a2aa74fccf46d5a910746840': 'https://jungle3.greymass.com',\n    '4667b205c6838ef70ff7988f6e8257e8be0e1284a2f59699054a018f743b1d11': 'https://telos.greymass.com',\n    '1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4': 'https://wax.greymass.com',\n};\nclass Storage {\n    constructor(keyPrefix) {\n        this.keyPrefix = keyPrefix;\n    }\n    async write(key, data) {\n        localStorage.setItem(this.storageKey(key), data);\n    }\n    async read(key) {\n        return localStorage.getItem(this.storageKey(key));\n    }\n    async remove(key) {\n        localStorage.removeItem(this.storageKey(key));\n    }\n    storageKey(key) {\n        return `${this.keyPrefix}-${key}`;\n    }\n}\nclass BrowserTransport {\n    constructor(options = {}) {\n        this.options = options;\n        this.classPrefix = options.classPrefix || 'anchor-link';\n        this.injectStyles = !(options.injectStyles === false);\n        this.importantStyles = !(options.importantStyles === false);\n        this.requestStatus = !(options.requestStatus === false);\n        this.fuelEnabled = options.disableGreymassFuel !== true;\n        this.fuelReferrer = options.fuelReferrer || 'teamgreymass';\n        this.storage = new Storage(options.storagePrefix || 'anchor-link');\n        this.supportedChains = options.supportedChains || defaultSupportedChains;\n    }\n    closeModal() {\n        this.hide();\n        if (this.activeCancel) {\n            this.activeRequest = undefined;\n            this.activeCancel('Modal closed');\n            this.activeCancel = undefined;\n        }\n    }\n    setupElements() {\n        if (this.injectStyles && !this.styleEl) {\n            this.styleEl = document.createElement('style');\n            this.styleEl.type = 'text/css';\n            let css = styleText.replace(/%prefix%/g, this.classPrefix);\n            if (this.importantStyles) {\n                css = css\n                    .split('\\n')\n                    .map((line) => line.replace(/;$/i, ' !important;'))\n                    .join('\\n');\n            }\n            this.styleEl.appendChild(document.createTextNode(css));\n            document.head.appendChild(this.styleEl);\n        }\n        if (!this.containerEl) {\n            this.containerEl = this.createEl();\n            this.containerEl.className = this.classPrefix;\n            this.containerEl.onclick = (event) => {\n                if (event.target === this.containerEl) {\n                    event.stopPropagation();\n                    this.closeModal();\n                }\n            };\n            document.body.appendChild(this.containerEl);\n        }\n        if (!this.requestEl) {\n            const wrapper = this.createEl({ class: 'inner' });\n            const closeButton = this.createEl({ class: 'close' });\n            closeButton.onclick = (event) => {\n                event.stopPropagation();\n                this.closeModal();\n            };\n            this.requestEl = this.createEl({ class: 'request' });\n            wrapper.appendChild(this.requestEl);\n            wrapper.appendChild(closeButton);\n            const version = this.createEl({\n                class: 'version',\n                text: `${BrowserTransport.version} (${Link.version})`,\n            });\n            version.onclick = (event) => {\n                event.stopPropagation();\n                window.open('https://github.com/greymass/anchor-link', '_blank');\n            };\n            wrapper.appendChild(version);\n            this.containerEl.appendChild(wrapper);\n        }\n    }\n    createEl(attrs) {\n        if (!attrs)\n            attrs = {};\n        const el = document.createElement(attrs.tag || 'div');\n        if (attrs) {\n            for (const attr of Object.keys(attrs)) {\n                const value = attrs[attr];\n                switch (attr) {\n                    case 'src':\n                        el.setAttribute(attr, value);\n                        break;\n                    case 'tag':\n                        break;\n                    case 'text':\n                        el.appendChild(document.createTextNode(value));\n                        break;\n                    case 'class':\n                        el.className = `${this.classPrefix}-${value}`;\n                        break;\n                    default:\n                        el.setAttribute(attr, value);\n                }\n            }\n        }\n        return el;\n    }\n    hide() {\n        if (this.containerEl) {\n            this.containerEl.classList.remove(`${this.classPrefix}-active`);\n        }\n        this.clearTimers();\n    }\n    show() {\n        if (this.containerEl) {\n            this.containerEl.classList.add(`${this.classPrefix}-active`);\n        }\n    }\n    async displayRequest(request) {\n        this.setupElements();\n        const sameDeviceRequest = request.clone();\n        const returnUrl = generateReturnUrl();\n        sameDeviceRequest.setInfoKey('same_device', true);\n        sameDeviceRequest.setInfoKey('return_path', returnUrl);\n        const sameDeviceUri = sameDeviceRequest.encode(true, false);\n        const crossDeviceUri = request.encode(true, false);\n        const isIdentity = request.isIdentity();\n        const title = isIdentity ? 'Login' : 'Sign';\n        const subtitle = 'Scan the QR-code with Anchor on another device or use the button to open Anchor on this device.';\n        const qrEl = this.createEl({ class: 'qr' });\n        try {\n            qrEl.innerHTML = generate(crossDeviceUri);\n        }\n        catch (error) {\n            // eslint-disable-next-line no-console\n            console.warn('Unable to generate QR code', error);\n        }\n        const linkEl = this.createEl({ class: 'uri' });\n        const linkA = this.createEl({\n            tag: 'a',\n            class: 'button',\n            href: crossDeviceUri,\n            text: 'Launch Anchor',\n        });\n        linkEl.appendChild(linkA);\n        if (isFirefox()) {\n            // this prevents firefox from killing the websocket connection once the link is clicked\n            const iframe = this.createEl({\n                class: 'wskeepalive',\n                src: 'about:blank',\n                tag: 'iframe',\n            });\n            linkEl.appendChild(iframe);\n            linkA.addEventListener('click', (event) => {\n                event.preventDefault();\n                iframe.setAttribute('src', sameDeviceUri);\n            });\n        }\n        else {\n            linkA.addEventListener('click', (event) => {\n                event.preventDefault();\n                window.location.href = sameDeviceUri;\n            });\n        }\n        const infoEl = this.createEl({ class: 'info' });\n        const infoTitle = this.createEl({ class: 'title', tag: 'span', text: title });\n        const infoSubtitle = this.createEl({ class: 'subtitle', tag: 'span', text: subtitle });\n        infoEl.appendChild(infoTitle);\n        infoEl.appendChild(infoSubtitle);\n        const actionEl = this.createEl({ class: 'actions' });\n        actionEl.appendChild(qrEl);\n        actionEl.appendChild(linkEl);\n        let footnoteEl;\n        if (isIdentity) {\n            footnoteEl = this.createEl({ class: 'footnote', text: \"Don't have Anchor yet? \" });\n            const footnoteLink = this.createEl({\n                tag: 'a',\n                target: '_blank',\n                href: 'https://greymass.com/anchor',\n                text: 'Download now',\n            });\n            footnoteEl.appendChild(footnoteLink);\n        }\n        else {\n            footnoteEl = this.createEl({\n                class: 'footnote',\n                text: 'Anchor signing is brought to you by ',\n            });\n            const footnoteLink = this.createEl({\n                tag: 'a',\n                target: '_blank',\n                href: 'https://greymass.com',\n                text: 'Greymass',\n            });\n            footnoteEl.appendChild(footnoteLink);\n        }\n        emptyElement(this.requestEl);\n        const logoEl = this.createEl({ class: 'logo' });\n        this.requestEl.appendChild(logoEl);\n        this.requestEl.appendChild(infoEl);\n        this.requestEl.appendChild(actionEl);\n        this.requestEl.appendChild(footnoteEl);\n        this.show();\n    }\n    async showLoading() {\n        this.setupElements();\n        emptyElement(this.requestEl);\n        const infoEl = this.createEl({ class: 'info' });\n        const infoTitle = this.createEl({ class: 'title', tag: 'span', text: 'Loading' });\n        const infoSubtitle = this.createEl({\n            class: 'subtitle',\n            tag: 'span',\n            text: 'Preparing request...',\n        });\n        this.prepareStatusEl = infoSubtitle;\n        infoEl.appendChild(infoTitle);\n        infoEl.appendChild(infoSubtitle);\n        const logoEl = this.createEl({ class: 'logo loading' });\n        this.requestEl.appendChild(logoEl);\n        this.requestEl.appendChild(infoEl);\n        this.show();\n    }\n    onRequest(request, cancel) {\n        this.activeRequest = request;\n        this.activeCancel = cancel;\n        this.displayRequest(request).catch(cancel);\n    }\n    onSessionRequest(session, request, cancel) {\n        if (session.metadata.sameDevice) {\n            request.setInfoKey('return_path', generateReturnUrl());\n        }\n        if (session.type === 'fallback') {\n            this.onRequest(request, cancel);\n            if (session.metadata.sameDevice) {\n                // trigger directly on a fallback same-device session\n                window.location.href = request.encode();\n            }\n            return;\n        }\n        this.activeRequest = request;\n        this.activeCancel = cancel;\n        this.setupElements();\n        const timeout = session.metadata.timeout || 60 * 1000 * 5;\n        const deviceName = session.metadata.name;\n        const infoTitle = this.createEl({ class: 'title', tag: 'span', text: 'Sign' });\n        const expires = this.getExpiration(request, timeout);\n        const updateCountdown = () => {\n            infoTitle.textContent = `Sign - ${countdownFormat(expires)}`;\n        };\n        this.countdownTimer = setInterval(updateCountdown, 200);\n        updateCountdown();\n        const infoEl = this.createEl({ class: 'info' });\n        infoEl.appendChild(infoTitle);\n        let subtitle;\n        if (deviceName && deviceName.length > 0) {\n            subtitle = `Please open your Anchor Wallet on your device ${deviceName} to review and sign the transaction.`;\n        }\n        else {\n            subtitle = 'Please review and sign the transaction in the linked wallet.';\n        }\n        const infoSubtitle = this.createEl({ class: 'subtitle', tag: 'span', text: subtitle });\n        infoEl.appendChild(infoSubtitle);\n        emptyElement(this.requestEl);\n        const logoEl = this.createEl({ class: 'logo' });\n        this.requestEl.appendChild(logoEl);\n        this.requestEl.appendChild(infoEl);\n        this.show();\n        if (session.metadata.sameDevice) {\n            if (session.metadata.launchUrl) {\n                window.location.href = session.metadata.launchUrl;\n            }\n            else if (isAppleHandheld()) {\n                window.location.href = 'anchor://link';\n            }\n        }\n    }\n    sendSessionPayload(payload, session) {\n        if (!session.metadata.triggerUrl || !session.metadata.sameDevice) {\n            // not same device or no trigger url supported\n            return false;\n        }\n        if (payload.array.length > 700) {\n            // url could be clipped by iOS\n            return false;\n        }\n        window.location.href = session.metadata.triggerUrl.replace('%s', Base64u.encode(payload.array));\n        return true;\n    }\n    clearTimers() {\n        if (this.closeTimer) {\n            clearTimeout(this.closeTimer);\n            this.closeTimer = undefined;\n        }\n        if (this.countdownTimer) {\n            clearTimeout(this.countdownTimer);\n            this.countdownTimer = undefined;\n        }\n    }\n    getExpiration(request, timeout = 0) {\n        // Get expiration of the transaction\n        const { expiration } = request.getRawTransaction();\n        if (expiration.equals(0)) {\n            // If no expiration is present, use the timeout on the session\n            return new Date(Date.now() + timeout);\n        }\n        else {\n            return expiration.toDate();\n        }\n    }\n    async showFee(request, fee) {\n        this.activeRequest = request;\n        const cancelPromise = new Promise((resolve, reject) => {\n            this.activeCancel = (reason) => {\n                let error;\n                if (typeof reason === 'string') {\n                    error = new Error(reason);\n                }\n                else {\n                    error = reason;\n                }\n                error[AbortPrepare] = true;\n                reject(error);\n            };\n        });\n        this.setupElements();\n        emptyElement(this.requestEl);\n        const feeEl = this.createEl({ class: 'fee' });\n        const feeTitle = this.createEl({ class: 'title', tag: 'div', text: 'Transaction Fee' });\n        const feeSubtitle = this.createEl({\n            class: 'subtitle',\n            tag: 'span',\n            text: `Your account lacks the network resources for this transaction and it cannot be covered for free.`,\n        });\n        const feePart1 = this.createEl({\n            tag: 'span',\n            text: 'You can try to ',\n        });\n        const feeBypass = this.createEl({\n            tag: 'a',\n            text: 'proceed without the fee',\n        });\n        const feePart2 = this.createEl({\n            tag: 'span',\n            text: ' or accept the fee shown below to pay for these costs.',\n        });\n        const feeDescription = this.createEl({\n            class: 'subtitle',\n            tag: 'span',\n        });\n        feeDescription.appendChild(feePart1);\n        feeDescription.appendChild(feeBypass);\n        feeDescription.appendChild(feePart2);\n        feeEl.appendChild(feeTitle);\n        feeEl.appendChild(feeSubtitle);\n        feeEl.appendChild(feeDescription);\n        const logoEl = this.createEl({ class: 'fuel' });\n        this.requestEl.appendChild(logoEl);\n        this.requestEl.appendChild(feeEl);\n        const choiceEl = this.createEl({ class: 'choice' });\n        const confirmEl = this.createEl({ tag: 'a', class: 'button', text: `Accept Fee of ${fee}` });\n        const expireEl = this.createEl({ tag: 'span', text: 'Offer expires in --:--' });\n        choiceEl.appendChild(expireEl);\n        choiceEl.appendChild(confirmEl);\n        feeEl.appendChild(choiceEl);\n        const expires = this.getExpiration(request);\n        const expireTimer = setInterval(() => {\n            expireEl.textContent = `Offer expires in ${countdownFormat(expires)}`;\n            if (expires.getTime() < Date.now()) {\n                this.activeCancel('Offer expired');\n            }\n        }, 200);\n        const footnoteEl = this.createEl({\n            class: 'footnote',\n            text: 'Resources offered by ',\n        });\n        const footnoteLink = this.createEl({\n            tag: 'a',\n            target: '_blank',\n            href: 'https://greymass.com/en/fuel',\n            text: 'Greymass Fuel',\n        });\n        footnoteEl.appendChild(footnoteLink);\n        this.requestEl.appendChild(footnoteEl);\n        const skipPromise = waitForEvent(feeBypass, 'click').then(() => {\n            const error = new Error('Skipped fee');\n            error[SkipFee] = true;\n            throw error;\n        });\n        const confirmPromise = waitForEvent(confirmEl, 'click');\n        this.show();\n        await Promise.race([confirmPromise, skipPromise, cancelPromise]).finally(() => {\n            clearInterval(expireTimer);\n        });\n    }\n    async prepare(request, session) {\n        this.showLoading();\n        if (!this.fuelEnabled || !session || request.isIdentity()) {\n            // don't attempt to cosign id request or if we don't have a session attached\n            return request;\n        }\n        if (typeof session.metadata.cosignerVersion === 'string' &&\n            compareVersion(session.metadata.cosignerVersion)) {\n            // if signer has cosigner, only attempt to cosign here if we have a newer version\n            return request;\n        }\n        try {\n            const result = fuel(request, session, (message) => {\n                if (this.prepareStatusEl) {\n                    this.prepareStatusEl.textContent = message;\n                }\n            }, this.supportedChains, this.fuelReferrer);\n            const timeout = new Promise((r) => setTimeout(r, 5000)).then(() => {\n                throw new Error('API timeout after 5000ms');\n            });\n            const modified = await Promise.race([result, timeout]);\n            const fee = modified.getInfoKey('txfee');\n            if (fee) {\n                await this.showFee(modified, String(fee));\n            }\n            return modified;\n        }\n        catch (error) {\n            if (error[AbortPrepare]) {\n                this.hide();\n                throw error;\n            }\n            else {\n                // eslint-disable-next-line no-console\n                console.info(`Skipping resource provider: ${error.message || error}`);\n                if (error[SkipFee]) {\n                    const modified = request.clone();\n                    modified.setInfoKey('no_fee', true, 'bool');\n                    return modified;\n                }\n            }\n        }\n        return request;\n    }\n    onSuccess(request) {\n        if (request === this.activeRequest) {\n            this.clearTimers();\n            if (this.requestStatus) {\n                this.setupElements();\n                const infoEl = this.createEl({ class: 'info' });\n                const logoEl = this.createEl({ class: 'logo' });\n                logoEl.classList.add('success');\n                const infoTitle = this.createEl({ class: 'title', tag: 'span', text: 'Success!' });\n                const subtitle = request.isIdentity() ? 'Login completed.' : 'Transaction signed.';\n                const infoSubtitle = this.createEl({ class: 'subtitle', tag: 'span', text: subtitle });\n                infoEl.appendChild(infoTitle);\n                infoEl.appendChild(infoSubtitle);\n                emptyElement(this.requestEl);\n                this.requestEl.appendChild(logoEl);\n                this.requestEl.appendChild(infoEl);\n                this.show();\n                this.closeTimer = setTimeout(() => {\n                    this.hide();\n                }, 1.5 * 1000);\n            }\n            else {\n                this.hide();\n            }\n        }\n    }\n    onFailure(request, error) {\n        if (request === this.activeRequest && error['code'] !== 'E_CANCEL') {\n            this.clearTimers();\n            if (this.requestStatus) {\n                this.setupElements();\n                const infoEl = this.createEl({ class: 'info' });\n                const logoEl = this.createEl({ class: 'logo' });\n                logoEl.classList.add('error');\n                const infoTitle = this.createEl({\n                    class: 'title',\n                    tag: 'span',\n                    text: 'Transaction Error',\n                });\n                let errorMessage;\n                if (isInstanceOf(error, APIError)) {\n                    if (error.name === 'eosio_assert_message_exception') {\n                        errorMessage = error.details[0].message;\n                    }\n                    else if (error.details.length > 0) {\n                        errorMessage = error.details.map((d) => d.message).join('\\n');\n                    }\n                    else {\n                        errorMessage = error.message;\n                    }\n                }\n                else {\n                    errorMessage = error.message || String(error);\n                }\n                const infoSubtitle = this.createEl({\n                    class: 'subtitle',\n                    tag: 'span',\n                    text: errorMessage,\n                });\n                infoEl.appendChild(infoTitle);\n                infoEl.appendChild(infoSubtitle);\n                emptyElement(this.requestEl);\n                this.requestEl.appendChild(logoEl);\n                this.requestEl.appendChild(infoEl);\n                this.show();\n            }\n            else {\n                this.hide();\n            }\n        }\n        else {\n            this.hide();\n        }\n    }\n    userAgent() {\n        return `BrowserTransport/${BrowserTransport.version} ${navigator.userAgent}`;\n    }\n}\n/** Package version. */\nBrowserTransport.version = '3.1.2'; // replaced by build script\nfunction waitForEvent(element, eventName, timeout) {\n    return new Promise((resolve, reject) => {\n        const listener = (event) => {\n            element.removeEventListener(eventName, listener);\n            resolve(event);\n        };\n        element.addEventListener(eventName, listener);\n        if (timeout) {\n            setTimeout(() => {\n                element.removeEventListener(eventName, listener);\n                reject(new Error(`Timed out waiting for ${eventName}`));\n            }, timeout);\n        }\n    });\n}\nfunction countdownFormat(date) {\n    const timeLeft = date.getTime() - Date.now();\n    if (timeLeft > 0) {\n        return new Date(timeLeft).toISOString().substr(14, 5);\n    }\n    return '00:00';\n}\nfunction emptyElement(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n}\n/** Generate a return url that Anchor will redirect back to w/o reload. */\nfunction generateReturnUrl() {\n    if (isChromeiOS()) {\n        // google chrome on iOS will always open new tab so we just ask it to open again as a workaround\n        return 'googlechrome://';\n    }\n    if (isFirefoxiOS()) {\n        // same for firefox\n        return 'firefox:://';\n    }\n    if (isAppleHandheld() && isBrave()) {\n        // and brave ios\n        return 'brave://';\n    }\n    if (isAppleHandheld()) {\n        // return url with unique fragment required for iOS safari to trigger the return url\n        const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n        let rv = window.location.href.split('#')[0] + '#';\n        for (let i = 0; i < 8; i++) {\n            rv += alphabet.charAt(Math.floor(Math.random() * alphabet.length));\n        }\n        return rv;\n    }\n    if (isAndroid() && isFirefox()) {\n        return 'android-intent://org.mozilla.firefox';\n    }\n    if (isAndroid() && isEdge()) {\n        return 'android-intent://com.microsoft.emmx';\n    }\n    if (isAndroid() && isOpera()) {\n        return 'android-intent://com.opera.browser';\n    }\n    if (isAndroid() && isBrave()) {\n        return 'android-intent://com.brave.browser';\n    }\n    if (isAndroid() && isAndroidWebView()) {\n        return 'android-intent://webview';\n    }\n    if (isAndroid() && isChromeMobile()) {\n        return 'android-intent://com.android.chrome';\n    }\n    return window.location.href;\n}\nfunction isAppleHandheld() {\n    return /iP(ad|od|hone)/i.test(navigator.userAgent);\n}\nfunction isChromeiOS() {\n    return /CriOS/.test(navigator.userAgent);\n}\nfunction isChromeMobile() {\n    return /Chrome\\/[.0-9]* Mobile/i.test(navigator.userAgent);\n}\nfunction isFirefox() {\n    return /Firefox/i.test(navigator.userAgent);\n}\nfunction isFirefoxiOS() {\n    return /FxiOS/.test(navigator.userAgent);\n}\nfunction isOpera() {\n    return /OPR/.test(navigator.userAgent) || /Opera/.test(navigator.userAgent);\n}\nfunction isEdge() {\n    return /Edg/.test(navigator.userAgent);\n}\nfunction isBrave() {\n    return navigator['brave'] && typeof navigator['brave'].isBrave === 'function';\n}\nfunction isAndroid() {\n    return /Android/.test(navigator.userAgent);\n}\nfunction isAndroidWebView() {\n    return /wv/.test(navigator.userAgent);\n}\n\nexport default BrowserTransport;\n//# sourceMappingURL=anchor-link-browser-transport.m.js.map\n"]},"metadata":{},"sourceType":"module"}