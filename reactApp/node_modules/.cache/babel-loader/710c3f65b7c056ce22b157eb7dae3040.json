{"ast":null,"code":"var _jsxFileName = \"/home/turbo/devel/MyGame/contracts/eos-hackathon/decentralize-io-ui/src/components/Pages/Organisations/Organisation.js\";\nimport React, { Component } from 'react';\nimport FinancialsPage from '../Financials/FinancialsPage';\nimport Voting from './Voting/Voting';\nimport Shareholder from './Shareholders/Shareholder';\nimport './Organisation.css';\nimport EOSIOApi from '../../../common/eosio-apiService';\nimport Transaction from \"./TransactionType/TransactionType\";\nimport { REACT_APP_EOSIO_CONTRACT_ACCOUNT } from \"../../../common/config\";\nimport { organisationEditBtnData, sideMenu, upcommingFeautre } from \"./organisationData\";\nimport * as actions from \"../Redux/Actions\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from 'react-router-dom';\nimport Loading from '../../Loading/Loading1';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst pageSize = 5;\n\nclass Organisation extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = async () => {\n      this.state.sideMenu.map((menu, i) => {\n        if (menu.mainMenu === this.props.match.params.menu) {\n          this.setState({\n            activeSubMenu: i\n          });\n        }\n\n        return menu;\n      });\n      if (Object.keys(this.state.selectedDAO).length > 0) await this.getShareHolderList(this.state.selectedDAO);\n    };\n\n    this.getShareHolderList = async selectedDAO => {\n      let shareholders = [],\n          shareHoldersList = [],\n          unallocatedSharesAmt = 0,\n          activeEosAccountBal = 0,\n          token = selectedDAO.token.split(' '),\n          creatorsList = this.props.creatorsList;\n\n      if (creatorsList.length > 0) {\n        for (let k = 0; k < creatorsList.length; k++) {\n          try {\n            shareholders.push(this.state.eosio.getTableRows('daotokens123', creatorsList[k].scope, 'accounts', 0, creatorsList[k].count, creatorsList[k].count));\n          } catch (error) {\n            console.log(error);\n          }\n\n          if (k === creatorsList.length - 1) {\n            let shareholdersInfo = await Promise.all(shareholders);\n\n            for (let i = 0; i < shareholdersInfo.length; i++) {\n              let activeShareholderAccount = shareholdersInfo[i].data.rows;\n\n              if (activeShareholderAccount.length > 0) {\n                for (let l = 0; l < activeShareholderAccount.length; l++) {\n                  let bal = activeShareholderAccount[l].data.balance.split(' ');\n\n                  if (bal[1] === token[1]) {\n                    if (shareholdersInfo[i].scope === 'bigpicturesw') {\n                      unallocatedSharesAmt = Number(bal[0]);\n                    }\n\n                    if (shareholdersInfo[i].scope === localStorage.getItem('activeEosAccount')) {\n                      activeEosAccountBal = Number(bal[0]);\n                    }\n\n                    if (shareholdersInfo[i].scope != 'bigpicturesw') shareHoldersList.push({\n                      account: shareholdersInfo[i].scope,\n                      balance: bal[0]\n                    });\n                  }\n\n                  if (l === activeShareholderAccount.length - 1 && i === shareholdersInfo.length - 1) {\n                    this.setState({\n                      loading: false,\n                      shareHoldersList,\n                      unallocatedSharesAmt,\n                      activeEosAccountBal\n                    });\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    };\n\n    this.componentDidUpdate = async (prevProps, prevState) => {\n      if (prevProps.organisationList != this.props.organisationList) this.setState({\n        organisationList: this.props.organisationList\n      });\n\n      if (prevProps.selectedDAO != this.props.selectedDAO) {\n        this.setState({\n          selectedDAO: this.props.selectedDAO\n        });\n      }\n\n      if (this.props.match.params.id && this.props.organisationList.length != 0) {\n        if (Object.keys(this.props.selectedDAO).length === 0) {\n          let selectedDAO = this.props.organisationList.filter(org => String(org.data.id) === this.props.match.params.id);\n\n          if (selectedDAO.length > 0) {\n            await this.props.setSelectedDAO(selectedDAO[0].data);\n            await this.getShareHolderList(selectedDAO[0].data);\n          } else {\n            alert(`Dao Doesn't Exits`); // this.props.history.push('/')\n          }\n        } else if (prevProps.selectedDAO != this.props.selectedDAO) {\n          await this.props.setSelectedDAO(this.props.selectedDAO);\n          await this.getShareHolderList(this.props.selectedDAO);\n        }\n      } else {} // this.setState({ selectedDAO: this.props.selectedDAO })\n\n\n      if (this.props.activeUser && this.state.accountName != this.props.activeUser.accountName) this.setState({\n        accountName: this.props.activeUser.accountName\n      });\n      this.state.sideMenu.map(async (menu, i) => {\n        if (menu.mainMenu === this.props.match.params.menu && this.state.activeSubMenu != i) {\n          if (this.state.activeSubMenu !== i) {\n            this.setState({\n              activeSubMenu: i\n            });\n          }\n        }\n\n        return menu;\n      });\n    };\n\n    this.openFundTransaction = () => {\n      let openFundTransaction = this.state.openFundTransaction;\n      this.setState({\n        openFundTransaction: !openFundTransaction\n      });\n    };\n\n    this.renderSubMenu = () => {\n      let {\n        sideMenu,\n        activeSubMenu\n      } = this.state,\n          activeSideMenu = sideMenu.filter(menu => menu.mainMenu === this.props.match.params.menu);\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"DI_Organisation_MainHeader DI_Organisation_SubHeader\",\n        children: activeSideMenu.length > 0 && activeSideMenu[0].subMenu.map((menu, i) => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"\",\n            style: {\n              display: 'flex'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `DI_Organisation_SubHeader_Text ${activeSubMenu === '' && i === 0 || i === 0 ? 'DI_Organisation_SubHeader_Text_Active' : ''} `,\n              children: [!menu.live && /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-lock\",\n                style: {\n                  color: 'white',\n                  marginRight: \"10px\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 52\n              }, this), menu.name, \" \", !menu.live && /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontWeight: 100,\n                  marginLeft: \"10px\",\n                  fontSize: '13px'\n                },\n                children: \"(Coming soon)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 158\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 33\n            }, this)\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 13\n      }, this);\n    };\n\n    let activeMenuId = 0,\n        _activeSubMenu = sideMenu.filter(menu => menu.mainMenu === this.props.match.params.menu);\n\n    if (this.props.match.params.menu && _activeSubMenu.length > 0) activeMenuId = _activeSubMenu[0].id;\n    this.state = {\n      loading: Object.keys(this.props.selectedDAO).length === 0 ? true : false,\n      lower_bound: 0,\n      activeEosAccountBal: 0,\n      unallocatedSharesAmt: 0,\n      upper_bound: pageSize - 1,\n      activeSubMenu: activeMenuId,\n      callShareHolders: true,\n      pageSize: pageSize,\n      openFundTransaction: false,\n      contractAccount: REACT_APP_EOSIO_CONTRACT_ACCOUNT,\n      eosio: new EOSIOApi(REACT_APP_EOSIO_CONTRACT_ACCOUNT),\n      accountName: props.activeUser && props.activeUser.accountName ? props.activeUser.accountName : '',\n      shareHoldersList: [],\n      ShareholderList: [{\n        account: 'Adamsmith123',\n        balance: 40\n      }, {\n        account: 'Alexbeeston7',\n        balance: 40\n      }, {\n        account: 'Callumhd2020',\n        balance: 40\n      }, {\n        account: 'John Fisher',\n        balance: 40\n      }, {\n        account: 'Chris Bidton',\n        balance: 40\n      }],\n      organisationList: this.props.organisationList,\n      selectedDAO: this.props.selectedDAO,\n      sideMenu,\n      upcommingFeautre\n    };\n  }\n\n  render() {\n    let {\n      sideMenu,\n      activeSubMenu,\n      shareHoldersList,\n      unallocatedSharesAmt,\n      activeEosAccountBal,\n      selectedDAO,\n      openFundTransaction,\n      show\n    } = this.state,\n        loadingStyle = {\n      marginLeft: 'auto',\n      marginRight: 'auto',\n      display: 'block'\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [localStorage.getItem('activeEosAccount') === null && /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 71\n      }, this), this.state.loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"DI_Organisation_Main\",\n        style: {\n          background: 'white',\n          height: '100vh'\n        },\n        children: /*#__PURE__*/_jsxDEV(Loading, {\n          styleData: loadingStyle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 21\n      }, this), !this.state.loading && sideMenu.map((menu, i) => {\n        return sideMenu[activeSubMenu].mainMenu === menu.mainMenu && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"DI_Organisation_Main\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"DI_Organisation_MainHeader\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"DI_Organisation_Title\",\n                children: selectedDAO.daoname\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 185,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Transaction, { ...this.props,\n                ...{\n                  unallocatedSharesAmt,\n                  activeEosAccountBal\n                },\n                ...organisationEditBtnData.filter(obj => obj.type === menu.mainMenu)[0]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 33\n            }, this), this.renderSubMenu()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 29\n          }, this), activeSubMenu === 0 && /*#__PURE__*/_jsxDEV(Shareholder, {\n            ShareholderList: shareHoldersList,\n            selectedDAO: selectedDAO,\n            unallocatedSharesAmt: unallocatedSharesAmt\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 53\n          }, this), activeSubMenu === 2 && /*#__PURE__*/_jsxDEV(Voting, { ...this.props\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 53\n          }, this), activeSubMenu === 1 && /*#__PURE__*/_jsxDEV(FinancialsPage, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 53\n          }, this)]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 25\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    selectedDAO: state.organisations.selectedDAO,\n    activeEosAccount: state.organisations.activeEosAccount,\n    organisationList: state.organisations.organistionList,\n    creatorsList: state.organisations.creatorsList\n  };\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setSelectedDAO: value => dispatch(actions.setSelectedDAO(value))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Organisation);","map":{"version":3,"sources":["/home/turbo/devel/MyGame/contracts/eos-hackathon/decentralize-io-ui/src/components/Pages/Organisations/Organisation.js"],"names":["React","Component","FinancialsPage","Voting","Shareholder","EOSIOApi","Transaction","REACT_APP_EOSIO_CONTRACT_ACCOUNT","organisationEditBtnData","sideMenu","upcommingFeautre","actions","connect","Redirect","Loading","pageSize","Organisation","constructor","props","componentDidMount","state","map","menu","i","mainMenu","match","params","setState","activeSubMenu","Object","keys","selectedDAO","length","getShareHolderList","shareholders","shareHoldersList","unallocatedSharesAmt","activeEosAccountBal","token","split","creatorsList","k","push","eosio","getTableRows","scope","count","error","console","log","shareholdersInfo","Promise","all","activeShareholderAccount","data","rows","l","bal","balance","Number","localStorage","getItem","account","loading","componentDidUpdate","prevProps","prevState","organisationList","id","filter","org","String","setSelectedDAO","alert","activeUser","accountName","openFundTransaction","renderSubMenu","activeSideMenu","subMenu","display","live","color","marginRight","name","fontWeight","marginLeft","fontSize","activeMenuId","lower_bound","upper_bound","callShareHolders","contractAccount","ShareholderList","render","show","loadingStyle","background","height","daoname","obj","type","mapStateToProps","organisations","activeEosAccount","organistionList","mapDispatchToProps","dispatch","value"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport FinancialsPage from '../Financials/FinancialsPage';\nimport Voting from './Voting/Voting'\nimport Shareholder from './Shareholders/Shareholder';\nimport './Organisation.css'\nimport EOSIOApi from '../../../common/eosio-apiService';\nimport Transaction from \"./TransactionType/TransactionType\";\nimport { REACT_APP_EOSIO_CONTRACT_ACCOUNT } from \"../../../common/config\";\nimport { organisationEditBtnData, sideMenu, upcommingFeautre } from \"./organisationData\";\nimport * as actions from \"../Redux/Actions\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from 'react-router-dom';\nimport Loading from '../../Loading/Loading1'\n\nconst pageSize = 5\n\nclass Organisation extends Component {\n    constructor(props) {\n        super(props)\n        let activeMenuId = 0, activeSubMenu = sideMenu.filter(menu => menu.mainMenu === this.props.match.params.menu)\n        if (this.props.match.params.menu && activeSubMenu.length > 0)\n            activeMenuId = activeSubMenu[0].id\n        this.state = {\n            loading: Object.keys(this.props.selectedDAO).length === 0 ? true : false,\n            lower_bound: 0,\n            activeEosAccountBal: 0,\n            unallocatedSharesAmt: 0,\n            upper_bound: pageSize - 1,\n            activeSubMenu: activeMenuId,\n            callShareHolders: true,\n            pageSize: pageSize,\n            openFundTransaction: false,\n            contractAccount: REACT_APP_EOSIO_CONTRACT_ACCOUNT,\n            eosio: new EOSIOApi(REACT_APP_EOSIO_CONTRACT_ACCOUNT),\n            accountName: props.activeUser && props.activeUser.accountName ? props.activeUser.accountName : '',\n            shareHoldersList: [],\n            ShareholderList: [\n                { account: 'Adamsmith123', balance: 40 },\n                { account: 'Alexbeeston7', balance: 40 },\n                { account: 'Callumhd2020', balance: 40 },\n                { account: 'John Fisher', balance: 40 },\n                { account: 'Chris Bidton', balance: 40 }],\n            organisationList: this.props.organisationList,\n            selectedDAO: this.props.selectedDAO,\n            sideMenu,\n            upcommingFeautre\n        }\n    }\n\n\n    componentDidMount = async () => {\n        this.state.sideMenu.map((menu, i) => {\n            if (menu.mainMenu === this.props.match.params.menu) {\n                this.setState({ activeSubMenu: i })\n            }\n            return menu;\n        })\n        if (Object.keys(this.state.selectedDAO).length > 0)\n            await this.getShareHolderList(this.state.selectedDAO)\n    }\n\n    getShareHolderList = async (selectedDAO) => {\n        let shareholders = [],\n            shareHoldersList = [],\n            unallocatedSharesAmt = 0,\n            activeEosAccountBal = 0,\n            token = selectedDAO.token.split(' '),\n            creatorsList = this.props.creatorsList\n\n        if (creatorsList.length > 0) {\n            for (let k = 0; k < creatorsList.length; k++) {\n                try {\n                    shareholders.push(this.state.eosio.getTableRows('daotokens123', creatorsList[k].scope, 'accounts', 0, creatorsList[k].count, creatorsList[k].count))\n                } catch (error) {\n                    console.log(error)\n                }\n                if (k === creatorsList.length - 1) {\n                    let shareholdersInfo = await Promise.all(shareholders)\n                    for (let i = 0; i < shareholdersInfo.length; i++) {\n                        let activeShareholderAccount = shareholdersInfo[i].data.rows\n                        if (activeShareholderAccount.length > 0) {\n                            for (let l = 0; l < activeShareholderAccount.length; l++) {\n                                let bal = (activeShareholderAccount[l].data.balance).split(' ')\n                                if (bal[1] === token[1]) {\n                                    if (shareholdersInfo[i].scope === 'bigpicturesw') {\n                                        unallocatedSharesAmt = Number(bal[0])\n                                    }\n                                    if (shareholdersInfo[i].scope === localStorage.getItem('activeEosAccount')) {\n                                        activeEosAccountBal = Number(bal[0])\n                                    }\n                                    if (shareholdersInfo[i].scope != 'bigpicturesw')\n                                        shareHoldersList.push({ account: shareholdersInfo[i].scope, balance: bal[0] })\n                                }\n\n                                if (l === activeShareholderAccount.length - 1 && i === shareholdersInfo.length - 1) {\n                                    this.setState({ loading: false, shareHoldersList, unallocatedSharesAmt, activeEosAccountBal })\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    componentDidUpdate = async (prevProps, prevState) => {\n        if (prevProps.organisationList != this.props.organisationList)\n            this.setState({ organisationList: this.props.organisationList })\n        if (prevProps.selectedDAO != this.props.selectedDAO) {\n            this.setState({ selectedDAO: this.props.selectedDAO })\n        }\n        if (this.props.match.params.id && this.props.organisationList.length != 0) {\n            if (Object.keys(this.props.selectedDAO).length === 0) {\n                let selectedDAO = this.props.organisationList.filter(org => String(org.data.id) === this.props.match.params.id)\n                if (selectedDAO.length > 0) {\n                    await this.props.setSelectedDAO(selectedDAO[0].data)\n                    await this.getShareHolderList(selectedDAO[0].data)\n                } else {\n                    alert(`Dao Doesn't Exits`)\n                    // this.props.history.push('/')\n                }\n            } else if (prevProps.selectedDAO != this.props.selectedDAO) {\n                await this.props.setSelectedDAO(this.props.selectedDAO)\n                await this.getShareHolderList(this.props.selectedDAO)\n            }\n        } else {\n\n        }\n\n        // this.setState({ selectedDAO: this.props.selectedDAO })\n        if (this.props.activeUser && this.state.accountName != this.props.activeUser.accountName)\n            this.setState({ accountName: this.props.activeUser.accountName })\n        this.state.sideMenu.map(async (menu, i) => {\n            if (menu.mainMenu === this.props.match.params.menu && this.state.activeSubMenu != i) {\n                if (this.state.activeSubMenu !== i) {\n                    this.setState({ activeSubMenu: i })\n                }\n            }\n            return menu;\n        })\n    }\n\n    openFundTransaction = () => {\n        let openFundTransaction = this.state.openFundTransaction\n        this.setState({ openFundTransaction: !openFundTransaction })\n\n    }\n\n    renderSubMenu = () => {\n        let { sideMenu, activeSubMenu } = this.state,\n            activeSideMenu = sideMenu.filter(menu => menu.mainMenu === this.props.match.params.menu)\n        return (\n            <div className=\"DI_Organisation_MainHeader DI_Organisation_SubHeader\">\n                {activeSideMenu.length > 0 &&\n                    activeSideMenu[0].subMenu.map((menu, i) => {\n                        return (\n                            <div key={i} className=\"\" style={{ display: 'flex' }}>\n                                <div\n                                    className={`DI_Organisation_SubHeader_Text ${(activeSubMenu === '' && i === 0) || (i === 0) ? 'DI_Organisation_SubHeader_Text_Active' : ''} `}>\n                                    {!menu.live && <i className=\"fa fa-lock\" style={{ color: 'white', marginRight: \"10px\" }}></i>}{menu.name} {!menu.live && <span style={{ fontWeight: 100, marginLeft: \"10px\", fontSize: '13px' }}>(Coming soon)</span>}</div>\n                            </div>)\n                    })}\n            </div>\n        )\n    }\n\n\n    render() {\n        let { sideMenu, activeSubMenu, shareHoldersList, unallocatedSharesAmt,\n            activeEosAccountBal, selectedDAO, openFundTransaction, show } = this.state,\n            loadingStyle = { marginLeft: 'auto', marginRight: 'auto', display: 'block' }\n        return (\n            <div>\n                {localStorage.getItem('activeEosAccount') === null && <Redirect to='/' />}\n                {this.state.loading &&\n                    <div className=\"DI_Organisation_Main\" style={{ background: 'white', height: '100vh' }}>\n                        <Loading styleData={loadingStyle} />\n                    </div>}\n                {!this.state.loading && sideMenu.map((menu, i) => {\n                    return (\n                        sideMenu[activeSubMenu].mainMenu === menu.mainMenu &&\n                        <div key={i}>\n                            <div className=\"DI_Organisation_Main\" >\n                                <div className=\"DI_Organisation_MainHeader\">\n                                    <div className=\"DI_Organisation_Title\" >{selectedDAO.daoname}</div>\n                                    <Transaction\n                                        {...{\n                                            ...this.props,\n                                            ...{ unallocatedSharesAmt, activeEosAccountBal },\n                                            ...organisationEditBtnData.filter(obj => obj.type === menu.mainMenu)[0]\n                                        }} />\n                                </div>\n                                {this.renderSubMenu()}\n                            </div>\n                            {activeSubMenu === 0 && <Shareholder ShareholderList={shareHoldersList} selectedDAO={selectedDAO} unallocatedSharesAmt={unallocatedSharesAmt} />}\n                            {activeSubMenu === 2 && <Voting {...this.props} />}\n                            {activeSubMenu === 1 && <FinancialsPage />}\n                        </div>\n                    )\n                })}\n            </div>\n        )\n\n    }\n}\n\nfunction mapStateToProps(state) {\n    return {\n        selectedDAO: state.organisations.selectedDAO,\n        activeEosAccount: state.organisations.activeEosAccount,\n        organisationList: state.organisations.organistionList,\n        creatorsList: state.organisations.creatorsList,\n\n    };\n}\nconst mapDispatchToProps = dispatch => {\n    return {\n        setSelectedDAO: (value) => dispatch(actions.setSelectedDAO(value))\n    }\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Organisation);\n"]},"metadata":{},"sourceType":"module"}